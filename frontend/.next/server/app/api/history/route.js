"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(() => {
var exports = {};
exports.id = "app/api/history/route";
exports.ids = ["app/api/history/route"];
exports.modules = {

/***/ "better-sqlite3":
/*!*********************************!*\
  !*** external "better-sqlite3" ***!
  \*********************************/
/***/ ((module) => {

module.exports = require("better-sqlite3");

/***/ }),

/***/ "../../client/components/action-async-storage.external":
/*!*******************************************************************************!*\
  !*** external "next/dist/client/components/action-async-storage.external.js" ***!
  \*******************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/client/components/action-async-storage.external.js");

/***/ }),

/***/ "../../client/components/request-async-storage.external":
/*!********************************************************************************!*\
  !*** external "next/dist/client/components/request-async-storage.external.js" ***!
  \********************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/client/components/request-async-storage.external.js");

/***/ }),

/***/ "../../client/components/static-generation-async-storage.external":
/*!******************************************************************************************!*\
  !*** external "next/dist/client/components/static-generation-async-storage.external.js" ***!
  \******************************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/client/components/static-generation-async-storage.external.js");

/***/ }),

/***/ "next/dist/compiled/next-server/app-route.runtime.dev.js":
/*!**************************************************************************!*\
  !*** external "next/dist/compiled/next-server/app-route.runtime.dev.js" ***!
  \**************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/app-route.runtime.dev.js");

/***/ }),

/***/ "buffer":
/*!*************************!*\
  !*** external "buffer" ***!
  \*************************/
/***/ ((module) => {

module.exports = require("buffer");

/***/ }),

/***/ "crypto":
/*!*************************!*\
  !*** external "crypto" ***!
  \*************************/
/***/ ((module) => {

module.exports = require("crypto");

/***/ }),

/***/ "path":
/*!***********************!*\
  !*** external "path" ***!
  \***********************/
/***/ ((module) => {

module.exports = require("path");

/***/ }),

/***/ "stream":
/*!*************************!*\
  !*** external "stream" ***!
  \*************************/
/***/ ((module) => {

module.exports = require("stream");

/***/ }),

/***/ "util":
/*!***********************!*\
  !*** external "util" ***!
  \***********************/
/***/ ((module) => {

module.exports = require("util");

/***/ }),

/***/ "(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fhistory%2Froute&page=%2Fapi%2Fhistory%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fhistory%2Froute.ts&appDir=G%3A%5CTrea%5CAICoach%5Cfrontend%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=G%3A%5CTrea%5CAICoach%5Cfrontend&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!":
/*!*****************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fhistory%2Froute&page=%2Fapi%2Fhistory%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fhistory%2Froute.ts&appDir=G%3A%5CTrea%5CAICoach%5Cfrontend%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=G%3A%5CTrea%5CAICoach%5Cfrontend&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D! ***!
  \*****************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   headerHooks: () => (/* binding */ headerHooks),\n/* harmony export */   originalPathname: () => (/* binding */ originalPathname),\n/* harmony export */   patchFetch: () => (/* binding */ patchFetch),\n/* harmony export */   requestAsyncStorage: () => (/* binding */ requestAsyncStorage),\n/* harmony export */   routeModule: () => (/* binding */ routeModule),\n/* harmony export */   serverHooks: () => (/* binding */ serverHooks),\n/* harmony export */   staticGenerationAsyncStorage: () => (/* binding */ staticGenerationAsyncStorage),\n/* harmony export */   staticGenerationBailout: () => (/* binding */ staticGenerationBailout)\n/* harmony export */ });\n/* harmony import */ var next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/dist/server/future/route-modules/app-route/module.compiled */ \"(rsc)/./node_modules/next/dist/server/future/route-modules/app-route/module.compiled.js\");\n/* harmony import */ var next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! next/dist/server/future/route-kind */ \"(rsc)/./node_modules/next/dist/server/future/route-kind.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! next/dist/server/lib/patch-fetch */ \"(rsc)/./node_modules/next/dist/server/lib/patch-fetch.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var G_Trea_AICoach_frontend_app_api_history_route_ts__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./app/api/history/route.ts */ \"(rsc)/./app/api/history/route.ts\");\n\n\n\n\n// We inject the nextConfigOutput here so that we can use them in the route\n// module.\nconst nextConfigOutput = \"\"\nconst routeModule = new next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__.AppRouteRouteModule({\n    definition: {\n        kind: next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__.RouteKind.APP_ROUTE,\n        page: \"/api/history/route\",\n        pathname: \"/api/history\",\n        filename: \"route\",\n        bundlePath: \"app/api/history/route\"\n    },\n    resolvedPagePath: \"G:\\\\Trea\\\\AICoach\\\\frontend\\\\app\\\\api\\\\history\\\\route.ts\",\n    nextConfigOutput,\n    userland: G_Trea_AICoach_frontend_app_api_history_route_ts__WEBPACK_IMPORTED_MODULE_3__\n});\n// Pull out the exports that we need to expose from the module. This should\n// be eliminated when we've moved the other routes to the new format. These\n// are used to hook into the route.\nconst { requestAsyncStorage, staticGenerationAsyncStorage, serverHooks, headerHooks, staticGenerationBailout } = routeModule;\nconst originalPathname = \"/api/history/route\";\nfunction patchFetch() {\n    return (0,next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__.patchFetch)({\n        serverHooks,\n        staticGenerationAsyncStorage\n    });\n}\n\n\n//# sourceMappingURL=app-route.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvbmV4dC9kaXN0L2J1aWxkL3dlYnBhY2svbG9hZGVycy9uZXh0LWFwcC1sb2FkZXIuanM/bmFtZT1hcHAlMkZhcGklMkZoaXN0b3J5JTJGcm91dGUmcGFnZT0lMkZhcGklMkZoaXN0b3J5JTJGcm91dGUmYXBwUGF0aHM9JnBhZ2VQYXRoPXByaXZhdGUtbmV4dC1hcHAtZGlyJTJGYXBpJTJGaGlzdG9yeSUyRnJvdXRlLnRzJmFwcERpcj1HJTNBJTVDVHJlYSU1Q0FJQ29hY2glNUNmcm9udGVuZCU1Q2FwcCZwYWdlRXh0ZW5zaW9ucz10c3gmcGFnZUV4dGVuc2lvbnM9dHMmcGFnZUV4dGVuc2lvbnM9anN4JnBhZ2VFeHRlbnNpb25zPWpzJnJvb3REaXI9RyUzQSU1Q1RyZWElNUNBSUNvYWNoJTVDZnJvbnRlbmQmaXNEZXY9dHJ1ZSZ0c2NvbmZpZ1BhdGg9dHNjb25maWcuanNvbiZiYXNlUGF0aD0mYXNzZXRQcmVmaXg9Jm5leHRDb25maWdPdXRwdXQ9JnByZWZlcnJlZFJlZ2lvbj0mbWlkZGxld2FyZUNvbmZpZz1lMzAlM0QhIiwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7Ozs7O0FBQXNHO0FBQ3ZDO0FBQ2M7QUFDUTtBQUNyRjtBQUNBO0FBQ0E7QUFDQSx3QkFBd0IsZ0hBQW1CO0FBQzNDO0FBQ0EsY0FBYyx5RUFBUztBQUN2QjtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0EsWUFBWTtBQUNaLENBQUM7QUFDRDtBQUNBO0FBQ0E7QUFDQSxRQUFRLHVHQUF1RztBQUMvRztBQUNBO0FBQ0EsV0FBVyw0RUFBVztBQUN0QjtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQzZKOztBQUU3SiIsInNvdXJjZXMiOlsid2VicGFjazovL2FpLWNvYWNoLWZyb250ZW5kLz9mYjE1Il0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IEFwcFJvdXRlUm91dGVNb2R1bGUgfSBmcm9tIFwibmV4dC9kaXN0L3NlcnZlci9mdXR1cmUvcm91dGUtbW9kdWxlcy9hcHAtcm91dGUvbW9kdWxlLmNvbXBpbGVkXCI7XG5pbXBvcnQgeyBSb3V0ZUtpbmQgfSBmcm9tIFwibmV4dC9kaXN0L3NlcnZlci9mdXR1cmUvcm91dGUta2luZFwiO1xuaW1wb3J0IHsgcGF0Y2hGZXRjaCBhcyBfcGF0Y2hGZXRjaCB9IGZyb20gXCJuZXh0L2Rpc3Qvc2VydmVyL2xpYi9wYXRjaC1mZXRjaFwiO1xuaW1wb3J0ICogYXMgdXNlcmxhbmQgZnJvbSBcIkc6XFxcXFRyZWFcXFxcQUlDb2FjaFxcXFxmcm9udGVuZFxcXFxhcHBcXFxcYXBpXFxcXGhpc3RvcnlcXFxccm91dGUudHNcIjtcbi8vIFdlIGluamVjdCB0aGUgbmV4dENvbmZpZ091dHB1dCBoZXJlIHNvIHRoYXQgd2UgY2FuIHVzZSB0aGVtIGluIHRoZSByb3V0ZVxuLy8gbW9kdWxlLlxuY29uc3QgbmV4dENvbmZpZ091dHB1dCA9IFwiXCJcbmNvbnN0IHJvdXRlTW9kdWxlID0gbmV3IEFwcFJvdXRlUm91dGVNb2R1bGUoe1xuICAgIGRlZmluaXRpb246IHtcbiAgICAgICAga2luZDogUm91dGVLaW5kLkFQUF9ST1VURSxcbiAgICAgICAgcGFnZTogXCIvYXBpL2hpc3Rvcnkvcm91dGVcIixcbiAgICAgICAgcGF0aG5hbWU6IFwiL2FwaS9oaXN0b3J5XCIsXG4gICAgICAgIGZpbGVuYW1lOiBcInJvdXRlXCIsXG4gICAgICAgIGJ1bmRsZVBhdGg6IFwiYXBwL2FwaS9oaXN0b3J5L3JvdXRlXCJcbiAgICB9LFxuICAgIHJlc29sdmVkUGFnZVBhdGg6IFwiRzpcXFxcVHJlYVxcXFxBSUNvYWNoXFxcXGZyb250ZW5kXFxcXGFwcFxcXFxhcGlcXFxcaGlzdG9yeVxcXFxyb3V0ZS50c1wiLFxuICAgIG5leHRDb25maWdPdXRwdXQsXG4gICAgdXNlcmxhbmRcbn0pO1xuLy8gUHVsbCBvdXQgdGhlIGV4cG9ydHMgdGhhdCB3ZSBuZWVkIHRvIGV4cG9zZSBmcm9tIHRoZSBtb2R1bGUuIFRoaXMgc2hvdWxkXG4vLyBiZSBlbGltaW5hdGVkIHdoZW4gd2UndmUgbW92ZWQgdGhlIG90aGVyIHJvdXRlcyB0byB0aGUgbmV3IGZvcm1hdC4gVGhlc2Vcbi8vIGFyZSB1c2VkIHRvIGhvb2sgaW50byB0aGUgcm91dGUuXG5jb25zdCB7IHJlcXVlc3RBc3luY1N0b3JhZ2UsIHN0YXRpY0dlbmVyYXRpb25Bc3luY1N0b3JhZ2UsIHNlcnZlckhvb2tzLCBoZWFkZXJIb29rcywgc3RhdGljR2VuZXJhdGlvbkJhaWxvdXQgfSA9IHJvdXRlTW9kdWxlO1xuY29uc3Qgb3JpZ2luYWxQYXRobmFtZSA9IFwiL2FwaS9oaXN0b3J5L3JvdXRlXCI7XG5mdW5jdGlvbiBwYXRjaEZldGNoKCkge1xuICAgIHJldHVybiBfcGF0Y2hGZXRjaCh7XG4gICAgICAgIHNlcnZlckhvb2tzLFxuICAgICAgICBzdGF0aWNHZW5lcmF0aW9uQXN5bmNTdG9yYWdlXG4gICAgfSk7XG59XG5leHBvcnQgeyByb3V0ZU1vZHVsZSwgcmVxdWVzdEFzeW5jU3RvcmFnZSwgc3RhdGljR2VuZXJhdGlvbkFzeW5jU3RvcmFnZSwgc2VydmVySG9va3MsIGhlYWRlckhvb2tzLCBzdGF0aWNHZW5lcmF0aW9uQmFpbG91dCwgb3JpZ2luYWxQYXRobmFtZSwgcGF0Y2hGZXRjaCwgIH07XG5cbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWFwcC1yb3V0ZS5qcy5tYXAiXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fhistory%2Froute&page=%2Fapi%2Fhistory%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fhistory%2Froute.ts&appDir=G%3A%5CTrea%5CAICoach%5Cfrontend%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=G%3A%5CTrea%5CAICoach%5Cfrontend&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!\n");

/***/ }),

/***/ "(rsc)/./app/api/history/route.ts":
/*!**********************************!*\
  !*** ./app/api/history/route.ts ***!
  \**********************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   GET: () => (/* binding */ GET),\n/* harmony export */   dynamic: () => (/* binding */ dynamic)\n/* harmony export */ });\n/* harmony import */ var next_dist_server_web_exports_next_response__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/dist/server/web/exports/next-response */ \"(rsc)/./node_modules/next/dist/server/web/exports/next-response.js\");\n/* harmony import */ var _lib_db__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @/lib/db */ \"(rsc)/./lib/db.ts\");\n/* harmony import */ var _lib_session__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @/lib/session */ \"(rsc)/./lib/session.ts\");\n\n\n\nconst dynamic = \"force-dynamic\";\nasync function GET() {\n    try {\n        const user = (0,_lib_session__WEBPACK_IMPORTED_MODULE_2__.getCurrentUser)();\n        const userId = user ? user.id : null;\n        const rows = (0,_lib_db__WEBPACK_IMPORTED_MODULE_1__.getConversationsFromDb)(userId);\n        return next_dist_server_web_exports_next_response__WEBPACK_IMPORTED_MODULE_0__[\"default\"].json(rows);\n    } catch (error) {\n        console.error(\"Failed to fetch conversations:\", error);\n        return next_dist_server_web_exports_next_response__WEBPACK_IMPORTED_MODULE_0__[\"default\"].json({\n            error: \"Failed to fetch conversations\"\n        }, {\n            status: 500\n        });\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9hcHAvYXBpL2hpc3Rvcnkvcm91dGUudHMiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7QUFBMkM7QUFDTztBQUNIO0FBRXhDLE1BQU1HLFVBQVUsZ0JBQWdCO0FBRWhDLGVBQWVDO0lBQ3BCLElBQUk7UUFDRixNQUFNQyxPQUFPSCw0REFBY0E7UUFDM0IsTUFBTUksU0FBU0QsT0FBT0EsS0FBS0UsRUFBRSxHQUFHO1FBRWhDLE1BQU1DLE9BQU9QLCtEQUFzQkEsQ0FBQ0s7UUFDcEMsT0FBT04sa0ZBQVlBLENBQUNTLElBQUksQ0FBQ0Q7SUFDM0IsRUFBRSxPQUFPRSxPQUFPO1FBQ2RDLFFBQVFELEtBQUssQ0FBQyxrQ0FBa0NBO1FBQ2hELE9BQU9WLGtGQUFZQSxDQUFDUyxJQUFJLENBQUM7WUFBRUMsT0FBTztRQUFnQyxHQUFHO1lBQUVFLFFBQVE7UUFBSTtJQUNyRjtBQUNGIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vYWktY29hY2gtZnJvbnRlbmQvLi9hcHAvYXBpL2hpc3Rvcnkvcm91dGUudHM/OTMyOSJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBOZXh0UmVzcG9uc2UgfSBmcm9tIFwibmV4dC9zZXJ2ZXJcIjtcbmltcG9ydCB7IGdldENvbnZlcnNhdGlvbnNGcm9tRGIgfSBmcm9tIFwiQC9saWIvZGJcIjtcbmltcG9ydCB7IGdldEN1cnJlbnRVc2VyIH0gZnJvbSBcIkAvbGliL3Nlc3Npb25cIjtcblxuZXhwb3J0IGNvbnN0IGR5bmFtaWMgPSBcImZvcmNlLWR5bmFtaWNcIjtcblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIEdFVCgpIHtcbiAgdHJ5IHtcbiAgICBjb25zdCB1c2VyID0gZ2V0Q3VycmVudFVzZXIoKTtcbiAgICBjb25zdCB1c2VySWQgPSB1c2VyID8gdXNlci5pZCA6IG51bGw7XG4gICAgXG4gICAgY29uc3Qgcm93cyA9IGdldENvbnZlcnNhdGlvbnNGcm9tRGIodXNlcklkKTtcbiAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24ocm93cyk7XG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgY29uc29sZS5lcnJvcihcIkZhaWxlZCB0byBmZXRjaCBjb252ZXJzYXRpb25zOlwiLCBlcnJvcik7XG4gICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKHsgZXJyb3I6IFwiRmFpbGVkIHRvIGZldGNoIGNvbnZlcnNhdGlvbnNcIiB9LCB7IHN0YXR1czogNTAwIH0pO1xuICB9XG59XG4iXSwibmFtZXMiOlsiTmV4dFJlc3BvbnNlIiwiZ2V0Q29udmVyc2F0aW9uc0Zyb21EYiIsImdldEN1cnJlbnRVc2VyIiwiZHluYW1pYyIsIkdFVCIsInVzZXIiLCJ1c2VySWQiLCJpZCIsInJvd3MiLCJqc29uIiwiZXJyb3IiLCJjb25zb2xlIiwic3RhdHVzIl0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./app/api/history/route.ts\n");

/***/ }),

/***/ "(rsc)/./lib/db.ts":
/*!*******************!*\
  !*** ./lib/db.ts ***!
  \*******************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   countUserMessages: () => (/* binding */ countUserMessages),\n/* harmony export */   createConversation: () => (/* binding */ createConversation),\n/* harmony export */   createUserWithPassword: () => (/* binding */ createUserWithPassword),\n/* harmony export */   deleteConversation: () => (/* binding */ deleteConversation),\n/* harmony export */   getAnalyticsEvents: () => (/* binding */ getAnalyticsEvents),\n/* harmony export */   getConversationById: () => (/* binding */ getConversationById),\n/* harmony export */   getConversationsFromDb: () => (/* binding */ getConversationsFromDb),\n/* harmony export */   getDb: () => (/* binding */ getDb),\n/* harmony export */   getMessagesFromDb: () => (/* binding */ getMessagesFromDb),\n/* harmony export */   getOrCreateUser: () => (/* binding */ getOrCreateUser),\n/* harmony export */   getUserByEmail: () => (/* binding */ getUserByEmail),\n/* harmony export */   getUserProfileFromDb: () => (/* binding */ getUserProfileFromDb),\n/* harmony export */   getUserStats: () => (/* binding */ getUserStats),\n/* harmony export */   incrementToolUsage: () => (/* binding */ incrementToolUsage),\n/* harmony export */   incrementUserTokens: () => (/* binding */ incrementUserTokens),\n/* harmony export */   saveMessageToDb: () => (/* binding */ saveMessageToDb),\n/* harmony export */   saveUserProfileToDb: () => (/* binding */ saveUserProfileToDb),\n/* harmony export */   saveVerificationCode: () => (/* binding */ saveVerificationCode),\n/* harmony export */   searchMessages: () => (/* binding */ searchMessages),\n/* harmony export */   trackEvent: () => (/* binding */ trackEvent),\n/* harmony export */   updateConversationTitle: () => (/* binding */ updateConversationTitle),\n/* harmony export */   updateConversationTool: () => (/* binding */ updateConversationTool),\n/* harmony export */   updateUserPassword: () => (/* binding */ updateUserPassword),\n/* harmony export */   updateUserProfile: () => (/* binding */ updateUserProfile),\n/* harmony export */   verifyCode: () => (/* binding */ verifyCode)\n/* harmony export */ });\n/* harmony import */ var path__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! path */ \"path\");\n/* harmony import */ var path__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(path__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var better_sqlite3__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! better-sqlite3 */ \"better-sqlite3\");\n/* harmony import */ var better_sqlite3__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(better_sqlite3__WEBPACK_IMPORTED_MODULE_1__);\n\n\nconst dbPath = path__WEBPACK_IMPORTED_MODULE_0___default().join(process.cwd(), \"sqlite.db\");\n// Use a global variable to store the database instance in development\n// to prevent multiple connections during hot reloading\nconst globalForDb = global;\nconst getDb = ()=>{\n    if (!globalForDb.dbInstance) {\n        globalForDb.dbInstance = new (better_sqlite3__WEBPACK_IMPORTED_MODULE_1___default())(dbPath);\n        initializeSchema(globalForDb.dbInstance);\n        globalForDb.isInitialized = true;\n    } else if (!globalForDb.isInitialized) {\n        // Fallback: ensure schema is initialized if instance exists but flag is missing (e.g. hot reload)\n        initializeSchema(globalForDb.dbInstance);\n        globalForDb.isInitialized = true;\n    }\n    return globalForDb.dbInstance;\n};\nconst initializeSchema = (db)=>{\n    db.exec(`CREATE TABLE IF NOT EXISTS conversations (\n       id TEXT PRIMARY KEY, \n       title TEXT NOT NULL, \n       created_at TEXT NOT NULL,\n       updated_at TEXT NOT NULL,\n       tool_id TEXT\n     )`);\n    db.exec(`CREATE TABLE IF NOT EXISTS messages (\n       id INTEGER PRIMARY KEY AUTOINCREMENT, \n       conversation_id TEXT NOT NULL,\n       role TEXT NOT NULL, \n       content TEXT NOT NULL, \n       created_at TEXT NOT NULL\n     )`);\n    // New Table: User Profiles\n    db.exec(`CREATE TABLE IF NOT EXISTS user_profiles (\n       id INTEGER PRIMARY KEY AUTOINCREMENT,\n       tags TEXT NOT NULL,\n       personality TEXT NOT NULL,\n       leadership_level TEXT NOT NULL,\n       last_updated TEXT NOT NULL\n     )`);\n    // New Table: Users (for Auth)\n    db.exec(`CREATE TABLE IF NOT EXISTS users (\n       id INTEGER PRIMARY KEY AUTOINCREMENT,\n       email TEXT UNIQUE NOT NULL,\n       name TEXT,\n       avatar TEXT,\n       created_at TEXT NOT NULL\n     )`);\n    // Migration for existing users table\n    try {\n        const columns = db.prepare(\"PRAGMA table_info(users)\").all();\n        const hasName = columns.some((col)=>col.name === \"name\");\n        if (!hasName) {\n            db.exec(\"ALTER TABLE users ADD COLUMN name TEXT\");\n        }\n        const hasAvatar = columns.some((col)=>col.name === \"avatar\");\n        if (!hasAvatar) {\n            db.exec(\"ALTER TABLE users ADD COLUMN avatar TEXT\");\n        }\n        const hasPasswordHash = columns.some((col)=>col.name === \"password_hash\");\n        if (!hasPasswordHash) {\n            db.exec(\"ALTER TABLE users ADD COLUMN password_hash TEXT\");\n        }\n    } catch (e) {\n        console.error(\"Schema migration error (users):\", e);\n    }\n    // New Table: Verification Codes\n    db.exec(`CREATE TABLE IF NOT EXISTS verification_codes (\n       id INTEGER PRIMARY KEY AUTOINCREMENT,\n       email TEXT NOT NULL,\n       code TEXT NOT NULL,\n       expires_at TEXT NOT NULL,\n       created_at TEXT NOT NULL\n     )`);\n    // Optimize: Add indices for performance\n    db.exec(\"CREATE INDEX IF NOT EXISTS idx_conversations_updated_at ON conversations(updated_at DESC)\");\n    db.exec(\"CREATE INDEX IF NOT EXISTS idx_messages_conversation_id ON messages(conversation_id)\");\n    db.exec(\"CREATE INDEX IF NOT EXISTS idx_users_email ON users(email)\");\n    db.exec(\"CREATE INDEX IF NOT EXISTS idx_verification_codes_email ON verification_codes(email)\");\n    // New Table: User Stats (Token Usage)\n    db.exec(`CREATE TABLE IF NOT EXISTS user_stats (\n       user_id INTEGER PRIMARY KEY,\n       total_tokens INTEGER DEFAULT 0,\n       input_tokens INTEGER DEFAULT 0,\n       output_tokens INTEGER DEFAULT 0,\n       last_updated TEXT\n     )`);\n    // New Table: Tool Usage Stats\n    db.exec(`CREATE TABLE IF NOT EXISTS tool_usage (\n       user_id INTEGER,\n       tool_id TEXT,\n       usage_count INTEGER DEFAULT 0,\n       last_used TEXT,\n       PRIMARY KEY (user_id, tool_id)\n     )`);\n    // New Table: Analytics Events (Generic)\n    db.exec(`CREATE TABLE IF NOT EXISTS analytics_events (\n       id INTEGER PRIMARY KEY AUTOINCREMENT,\n       user_id INTEGER,\n       event_type TEXT NOT NULL,\n       category TEXT,\n       event_data TEXT,\n       created_at TEXT NOT NULL\n     )`);\n    db.exec(\"CREATE INDEX IF NOT EXISTS idx_analytics_events_type ON analytics_events(event_type)\");\n    db.exec(\"CREATE INDEX IF NOT EXISTS idx_analytics_events_user ON analytics_events(user_id)\");\n    // Check if conversation_id column exists in messages table\n    try {\n        const columns = db.prepare(\"PRAGMA table_info(messages)\").all();\n        const hasConversationId = columns.some((col)=>col.name === \"conversation_id\");\n        if (!hasConversationId) {\n            db.exec(\"ALTER TABLE messages ADD COLUMN conversation_id TEXT\");\n        }\n    } catch (e) {\n        console.error(\"Schema migration error (messages):\", e);\n    }\n    // Check if updated_at column exists in conversations table\n    try {\n        const columns = db.prepare(\"PRAGMA table_info(conversations)\").all();\n        const hasUpdatedAt = columns.some((col)=>col.name === \"updated_at\");\n        if (!hasUpdatedAt) {\n            // Add column and backfill with created_at value\n            db.exec(\"ALTER TABLE conversations ADD COLUMN updated_at TEXT\");\n            db.exec(\"UPDATE conversations SET updated_at = created_at WHERE updated_at IS NULL\");\n        }\n    } catch (e) {\n        console.error(\"Schema migration error (conversations):\", e);\n    }\n    try {\n        const columns = db.prepare(\"PRAGMA table_info(conversations)\").all();\n        const hasToolId = columns.some((col)=>col.name === \"tool_id\");\n        if (!hasToolId) {\n            db.exec(\"ALTER TABLE conversations ADD COLUMN tool_id TEXT\");\n        }\n    } catch (e) {\n        console.error(\"Schema migration error (conversations tool_id):\", e);\n    }\n    // Check if user_id column exists in conversations table\n    try {\n        const columns = db.prepare(\"PRAGMA table_info(conversations)\").all();\n        const hasUserId = columns.some((col)=>col.name === \"user_id\");\n        if (!hasUserId) {\n            db.exec(\"ALTER TABLE conversations ADD COLUMN user_id INTEGER\");\n        }\n    } catch (e) {\n        console.error(\"Schema migration error (conversations user_id):\", e);\n    }\n    // Check if kind and metadata columns exist in messages table\n    try {\n        const columns = db.prepare(\"PRAGMA table_info(messages)\").all();\n        const hasKind = columns.some((col)=>col.name === \"kind\");\n        const hasMetadata = columns.some((col)=>col.name === \"metadata\");\n        if (!hasKind) {\n            db.exec(\"ALTER TABLE messages ADD COLUMN kind TEXT DEFAULT 'text'\");\n        }\n        if (!hasMetadata) {\n            db.exec(\"ALTER TABLE messages ADD COLUMN metadata TEXT\");\n        }\n    } catch (e) {\n        console.error(\"Schema migration error (messages extra columns):\", e);\n    }\n};\n// Helper to create or update a conversation\nconst createConversation = (id, title, toolId = null, userId = null)=>{\n    const db = getDb();\n    // Check if exists\n    const exists = db.prepare(\"SELECT 1 FROM conversations WHERE id = ?\").get(id);\n    if (!exists) {\n        const now = new Date().toISOString();\n        const stmt = db.prepare(\"INSERT INTO conversations (id, title, created_at, updated_at, tool_id, user_id) VALUES (?, ?, ?, ?, ?, ?)\");\n        stmt.run(id, title, now, now, toolId, userId);\n    }\n};\n// Helper to update conversation title\nconst updateConversationTitle = (id, newTitle)=>{\n    const db = getDb();\n    const stmt = db.prepare(\"UPDATE conversations SET title = ? WHERE id = ?\");\n    stmt.run(newTitle, id);\n};\nconst updateConversationTool = (id, toolId)=>{\n    const db = getDb();\n    const stmt = db.prepare(\"UPDATE conversations SET tool_id = ? WHERE id = ?\");\n    stmt.run(toolId, id);\n};\n// Helper to get all conversations\nconst getConversationsFromDb = (userId = null)=>{\n    const db = getDb();\n    // Sort by updated_at DESC (recently active first)\n    let sql = \"SELECT id, title, created_at, updated_at, tool_id FROM conversations\";\n    const params = [];\n    if (userId) {\n        sql += \" WHERE user_id = ?\";\n        params.push(userId);\n    } else {\n        sql += \" WHERE user_id IS NULL\";\n    }\n    sql += \" ORDER BY updated_at DESC LIMIT 50\";\n    const stmt = db.prepare(sql);\n    return stmt.all(...params);\n};\nconst getConversationById = (id)=>{\n    const db = getDb();\n    return db.prepare(\"SELECT * FROM conversations WHERE id = ?\").get(id);\n};\nconst saveVerificationCode = (email, code)=>{\n    const db = getDb();\n    const expiresAt = new Date(Date.now() + 5 * 60 * 1000).toISOString(); // 5 minutes\n    const createdAt = new Date().toISOString();\n    db.prepare(\"INSERT INTO verification_codes (email, code, expires_at, created_at) VALUES (?, ?, ?, ?)\").run(email, code, expiresAt, createdAt);\n};\nconst verifyCode = (email, code)=>{\n    const db = getDb();\n    const now = new Date().toISOString();\n    // Find valid code\n    const record = db.prepare(\"SELECT * FROM verification_codes WHERE email = ? AND code = ? AND expires_at > ? ORDER BY created_at DESC LIMIT 1\").get(email, code, now);\n    if (record) {\n        // Delete used code (optional, or just rely on expiration)\n        // db.prepare(\"DELETE FROM verification_codes WHERE id = ?\").run(record.id);\n        return true;\n    }\n    return false;\n};\nconst getOrCreateUser = (email, name)=>{\n    const db = getDb();\n    const now = new Date().toISOString();\n    let user = db.prepare(\"SELECT * FROM users WHERE email = ?\").get(email);\n    if (!user) {\n        // Only used for OTP login where we might implicitly create user if we want\n        // But now we prefer explicit registration. \n        // This function is kept for backward compatibility with pure OTP login if we still support it as \"magic link\" style\n        db.prepare(\"INSERT INTO users (email, name, created_at) VALUES (?, ?, ?)\").run(email, name || email.split(\"@\")[0], now);\n        user = db.prepare(\"SELECT * FROM users WHERE email = ?\").get(email);\n    } else if (name && !user.name) {\n        // Backfill name if missing and provided\n        db.prepare(\"UPDATE users SET name = ? WHERE id = ?\").run(name, user.id);\n        user.name = name;\n    }\n    return user;\n};\nconst createUserWithPassword = (email, passwordHash, name)=>{\n    const db = getDb();\n    const now = new Date().toISOString();\n    try {\n        db.prepare(\"INSERT INTO users (email, password_hash, name, created_at) VALUES (?, ?, ?, ?)\").run(email, passwordHash, name, now);\n        return db.prepare(\"SELECT * FROM users WHERE email = ?\").get(email);\n    } catch (err) {\n        if (err.message.includes(\"UNIQUE constraint failed\")) {\n            throw new Error(\"User already exists\");\n        }\n        throw err;\n    }\n};\nconst getUserByEmail = (email)=>{\n    const db = getDb();\n    return db.prepare(\"SELECT * FROM users WHERE email = ?\").get(email);\n};\nconst updateUserPassword = (userId, passwordHash)=>{\n    const db = getDb();\n    db.prepare(\"UPDATE users SET password_hash = ? WHERE id = ?\").run(passwordHash, userId);\n};\nconst updateUserProfile = (userId, updates)=>{\n    const db = getDb();\n    const { name, avatar } = updates;\n    if (name !== undefined) {\n        db.prepare(\"UPDATE users SET name = ? WHERE id = ?\").run(name, userId);\n    }\n    if (avatar !== undefined) {\n        db.prepare(\"UPDATE users SET avatar = ? WHERE id = ?\").run(avatar, userId);\n    }\n    return db.prepare(\"SELECT * FROM users WHERE id = ?\").get(userId);\n};\n// Helper to save a message\nconst saveMessageToDb = (conversationId, role, content, kind = \"text\", metadata = null, userId = null, initialTitle = null, initialToolId = null)=>{\n    const db = getDb();\n    // Ensure conversation exists. If not, create it with a default title or snippet.\n    // In a real app, we might want to generate a title from the first message.\n    const conv = db.prepare(\"SELECT user_id FROM conversations WHERE id = ?\").get(conversationId);\n    if (!conv) {\n        // Use provided title or create a default one\n        let title = initialTitle;\n        if (!title) {\n            title = role === \"user\" ? content.slice(0, 20) + (content.length > 20 ? \"...\" : \"\") : \"New Chat\";\n        }\n        createConversation(conversationId, title, initialToolId, userId);\n    } else if (userId && conv.user_id === null) {\n        // Claim the conversation if it's currently anonymous and we have a user\n        db.prepare(\"UPDATE conversations SET user_id = ? WHERE id = ?\").run(userId, conversationId);\n    }\n    const now = new Date().toISOString();\n    const stmt = db.prepare(\"INSERT INTO messages (conversation_id, role, content, created_at, kind, metadata) VALUES (?, ?, ?, ?, ?, ?)\");\n    stmt.run(conversationId, role, content, now, kind, metadata);\n    // Update conversation updated_at\n    const updateStmt = db.prepare(\"UPDATE conversations SET updated_at = ? WHERE id = ?\");\n    updateStmt.run(now, conversationId);\n};\n// Helper to get recent messages\nconst getMessagesFromDb = (conversationId, limit = 10)=>{\n    const db = getDb();\n    // Get last N messages for specific conversation, then reverse to chronological order\n    const stmt = db.prepare(`SELECT id, role, content, created_at, kind, metadata FROM messages WHERE conversation_id = ? ORDER BY id DESC LIMIT ?`);\n    const rows = stmt.all(conversationId, limit);\n    return rows.reverse();\n};\nconst countUserMessages = (conversationId)=>{\n    const db = getDb();\n    const result = db.prepare(\"SELECT COUNT(*) as count FROM messages WHERE conversation_id = ? AND role = 'user'\").get(conversationId);\n    return result ? result.count : 0;\n};\n// Helper to get user profile (get the latest one)\nconst getUserProfileFromDb = ()=>{\n    const db = getDb();\n    const stmt = db.prepare(\"SELECT * FROM user_profiles ORDER BY id DESC LIMIT 1\");\n    const row = stmt.get();\n    if (!row) return null;\n    let rawTags = {};\n    try {\n        rawTags = JSON.parse(row.tags);\n    } catch (e) {\n        console.error(\"Failed to parse profile tags\", e);\n    }\n    // Runtime Migration: Convert old string tags to new ProfileValue structure\n    const demographics = {};\n    for (const [key, val] of Object.entries(rawTags)){\n        if (typeof val === \"string\") {\n            // Old format: just string value\n            demographics[key] = {\n                value: val,\n                confidence: 50\n            }; // Default low confidence for legacy data\n        } else {\n            // New format: already object\n            demographics[key] = val;\n        }\n    }\n    return {\n        demographics: demographics,\n        personality: row.personality,\n        leadership_level: JSON.parse(row.leadership_level),\n        last_updated: row.last_updated\n    };\n};\n// Helper to delete a conversation and its messages\nconst deleteConversation = (id)=>{\n    const db = getDb();\n    // Delete messages first\n    const deleteMessagesStmt = db.prepare(\"DELETE FROM messages WHERE conversation_id = ?\");\n    deleteMessagesStmt.run(id);\n    // Delete conversation\n    const deleteConvStmt = db.prepare(\"DELETE FROM conversations WHERE id = ?\");\n    deleteConvStmt.run(id);\n};\nconst searchMessages = (query, userId = null)=>{\n    const db = getDb();\n    // Search for messages that match the query OR conversations whose title matches the query\n    // We join conversations to get the title and filter by user_id if needed\n    let sql = `\n    SELECT \n      m.id as message_id,\n      m.conversation_id,\n      m.content,\n      m.created_at,\n      c.title as conversation_title\n    FROM messages m\n    JOIN conversations c ON m.conversation_id = c.id\n    WHERE (m.content LIKE ? OR c.title LIKE ?)\n  `;\n    const params = [\n        `%${query}%`,\n        `%${query}%`\n    ];\n    if (userId) {\n        sql += \" AND c.user_id = ?\";\n        params.push(userId);\n    } else {\n        // If no user_id, we might want to restrict to public/anonymous chats or just show all (depending on requirements)\n        // For now, let's assume if userId is null, we only search anonymous chats to be safe, \n        // or maybe we just don't filter. \n        // Given the requirement \"secure conversation data\", we should probably filter by user ownership.\n        // If userId is NOT provided (e.g. server-side context issue), we should be careful.\n        // But usually this is called with a verified user ID.\n        // Let's assume userId IS NULL means anonymous user, so we only search anonymous chats.\n        sql += \" AND c.user_id IS NULL\";\n    }\n    sql += \" ORDER BY m.created_at DESC LIMIT 50\";\n    const stmt = db.prepare(sql);\n    return stmt.all(...params);\n};\n// Helper to save user profile\nconst saveUserProfileToDb = (profile)=>{\n    const db = getDb();\n    const stmt = db.prepare(\"INSERT INTO user_profiles (tags, personality, leadership_level, last_updated) VALUES (?, ?, ?, ?)\");\n    stmt.run(JSON.stringify(profile.demographics), profile.personality, JSON.stringify(profile.leadership_level), new Date().toISOString());\n};\n// Helper to increment user token usage\nconst incrementUserTokens = (userId, total, input, output)=>{\n    const db = getDb();\n    const now = new Date().toISOString();\n    // Check if stats exist\n    const exists = db.prepare(\"SELECT 1 FROM user_stats WHERE user_id = ?\").get(userId);\n    if (exists) {\n        const stmt = db.prepare(`\n      UPDATE user_stats \n      SET total_tokens = total_tokens + ?, \n          input_tokens = input_tokens + ?, \n          output_tokens = output_tokens + ?, \n          last_updated = ? \n      WHERE user_id = ?\n    `);\n        stmt.run(total, input, output, now, userId);\n    } else {\n        const stmt = db.prepare(`\n      INSERT INTO user_stats (user_id, total_tokens, input_tokens, output_tokens, last_updated) \n      VALUES (?, ?, ?, ?, ?)\n    `);\n        stmt.run(userId, total, input, output, now);\n    }\n};\n// Helper to increment tool usage\nconst incrementToolUsage = (userId, toolId)=>{\n    if (!toolId) return;\n    const db = getDb();\n    const now = new Date().toISOString();\n    // Check if exists\n    const exists = db.prepare(\"SELECT 1 FROM tool_usage WHERE user_id = ? AND tool_id = ?\").get(userId, toolId);\n    if (exists) {\n        const stmt = db.prepare(\"UPDATE tool_usage SET usage_count = usage_count + 1, last_used = ? WHERE user_id = ? AND tool_id = ?\");\n        stmt.run(now, userId, toolId);\n    } else {\n        const stmt = db.prepare(\"INSERT INTO tool_usage (user_id, tool_id, usage_count, last_used) VALUES (?, ?, 1, ?)\");\n        stmt.run(userId, toolId, now);\n    }\n};\nconst getUserStats = (userId)=>{\n    const db = getDb();\n    const stats = db.prepare(\"SELECT * FROM user_stats WHERE user_id = ?\").get(userId);\n    const tools = db.prepare(\"SELECT tool_id, usage_count FROM tool_usage WHERE user_id = ? ORDER BY usage_count DESC\").all(userId);\n    return {\n        tokens: stats || {\n            total_tokens: 0,\n            input_tokens: 0,\n            output_tokens: 0\n        },\n        tool_usage: tools || []\n    };\n};\n// Generic Event Tracking\nconst trackEvent = (userId, eventType, category = \"general\", data = {})=>{\n    const db = getDb();\n    const now = new Date().toISOString();\n    try {\n        const stmt = db.prepare(\"INSERT INTO analytics_events (user_id, event_type, category, event_data, created_at) VALUES (?, ?, ?, ?, ?)\");\n        stmt.run(userId, eventType, category, JSON.stringify(data), now);\n    } catch (error) {\n        console.error(\"Failed to track event:\", error);\n    }\n};\nconst getAnalyticsEvents = (limit = 50, userId = null)=>{\n    const db = getDb();\n    let sql = \"SELECT * FROM analytics_events\";\n    const params = [];\n    if (userId) {\n        sql += \" WHERE user_id = ?\";\n        params.push(userId);\n    }\n    sql += \" ORDER BY created_at DESC LIMIT ?\";\n    params.push(limit);\n    const stmt = db.prepare(sql);\n    return stmt.all(...params);\n};\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QUFnQixFQUFFLEVBQUVwRCxTQUF3QixJQUFJO0lBQ2pGLE1BQU14QixLQUFLSjtJQUNYLElBQUl3QyxNQUFNO0lBQ1YsTUFBTUMsU0FBZ0IsRUFBRTtJQUV4QixJQUFJYixRQUFRO1FBQ1ZZLE9BQU87UUFDUEMsT0FBT0MsSUFBSSxDQUFDZDtJQUNkO0lBRUFZLE9BQU87SUFDUEMsT0FBT0MsSUFBSSxDQUFDc0M7SUFFWixNQUFNOUMsT0FBTzlCLEdBQUdHLE9BQU8sQ0FBQ2lDO0lBQ3hCLE9BQU9OLEtBQUsxQixHQUFHLElBQUlpQztBQUNyQixFQUFFIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vYWktY29hY2gtZnJvbnRlbmQvLi9saWIvZGIudHM/MWRmMCJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgcGF0aCBmcm9tIFwicGF0aFwiO1xuaW1wb3J0IERhdGFiYXNlIGZyb20gXCJiZXR0ZXItc3FsaXRlM1wiO1xuaW1wb3J0IHsgVXNlclByb2ZpbGUgfSBmcm9tIFwiLi90eXBlc1wiO1xuXG5leHBvcnQgaW50ZXJmYWNlIFVzZXIge1xuICBpZDogbnVtYmVyO1xuICBlbWFpbDogc3RyaW5nO1xuICBuYW1lPzogc3RyaW5nO1xuICBhdmF0YXI/OiBzdHJpbmc7XG4gIGNyZWF0ZWRfYXQ6IHN0cmluZztcbiAgcGFzc3dvcmRfaGFzaD86IHN0cmluZztcbn1cblxuLy8gQmV0dGVyLXNxbGl0ZTMgdHlwZXNcbnR5cGUgRGF0YWJhc2VJbnN0YW5jZSA9IGltcG9ydChcImJldHRlci1zcWxpdGUzXCIpLkRhdGFiYXNlO1xuXG5jb25zdCBkYlBhdGggPSBwYXRoLmpvaW4ocHJvY2Vzcy5jd2QoKSwgXCJzcWxpdGUuZGJcIik7XG5cbi8vIFVzZSBhIGdsb2JhbCB2YXJpYWJsZSB0byBzdG9yZSB0aGUgZGF0YWJhc2UgaW5zdGFuY2UgaW4gZGV2ZWxvcG1lbnRcbi8vIHRvIHByZXZlbnQgbXVsdGlwbGUgY29ubmVjdGlvbnMgZHVyaW5nIGhvdCByZWxvYWRpbmdcbmNvbnN0IGdsb2JhbEZvckRiID0gZ2xvYmFsIGFzIHVua25vd24gYXMgeyBcbiAgZGJJbnN0YW5jZTogRGF0YWJhc2VJbnN0YW5jZSB8IHVuZGVmaW5lZDtcbiAgaXNJbml0aWFsaXplZDogYm9vbGVhbiB8IHVuZGVmaW5lZDtcbn07XG5cbmV4cG9ydCBjb25zdCBnZXREYiA9ICgpID0+IHtcbiAgaWYgKCFnbG9iYWxGb3JEYi5kYkluc3RhbmNlKSB7XG4gICAgZ2xvYmFsRm9yRGIuZGJJbnN0YW5jZSA9IG5ldyBEYXRhYmFzZShkYlBhdGgpO1xuICAgIGluaXRpYWxpemVTY2hlbWEoZ2xvYmFsRm9yRGIuZGJJbnN0YW5jZSk7XG4gICAgZ2xvYmFsRm9yRGIuaXNJbml0aWFsaXplZCA9IHRydWU7XG4gIH0gZWxzZSBpZiAoIWdsb2JhbEZvckRiLmlzSW5pdGlhbGl6ZWQpIHtcbiAgICAvLyBGYWxsYmFjazogZW5zdXJlIHNjaGVtYSBpcyBpbml0aWFsaXplZCBpZiBpbnN0YW5jZSBleGlzdHMgYnV0IGZsYWcgaXMgbWlzc2luZyAoZS5nLiBob3QgcmVsb2FkKVxuICAgIGluaXRpYWxpemVTY2hlbWEoZ2xvYmFsRm9yRGIuZGJJbnN0YW5jZSEpO1xuICAgIGdsb2JhbEZvckRiLmlzSW5pdGlhbGl6ZWQgPSB0cnVlO1xuICB9XG4gIHJldHVybiBnbG9iYWxGb3JEYi5kYkluc3RhbmNlITtcbn07XG5cbmNvbnN0IGluaXRpYWxpemVTY2hlbWEgPSAoZGI6IERhdGFiYXNlSW5zdGFuY2UpID0+IHtcbiAgZGIuZXhlYyhcbiAgICBgQ1JFQVRFIFRBQkxFIElGIE5PVCBFWElTVFMgY29udmVyc2F0aW9ucyAoXG4gICAgICAgaWQgVEVYVCBQUklNQVJZIEtFWSwgXG4gICAgICAgdGl0bGUgVEVYVCBOT1QgTlVMTCwgXG4gICAgICAgY3JlYXRlZF9hdCBURVhUIE5PVCBOVUxMLFxuICAgICAgIHVwZGF0ZWRfYXQgVEVYVCBOT1QgTlVMTCxcbiAgICAgICB0b29sX2lkIFRFWFRcbiAgICAgKWBcbiAgKTtcbiAgZGIuZXhlYyhcbiAgICBgQ1JFQVRFIFRBQkxFIElGIE5PVCBFWElTVFMgbWVzc2FnZXMgKFxuICAgICAgIGlkIElOVEVHRVIgUFJJTUFSWSBLRVkgQVVUT0lOQ1JFTUVOVCwgXG4gICAgICAgY29udmVyc2F0aW9uX2lkIFRFWFQgTk9UIE5VTEwsXG4gICAgICAgcm9sZSBURVhUIE5PVCBOVUxMLCBcbiAgICAgICBjb250ZW50IFRFWFQgTk9UIE5VTEwsIFxuICAgICAgIGNyZWF0ZWRfYXQgVEVYVCBOT1QgTlVMTFxuICAgICApYFxuICApO1xuICBcbiAgLy8gTmV3IFRhYmxlOiBVc2VyIFByb2ZpbGVzXG4gIGRiLmV4ZWMoXG4gICAgYENSRUFURSBUQUJMRSBJRiBOT1QgRVhJU1RTIHVzZXJfcHJvZmlsZXMgKFxuICAgICAgIGlkIElOVEVHRVIgUFJJTUFSWSBLRVkgQVVUT0lOQ1JFTUVOVCxcbiAgICAgICB0YWdzIFRFWFQgTk9UIE5VTEwsXG4gICAgICAgcGVyc29uYWxpdHkgVEVYVCBOT1QgTlVMTCxcbiAgICAgICBsZWFkZXJzaGlwX2xldmVsIFRFWFQgTk9UIE5VTEwsXG4gICAgICAgbGFzdF91cGRhdGVkIFRFWFQgTk9UIE5VTExcbiAgICAgKWBcbiAgKTtcblxuICAvLyBOZXcgVGFibGU6IFVzZXJzIChmb3IgQXV0aClcbiAgZGIuZXhlYyhcbiAgICBgQ1JFQVRFIFRBQkxFIElGIE5PVCBFWElTVFMgdXNlcnMgKFxuICAgICAgIGlkIElOVEVHRVIgUFJJTUFSWSBLRVkgQVVUT0lOQ1JFTUVOVCxcbiAgICAgICBlbWFpbCBURVhUIFVOSVFVRSBOT1QgTlVMTCxcbiAgICAgICBuYW1lIFRFWFQsXG4gICAgICAgYXZhdGFyIFRFWFQsXG4gICAgICAgY3JlYXRlZF9hdCBURVhUIE5PVCBOVUxMXG4gICAgIClgXG4gICk7XG5cbiAgLy8gTWlncmF0aW9uIGZvciBleGlzdGluZyB1c2VycyB0YWJsZVxuICB0cnkge1xuICAgIGNvbnN0IGNvbHVtbnMgPSBkYi5wcmVwYXJlKFwiUFJBR01BIHRhYmxlX2luZm8odXNlcnMpXCIpLmFsbCgpIGFzIGFueVtdO1xuICAgIGNvbnN0IGhhc05hbWUgPSBjb2x1bW5zLnNvbWUoY29sID0+IGNvbC5uYW1lID09PSBcIm5hbWVcIik7XG4gICAgaWYgKCFoYXNOYW1lKSB7XG4gICAgICBkYi5leGVjKFwiQUxURVIgVEFCTEUgdXNlcnMgQUREIENPTFVNTiBuYW1lIFRFWFRcIik7XG4gICAgfVxuICAgIGNvbnN0IGhhc0F2YXRhciA9IGNvbHVtbnMuc29tZShjb2wgPT4gY29sLm5hbWUgPT09IFwiYXZhdGFyXCIpO1xuICAgIGlmICghaGFzQXZhdGFyKSB7XG4gICAgICBkYi5leGVjKFwiQUxURVIgVEFCTEUgdXNlcnMgQUREIENPTFVNTiBhdmF0YXIgVEVYVFwiKTtcbiAgICB9XG4gICAgY29uc3QgaGFzUGFzc3dvcmRIYXNoID0gY29sdW1ucy5zb21lKGNvbCA9PiBjb2wubmFtZSA9PT0gXCJwYXNzd29yZF9oYXNoXCIpO1xuICAgIGlmICghaGFzUGFzc3dvcmRIYXNoKSB7XG4gICAgICBkYi5leGVjKFwiQUxURVIgVEFCTEUgdXNlcnMgQUREIENPTFVNTiBwYXNzd29yZF9oYXNoIFRFWFRcIik7XG4gICAgfVxuICB9IGNhdGNoIChlKSB7XG4gICAgY29uc29sZS5lcnJvcihcIlNjaGVtYSBtaWdyYXRpb24gZXJyb3IgKHVzZXJzKTpcIiwgZSk7XG4gIH1cblxuICAvLyBOZXcgVGFibGU6IFZlcmlmaWNhdGlvbiBDb2Rlc1xuICBkYi5leGVjKFxuICAgIGBDUkVBVEUgVEFCTEUgSUYgTk9UIEVYSVNUUyB2ZXJpZmljYXRpb25fY29kZXMgKFxuICAgICAgIGlkIElOVEVHRVIgUFJJTUFSWSBLRVkgQVVUT0lOQ1JFTUVOVCxcbiAgICAgICBlbWFpbCBURVhUIE5PVCBOVUxMLFxuICAgICAgIGNvZGUgVEVYVCBOT1QgTlVMTCxcbiAgICAgICBleHBpcmVzX2F0IFRFWFQgTk9UIE5VTEwsXG4gICAgICAgY3JlYXRlZF9hdCBURVhUIE5PVCBOVUxMXG4gICAgIClgXG4gICk7XG4gIFxuICAvLyBPcHRpbWl6ZTogQWRkIGluZGljZXMgZm9yIHBlcmZvcm1hbmNlXG4gIGRiLmV4ZWMoXCJDUkVBVEUgSU5ERVggSUYgTk9UIEVYSVNUUyBpZHhfY29udmVyc2F0aW9uc191cGRhdGVkX2F0IE9OIGNvbnZlcnNhdGlvbnModXBkYXRlZF9hdCBERVNDKVwiKTtcbiAgZGIuZXhlYyhcIkNSRUFURSBJTkRFWCBJRiBOT1QgRVhJU1RTIGlkeF9tZXNzYWdlc19jb252ZXJzYXRpb25faWQgT04gbWVzc2FnZXMoY29udmVyc2F0aW9uX2lkKVwiKTtcbiAgZGIuZXhlYyhcIkNSRUFURSBJTkRFWCBJRiBOT1QgRVhJU1RTIGlkeF91c2Vyc19lbWFpbCBPTiB1c2VycyhlbWFpbClcIik7XG4gIGRiLmV4ZWMoXCJDUkVBVEUgSU5ERVggSUYgTk9UIEVYSVNUUyBpZHhfdmVyaWZpY2F0aW9uX2NvZGVzX2VtYWlsIE9OIHZlcmlmaWNhdGlvbl9jb2RlcyhlbWFpbClcIik7XG5cbiAgLy8gTmV3IFRhYmxlOiBVc2VyIFN0YXRzIChUb2tlbiBVc2FnZSlcbiAgZGIuZXhlYyhcbiAgICBgQ1JFQVRFIFRBQkxFIElGIE5PVCBFWElTVFMgdXNlcl9zdGF0cyAoXG4gICAgICAgdXNlcl9pZCBJTlRFR0VSIFBSSU1BUlkgS0VZLFxuICAgICAgIHRvdGFsX3Rva2VucyBJTlRFR0VSIERFRkFVTFQgMCxcbiAgICAgICBpbnB1dF90b2tlbnMgSU5URUdFUiBERUZBVUxUIDAsXG4gICAgICAgb3V0cHV0X3Rva2VucyBJTlRFR0VSIERFRkFVTFQgMCxcbiAgICAgICBsYXN0X3VwZGF0ZWQgVEVYVFxuICAgICApYFxuICApO1xuXG4gIC8vIE5ldyBUYWJsZTogVG9vbCBVc2FnZSBTdGF0c1xuICBkYi5leGVjKFxuICAgIGBDUkVBVEUgVEFCTEUgSUYgTk9UIEVYSVNUUyB0b29sX3VzYWdlIChcbiAgICAgICB1c2VyX2lkIElOVEVHRVIsXG4gICAgICAgdG9vbF9pZCBURVhULFxuICAgICAgIHVzYWdlX2NvdW50IElOVEVHRVIgREVGQVVMVCAwLFxuICAgICAgIGxhc3RfdXNlZCBURVhULFxuICAgICAgIFBSSU1BUlkgS0VZICh1c2VyX2lkLCB0b29sX2lkKVxuICAgICApYFxuICApO1xuXG4gIC8vIE5ldyBUYWJsZTogQW5hbHl0aWNzIEV2ZW50cyAoR2VuZXJpYylcbiAgZGIuZXhlYyhcbiAgICBgQ1JFQVRFIFRBQkxFIElGIE5PVCBFWElTVFMgYW5hbHl0aWNzX2V2ZW50cyAoXG4gICAgICAgaWQgSU5URUdFUiBQUklNQVJZIEtFWSBBVVRPSU5DUkVNRU5ULFxuICAgICAgIHVzZXJfaWQgSU5URUdFUixcbiAgICAgICBldmVudF90eXBlIFRFWFQgTk9UIE5VTEwsXG4gICAgICAgY2F0ZWdvcnkgVEVYVCxcbiAgICAgICBldmVudF9kYXRhIFRFWFQsXG4gICAgICAgY3JlYXRlZF9hdCBURVhUIE5PVCBOVUxMXG4gICAgIClgXG4gICk7XG4gIFxuICBkYi5leGVjKFwiQ1JFQVRFIElOREVYIElGIE5PVCBFWElTVFMgaWR4X2FuYWx5dGljc19ldmVudHNfdHlwZSBPTiBhbmFseXRpY3NfZXZlbnRzKGV2ZW50X3R5cGUpXCIpO1xuICBkYi5leGVjKFwiQ1JFQVRFIElOREVYIElGIE5PVCBFWElTVFMgaWR4X2FuYWx5dGljc19ldmVudHNfdXNlciBPTiBhbmFseXRpY3NfZXZlbnRzKHVzZXJfaWQpXCIpO1xuXG4gIC8vIENoZWNrIGlmIGNvbnZlcnNhdGlvbl9pZCBjb2x1bW4gZXhpc3RzIGluIG1lc3NhZ2VzIHRhYmxlXG4gIHRyeSB7XG4gICAgY29uc3QgY29sdW1ucyA9IGRiLnByZXBhcmUoXCJQUkFHTUEgdGFibGVfaW5mbyhtZXNzYWdlcylcIikuYWxsKCkgYXMgYW55W107XG4gICAgY29uc3QgaGFzQ29udmVyc2F0aW9uSWQgPSBjb2x1bW5zLnNvbWUoY29sID0+IGNvbC5uYW1lID09PSBcImNvbnZlcnNhdGlvbl9pZFwiKTtcbiAgICBcbiAgICBpZiAoIWhhc0NvbnZlcnNhdGlvbklkKSB7XG4gICAgICAgZGIuZXhlYyhcIkFMVEVSIFRBQkxFIG1lc3NhZ2VzIEFERCBDT0xVTU4gY29udmVyc2F0aW9uX2lkIFRFWFRcIik7XG4gICAgfVxuICB9IGNhdGNoIChlKSB7XG4gICAgY29uc29sZS5lcnJvcihcIlNjaGVtYSBtaWdyYXRpb24gZXJyb3IgKG1lc3NhZ2VzKTpcIiwgZSk7XG4gIH1cblxuICAvLyBDaGVjayBpZiB1cGRhdGVkX2F0IGNvbHVtbiBleGlzdHMgaW4gY29udmVyc2F0aW9ucyB0YWJsZVxuICB0cnkge1xuICAgIGNvbnN0IGNvbHVtbnMgPSBkYi5wcmVwYXJlKFwiUFJBR01BIHRhYmxlX2luZm8oY29udmVyc2F0aW9ucylcIikuYWxsKCkgYXMgYW55W107XG4gICAgY29uc3QgaGFzVXBkYXRlZEF0ID0gY29sdW1ucy5zb21lKGNvbCA9PiBjb2wubmFtZSA9PT0gXCJ1cGRhdGVkX2F0XCIpO1xuICAgIFxuICAgIGlmICghaGFzVXBkYXRlZEF0KSB7XG4gICAgICAgLy8gQWRkIGNvbHVtbiBhbmQgYmFja2ZpbGwgd2l0aCBjcmVhdGVkX2F0IHZhbHVlXG4gICAgICAgZGIuZXhlYyhcIkFMVEVSIFRBQkxFIGNvbnZlcnNhdGlvbnMgQUREIENPTFVNTiB1cGRhdGVkX2F0IFRFWFRcIik7XG4gICAgICAgZGIuZXhlYyhcIlVQREFURSBjb252ZXJzYXRpb25zIFNFVCB1cGRhdGVkX2F0ID0gY3JlYXRlZF9hdCBXSEVSRSB1cGRhdGVkX2F0IElTIE5VTExcIik7XG4gICAgfVxuICB9IGNhdGNoIChlKSB7XG4gICAgY29uc29sZS5lcnJvcihcIlNjaGVtYSBtaWdyYXRpb24gZXJyb3IgKGNvbnZlcnNhdGlvbnMpOlwiLCBlKTtcbiAgfVxuXG4gIHRyeSB7XG4gICAgY29uc3QgY29sdW1ucyA9IGRiLnByZXBhcmUoXCJQUkFHTUEgdGFibGVfaW5mbyhjb252ZXJzYXRpb25zKVwiKS5hbGwoKSBhcyBhbnlbXTtcbiAgICBjb25zdCBoYXNUb29sSWQgPSBjb2x1bW5zLnNvbWUoY29sID0+IGNvbC5uYW1lID09PSBcInRvb2xfaWRcIik7XG4gICAgaWYgKCFoYXNUb29sSWQpIHtcbiAgICAgIGRiLmV4ZWMoXCJBTFRFUiBUQUJMRSBjb252ZXJzYXRpb25zIEFERCBDT0xVTU4gdG9vbF9pZCBURVhUXCIpO1xuICAgIH1cbiAgfSBjYXRjaCAoZSkge1xuICAgIGNvbnNvbGUuZXJyb3IoXCJTY2hlbWEgbWlncmF0aW9uIGVycm9yIChjb252ZXJzYXRpb25zIHRvb2xfaWQpOlwiLCBlKTtcbiAgfVxuXG4gIC8vIENoZWNrIGlmIHVzZXJfaWQgY29sdW1uIGV4aXN0cyBpbiBjb252ZXJzYXRpb25zIHRhYmxlXG4gIHRyeSB7XG4gICAgY29uc3QgY29sdW1ucyA9IGRiLnByZXBhcmUoXCJQUkFHTUEgdGFibGVfaW5mbyhjb252ZXJzYXRpb25zKVwiKS5hbGwoKSBhcyBhbnlbXTtcbiAgICBjb25zdCBoYXNVc2VySWQgPSBjb2x1bW5zLnNvbWUoY29sID0+IGNvbC5uYW1lID09PSBcInVzZXJfaWRcIik7XG4gICAgaWYgKCFoYXNVc2VySWQpIHtcbiAgICAgIGRiLmV4ZWMoXCJBTFRFUiBUQUJMRSBjb252ZXJzYXRpb25zIEFERCBDT0xVTU4gdXNlcl9pZCBJTlRFR0VSXCIpO1xuICAgIH1cbiAgfSBjYXRjaCAoZSkge1xuICAgIGNvbnNvbGUuZXJyb3IoXCJTY2hlbWEgbWlncmF0aW9uIGVycm9yIChjb252ZXJzYXRpb25zIHVzZXJfaWQpOlwiLCBlKTtcbiAgfVxuXG4gIC8vIENoZWNrIGlmIGtpbmQgYW5kIG1ldGFkYXRhIGNvbHVtbnMgZXhpc3QgaW4gbWVzc2FnZXMgdGFibGVcbiAgdHJ5IHtcbiAgICBjb25zdCBjb2x1bW5zID0gZGIucHJlcGFyZShcIlBSQUdNQSB0YWJsZV9pbmZvKG1lc3NhZ2VzKVwiKS5hbGwoKSBhcyBhbnlbXTtcbiAgICBjb25zdCBoYXNLaW5kID0gY29sdW1ucy5zb21lKGNvbCA9PiBjb2wubmFtZSA9PT0gXCJraW5kXCIpO1xuICAgIGNvbnN0IGhhc01ldGFkYXRhID0gY29sdW1ucy5zb21lKGNvbCA9PiBjb2wubmFtZSA9PT0gXCJtZXRhZGF0YVwiKTtcbiAgICBcbiAgICBpZiAoIWhhc0tpbmQpIHtcbiAgICAgICBkYi5leGVjKFwiQUxURVIgVEFCTEUgbWVzc2FnZXMgQUREIENPTFVNTiBraW5kIFRFWFQgREVGQVVMVCAndGV4dCdcIik7XG4gICAgfVxuICAgIGlmICghaGFzTWV0YWRhdGEpIHtcbiAgICAgICBkYi5leGVjKFwiQUxURVIgVEFCTEUgbWVzc2FnZXMgQUREIENPTFVNTiBtZXRhZGF0YSBURVhUXCIpO1xuICAgIH1cbiAgfSBjYXRjaCAoZSkge1xuICAgIGNvbnNvbGUuZXJyb3IoXCJTY2hlbWEgbWlncmF0aW9uIGVycm9yIChtZXNzYWdlcyBleHRyYSBjb2x1bW5zKTpcIiwgZSk7XG4gIH1cbn07XG5cbi8vIEhlbHBlciB0byBjcmVhdGUgb3IgdXBkYXRlIGEgY29udmVyc2F0aW9uXG5leHBvcnQgY29uc3QgY3JlYXRlQ29udmVyc2F0aW9uID0gKGlkOiBzdHJpbmcsIHRpdGxlOiBzdHJpbmcsIHRvb2xJZDogc3RyaW5nIHwgbnVsbCA9IG51bGwsIHVzZXJJZDogbnVtYmVyIHwgbnVsbCA9IG51bGwpID0+IHtcbiAgY29uc3QgZGIgPSBnZXREYigpO1xuICAvLyBDaGVjayBpZiBleGlzdHNcbiAgY29uc3QgZXhpc3RzID0gZGIucHJlcGFyZShcIlNFTEVDVCAxIEZST00gY29udmVyc2F0aW9ucyBXSEVSRSBpZCA9ID9cIikuZ2V0KGlkKTtcbiAgaWYgKCFleGlzdHMpIHtcbiAgICBjb25zdCBub3cgPSBuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKCk7XG4gICAgY29uc3Qgc3RtdCA9IGRiLnByZXBhcmUoXCJJTlNFUlQgSU5UTyBjb252ZXJzYXRpb25zIChpZCwgdGl0bGUsIGNyZWF0ZWRfYXQsIHVwZGF0ZWRfYXQsIHRvb2xfaWQsIHVzZXJfaWQpIFZBTFVFUyAoPywgPywgPywgPywgPywgPylcIik7XG4gICAgc3RtdC5ydW4oaWQsIHRpdGxlLCBub3csIG5vdywgdG9vbElkLCB1c2VySWQpO1xuICB9XG59O1xuXG4vLyBIZWxwZXIgdG8gdXBkYXRlIGNvbnZlcnNhdGlvbiB0aXRsZVxuZXhwb3J0IGNvbnN0IHVwZGF0ZUNvbnZlcnNhdGlvblRpdGxlID0gKGlkOiBzdHJpbmcsIG5ld1RpdGxlOiBzdHJpbmcpID0+IHtcbiAgY29uc3QgZGIgPSBnZXREYigpO1xuICBjb25zdCBzdG10ID0gZGIucHJlcGFyZShcIlVQREFURSBjb252ZXJzYXRpb25zIFNFVCB0aXRsZSA9ID8gV0hFUkUgaWQgPSA/XCIpO1xuICBzdG10LnJ1bihuZXdUaXRsZSwgaWQpO1xufTtcblxuZXhwb3J0IGNvbnN0IHVwZGF0ZUNvbnZlcnNhdGlvblRvb2wgPSAoaWQ6IHN0cmluZywgdG9vbElkOiBzdHJpbmcgfCBudWxsKSA9PiB7XG4gIGNvbnN0IGRiID0gZ2V0RGIoKTtcbiAgY29uc3Qgc3RtdCA9IGRiLnByZXBhcmUoXCJVUERBVEUgY29udmVyc2F0aW9ucyBTRVQgdG9vbF9pZCA9ID8gV0hFUkUgaWQgPSA/XCIpO1xuICBzdG10LnJ1bih0b29sSWQsIGlkKTtcbn07XG5cbi8vIEhlbHBlciB0byBnZXQgYWxsIGNvbnZlcnNhdGlvbnNcbmV4cG9ydCBjb25zdCBnZXRDb252ZXJzYXRpb25zRnJvbURiID0gKHVzZXJJZDogbnVtYmVyIHwgbnVsbCA9IG51bGwpID0+IHtcbiAgY29uc3QgZGIgPSBnZXREYigpO1xuICAvLyBTb3J0IGJ5IHVwZGF0ZWRfYXQgREVTQyAocmVjZW50bHkgYWN0aXZlIGZpcnN0KVxuICBsZXQgc3FsID0gXCJTRUxFQ1QgaWQsIHRpdGxlLCBjcmVhdGVkX2F0LCB1cGRhdGVkX2F0LCB0b29sX2lkIEZST00gY29udmVyc2F0aW9uc1wiO1xuICBjb25zdCBwYXJhbXM6IGFueVtdID0gW107XG5cbiAgaWYgKHVzZXJJZCkge1xuICAgIHNxbCArPSBcIiBXSEVSRSB1c2VyX2lkID0gP1wiO1xuICAgIHBhcmFtcy5wdXNoKHVzZXJJZCk7XG4gIH0gZWxzZSB7XG4gICAgc3FsICs9IFwiIFdIRVJFIHVzZXJfaWQgSVMgTlVMTFwiO1xuICB9XG5cbiAgc3FsICs9IFwiIE9SREVSIEJZIHVwZGF0ZWRfYXQgREVTQyBMSU1JVCA1MFwiO1xuICBcbiAgY29uc3Qgc3RtdCA9IGRiLnByZXBhcmUoc3FsKTtcbiAgcmV0dXJuIHN0bXQuYWxsKC4uLnBhcmFtcykgYXMgeyBpZDogc3RyaW5nOyB0aXRsZTogc3RyaW5nOyBjcmVhdGVkX2F0OiBzdHJpbmc7IHVwZGF0ZWRfYXQ6IHN0cmluZzsgdG9vbF9pZDogc3RyaW5nIHwgbnVsbCB9W107XG59O1xuXG5leHBvcnQgY29uc3QgZ2V0Q29udmVyc2F0aW9uQnlJZCA9IChpZDogc3RyaW5nKSA9PiB7XG4gIGNvbnN0IGRiID0gZ2V0RGIoKTtcbiAgcmV0dXJuIGRiLnByZXBhcmUoXCJTRUxFQ1QgKiBGUk9NIGNvbnZlcnNhdGlvbnMgV0hFUkUgaWQgPSA/XCIpLmdldChpZCkgYXMgeyBpZDogc3RyaW5nOyB1c2VyX2lkOiBudW1iZXIgfCBudWxsOyB0aXRsZTogc3RyaW5nIH0gfCB1bmRlZmluZWQ7XG59O1xuXG5leHBvcnQgY29uc3Qgc2F2ZVZlcmlmaWNhdGlvbkNvZGUgPSAoZW1haWw6IHN0cmluZywgY29kZTogc3RyaW5nKSA9PiB7XG4gIGNvbnN0IGRiID0gZ2V0RGIoKTtcbiAgY29uc3QgZXhwaXJlc0F0ID0gbmV3IERhdGUoRGF0ZS5ub3coKSArIDUgKiA2MCAqIDEwMDApLnRvSVNPU3RyaW5nKCk7IC8vIDUgbWludXRlc1xuICBjb25zdCBjcmVhdGVkQXQgPSBuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKCk7XG4gIFxuICBkYi5wcmVwYXJlKFxuICAgIFwiSU5TRVJUIElOVE8gdmVyaWZpY2F0aW9uX2NvZGVzIChlbWFpbCwgY29kZSwgZXhwaXJlc19hdCwgY3JlYXRlZF9hdCkgVkFMVUVTICg/LCA/LCA/LCA/KVwiXG4gICkucnVuKGVtYWlsLCBjb2RlLCBleHBpcmVzQXQsIGNyZWF0ZWRBdCk7XG59O1xuXG5leHBvcnQgY29uc3QgdmVyaWZ5Q29kZSA9IChlbWFpbDogc3RyaW5nLCBjb2RlOiBzdHJpbmcpOiBib29sZWFuID0+IHtcbiAgY29uc3QgZGIgPSBnZXREYigpO1xuICBjb25zdCBub3cgPSBuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKCk7XG4gIFxuICAvLyBGaW5kIHZhbGlkIGNvZGVcbiAgY29uc3QgcmVjb3JkID0gZGIucHJlcGFyZShcbiAgICBcIlNFTEVDVCAqIEZST00gdmVyaWZpY2F0aW9uX2NvZGVzIFdIRVJFIGVtYWlsID0gPyBBTkQgY29kZSA9ID8gQU5EIGV4cGlyZXNfYXQgPiA/IE9SREVSIEJZIGNyZWF0ZWRfYXQgREVTQyBMSU1JVCAxXCJcbiAgKS5nZXQoZW1haWwsIGNvZGUsIG5vdykgYXMgYW55O1xuICBcbiAgaWYgKHJlY29yZCkge1xuICAgIC8vIERlbGV0ZSB1c2VkIGNvZGUgKG9wdGlvbmFsLCBvciBqdXN0IHJlbHkgb24gZXhwaXJhdGlvbilcbiAgICAvLyBkYi5wcmVwYXJlKFwiREVMRVRFIEZST00gdmVyaWZpY2F0aW9uX2NvZGVzIFdIRVJFIGlkID0gP1wiKS5ydW4ocmVjb3JkLmlkKTtcbiAgICByZXR1cm4gdHJ1ZTtcbiAgfVxuICByZXR1cm4gZmFsc2U7XG59O1xuXG5leHBvcnQgY29uc3QgZ2V0T3JDcmVhdGVVc2VyID0gKGVtYWlsOiBzdHJpbmcsIG5hbWU/OiBzdHJpbmcpOiBVc2VyID0+IHtcbiAgY29uc3QgZGIgPSBnZXREYigpO1xuICBjb25zdCBub3cgPSBuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKCk7XG4gIFxuICBsZXQgdXNlciA9IGRiLnByZXBhcmUoXCJTRUxFQ1QgKiBGUk9NIHVzZXJzIFdIRVJFIGVtYWlsID0gP1wiKS5nZXQoZW1haWwpIGFzIFVzZXIgfCB1bmRlZmluZWQ7XG4gIFxuICBpZiAoIXVzZXIpIHtcbiAgICAvLyBPbmx5IHVzZWQgZm9yIE9UUCBsb2dpbiB3aGVyZSB3ZSBtaWdodCBpbXBsaWNpdGx5IGNyZWF0ZSB1c2VyIGlmIHdlIHdhbnRcbiAgICAvLyBCdXQgbm93IHdlIHByZWZlciBleHBsaWNpdCByZWdpc3RyYXRpb24uIFxuICAgIC8vIFRoaXMgZnVuY3Rpb24gaXMga2VwdCBmb3IgYmFja3dhcmQgY29tcGF0aWJpbGl0eSB3aXRoIHB1cmUgT1RQIGxvZ2luIGlmIHdlIHN0aWxsIHN1cHBvcnQgaXQgYXMgXCJtYWdpYyBsaW5rXCIgc3R5bGVcbiAgICBkYi5wcmVwYXJlKFwiSU5TRVJUIElOVE8gdXNlcnMgKGVtYWlsLCBuYW1lLCBjcmVhdGVkX2F0KSBWQUxVRVMgKD8sID8sID8pXCIpLnJ1bihlbWFpbCwgbmFtZSB8fCBlbWFpbC5zcGxpdCgnQCcpWzBdLCBub3cpO1xuICAgIHVzZXIgPSBkYi5wcmVwYXJlKFwiU0VMRUNUICogRlJPTSB1c2VycyBXSEVSRSBlbWFpbCA9ID9cIikuZ2V0KGVtYWlsKSBhcyBVc2VyO1xuICB9IGVsc2UgaWYgKG5hbWUgJiYgIXVzZXIubmFtZSkge1xuICAgIC8vIEJhY2tmaWxsIG5hbWUgaWYgbWlzc2luZyBhbmQgcHJvdmlkZWRcbiAgICBkYi5wcmVwYXJlKFwiVVBEQVRFIHVzZXJzIFNFVCBuYW1lID0gPyBXSEVSRSBpZCA9ID9cIikucnVuKG5hbWUsIHVzZXIuaWQpO1xuICAgIHVzZXIubmFtZSA9IG5hbWU7XG4gIH1cbiAgXG4gIHJldHVybiB1c2VyO1xufTtcblxuZXhwb3J0IGNvbnN0IGNyZWF0ZVVzZXJXaXRoUGFzc3dvcmQgPSAoZW1haWw6IHN0cmluZywgcGFzc3dvcmRIYXNoOiBzdHJpbmcsIG5hbWU6IHN0cmluZyk6IFVzZXIgfCB1bmRlZmluZWQgPT4ge1xuICBjb25zdCBkYiA9IGdldERiKCk7XG4gIGNvbnN0IG5vdyA9IG5ldyBEYXRlKCkudG9JU09TdHJpbmcoKTtcbiAgXG4gIHRyeSB7XG4gICAgZGIucHJlcGFyZShcIklOU0VSVCBJTlRPIHVzZXJzIChlbWFpbCwgcGFzc3dvcmRfaGFzaCwgbmFtZSwgY3JlYXRlZF9hdCkgVkFMVUVTICg/LCA/LCA/LCA/KVwiKS5ydW4oZW1haWwsIHBhc3N3b3JkSGFzaCwgbmFtZSwgbm93KTtcbiAgICByZXR1cm4gZGIucHJlcGFyZShcIlNFTEVDVCAqIEZST00gdXNlcnMgV0hFUkUgZW1haWwgPSA/XCIpLmdldChlbWFpbCkgYXMgVXNlciB8IHVuZGVmaW5lZDtcbiAgfSBjYXRjaCAoZXJyOiBhbnkpIHtcbiAgICBpZiAoZXJyLm1lc3NhZ2UuaW5jbHVkZXMoXCJVTklRVUUgY29uc3RyYWludCBmYWlsZWRcIikpIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcihcIlVzZXIgYWxyZWFkeSBleGlzdHNcIik7XG4gICAgfVxuICAgIHRocm93IGVycjtcbiAgfVxufTtcblxuZXhwb3J0IGNvbnN0IGdldFVzZXJCeUVtYWlsID0gKGVtYWlsOiBzdHJpbmcpOiBVc2VyIHwgdW5kZWZpbmVkID0+IHtcbiAgY29uc3QgZGIgPSBnZXREYigpO1xuICByZXR1cm4gZGIucHJlcGFyZShcIlNFTEVDVCAqIEZST00gdXNlcnMgV0hFUkUgZW1haWwgPSA/XCIpLmdldChlbWFpbCkgYXMgVXNlciB8IHVuZGVmaW5lZDtcbn07XG5cbmV4cG9ydCBjb25zdCB1cGRhdGVVc2VyUGFzc3dvcmQgPSAodXNlcklkOiBudW1iZXIsIHBhc3N3b3JkSGFzaDogc3RyaW5nKSA9PiB7XG4gIGNvbnN0IGRiID0gZ2V0RGIoKTtcbiAgZGIucHJlcGFyZShcIlVQREFURSB1c2VycyBTRVQgcGFzc3dvcmRfaGFzaCA9ID8gV0hFUkUgaWQgPSA/XCIpLnJ1bihwYXNzd29yZEhhc2gsIHVzZXJJZCk7XG59O1xuXG5leHBvcnQgY29uc3QgdXBkYXRlVXNlclByb2ZpbGUgPSAodXNlcklkOiBudW1iZXIsIHVwZGF0ZXM6IHsgbmFtZT86IHN0cmluZzsgYXZhdGFyPzogc3RyaW5nIH0pOiBVc2VyIHwgdW5kZWZpbmVkID0+IHtcbiAgY29uc3QgZGIgPSBnZXREYigpO1xuICBjb25zdCB7IG5hbWUsIGF2YXRhciB9ID0gdXBkYXRlcztcbiAgXG4gIGlmIChuYW1lICE9PSB1bmRlZmluZWQpIHtcbiAgICBkYi5wcmVwYXJlKFwiVVBEQVRFIHVzZXJzIFNFVCBuYW1lID0gPyBXSEVSRSBpZCA9ID9cIikucnVuKG5hbWUsIHVzZXJJZCk7XG4gIH1cbiAgaWYgKGF2YXRhciAhPT0gdW5kZWZpbmVkKSB7XG4gICAgZGIucHJlcGFyZShcIlVQREFURSB1c2VycyBTRVQgYXZhdGFyID0gPyBXSEVSRSBpZCA9ID9cIikucnVuKGF2YXRhciwgdXNlcklkKTtcbiAgfVxuICBcbiAgcmV0dXJuIGRiLnByZXBhcmUoXCJTRUxFQ1QgKiBGUk9NIHVzZXJzIFdIRVJFIGlkID0gP1wiKS5nZXQodXNlcklkKSBhcyBVc2VyIHwgdW5kZWZpbmVkO1xufTtcblxuLy8gSGVscGVyIHRvIHNhdmUgYSBtZXNzYWdlXG5leHBvcnQgY29uc3Qgc2F2ZU1lc3NhZ2VUb0RiID0gKFxuICBjb252ZXJzYXRpb25JZDogc3RyaW5nLCBcbiAgcm9sZTogXCJ1c2VyXCIgfCBcImFpXCIsIFxuICBjb250ZW50OiBzdHJpbmcsXG4gIGtpbmQ6IFwidGV4dFwiIHwgXCJhbmFseXNpc1wiID0gXCJ0ZXh0XCIsXG4gIG1ldGFkYXRhOiBzdHJpbmcgfCBudWxsID0gbnVsbCxcbiAgdXNlcklkOiBudW1iZXIgfCBudWxsID0gbnVsbCxcbiAgaW5pdGlhbFRpdGxlOiBzdHJpbmcgfCBudWxsID0gbnVsbCxcbiAgaW5pdGlhbFRvb2xJZDogc3RyaW5nIHwgbnVsbCA9IG51bGxcbikgPT4ge1xuICBjb25zdCBkYiA9IGdldERiKCk7XG4gIFxuICAvLyBFbnN1cmUgY29udmVyc2F0aW9uIGV4aXN0cy4gSWYgbm90LCBjcmVhdGUgaXQgd2l0aCBhIGRlZmF1bHQgdGl0bGUgb3Igc25pcHBldC5cbiAgLy8gSW4gYSByZWFsIGFwcCwgd2UgbWlnaHQgd2FudCB0byBnZW5lcmF0ZSBhIHRpdGxlIGZyb20gdGhlIGZpcnN0IG1lc3NhZ2UuXG4gIGNvbnN0IGNvbnYgPSBkYi5wcmVwYXJlKFwiU0VMRUNUIHVzZXJfaWQgRlJPTSBjb252ZXJzYXRpb25zIFdIRVJFIGlkID0gP1wiKS5nZXQoY29udmVyc2F0aW9uSWQpIGFzIGFueTtcbiAgXG4gIGlmICghY29udikge1xuICAgICAgLy8gVXNlIHByb3ZpZGVkIHRpdGxlIG9yIGNyZWF0ZSBhIGRlZmF1bHQgb25lXG4gICAgICBsZXQgdGl0bGUgPSBpbml0aWFsVGl0bGU7XG4gICAgICBpZiAoIXRpdGxlKSB7XG4gICAgICAgICB0aXRsZSA9IHJvbGUgPT09ICd1c2VyJyA/IChjb250ZW50LnNsaWNlKDAsIDIwKSArIChjb250ZW50Lmxlbmd0aCA+IDIwID8gXCIuLi5cIiA6IFwiXCIpKSA6IFwiTmV3IENoYXRcIjtcbiAgICAgIH1cbiAgICAgIGNyZWF0ZUNvbnZlcnNhdGlvbihjb252ZXJzYXRpb25JZCwgdGl0bGUsIGluaXRpYWxUb29sSWQsIHVzZXJJZCk7XG4gIH0gZWxzZSBpZiAodXNlcklkICYmIGNvbnYudXNlcl9pZCA9PT0gbnVsbCkge1xuICAgICAgLy8gQ2xhaW0gdGhlIGNvbnZlcnNhdGlvbiBpZiBpdCdzIGN1cnJlbnRseSBhbm9ueW1vdXMgYW5kIHdlIGhhdmUgYSB1c2VyXG4gICAgICBkYi5wcmVwYXJlKFwiVVBEQVRFIGNvbnZlcnNhdGlvbnMgU0VUIHVzZXJfaWQgPSA/IFdIRVJFIGlkID0gP1wiKS5ydW4odXNlcklkLCBjb252ZXJzYXRpb25JZCk7XG4gIH1cblxuICBjb25zdCBub3cgPSBuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKCk7XG4gIGNvbnN0IHN0bXQgPSBkYi5wcmVwYXJlKFwiSU5TRVJUIElOVE8gbWVzc2FnZXMgKGNvbnZlcnNhdGlvbl9pZCwgcm9sZSwgY29udGVudCwgY3JlYXRlZF9hdCwga2luZCwgbWV0YWRhdGEpIFZBTFVFUyAoPywgPywgPywgPywgPywgPylcIik7XG4gIHN0bXQucnVuKGNvbnZlcnNhdGlvbklkLCByb2xlLCBjb250ZW50LCBub3csIGtpbmQsIG1ldGFkYXRhKTtcblxuICAvLyBVcGRhdGUgY29udmVyc2F0aW9uIHVwZGF0ZWRfYXRcbiAgY29uc3QgdXBkYXRlU3RtdCA9IGRiLnByZXBhcmUoXCJVUERBVEUgY29udmVyc2F0aW9ucyBTRVQgdXBkYXRlZF9hdCA9ID8gV0hFUkUgaWQgPSA/XCIpO1xuICB1cGRhdGVTdG10LnJ1bihub3csIGNvbnZlcnNhdGlvbklkKTtcbn07XG5cbi8vIEhlbHBlciB0byBnZXQgcmVjZW50IG1lc3NhZ2VzXG5leHBvcnQgY29uc3QgZ2V0TWVzc2FnZXNGcm9tRGIgPSAoY29udmVyc2F0aW9uSWQ6IHN0cmluZywgbGltaXQ6IG51bWJlciA9IDEwKSA9PiB7XG4gIGNvbnN0IGRiID0gZ2V0RGIoKTtcbiAgLy8gR2V0IGxhc3QgTiBtZXNzYWdlcyBmb3Igc3BlY2lmaWMgY29udmVyc2F0aW9uLCB0aGVuIHJldmVyc2UgdG8gY2hyb25vbG9naWNhbCBvcmRlclxuICBjb25zdCBzdG10ID0gZGIucHJlcGFyZShgU0VMRUNUIGlkLCByb2xlLCBjb250ZW50LCBjcmVhdGVkX2F0LCBraW5kLCBtZXRhZGF0YSBGUk9NIG1lc3NhZ2VzIFdIRVJFIGNvbnZlcnNhdGlvbl9pZCA9ID8gT1JERVIgQlkgaWQgREVTQyBMSU1JVCA/YCk7XG4gIGNvbnN0IHJvd3MgPSBzdG10LmFsbChjb252ZXJzYXRpb25JZCwgbGltaXQpO1xuICByZXR1cm4gKHJvd3MgYXMgeyBpZDogbnVtYmVyOyByb2xlOiBzdHJpbmc7IGNvbnRlbnQ6IHN0cmluZzsgY3JlYXRlZF9hdDogc3RyaW5nOyBraW5kOiBzdHJpbmc7IG1ldGFkYXRhOiBzdHJpbmcgfCBudWxsIH1bXSkucmV2ZXJzZSgpO1xufTtcblxuZXhwb3J0IGNvbnN0IGNvdW50VXNlck1lc3NhZ2VzID0gKGNvbnZlcnNhdGlvbklkOiBzdHJpbmcpID0+IHtcbiAgY29uc3QgZGIgPSBnZXREYigpO1xuICBjb25zdCByZXN1bHQgPSBkYi5wcmVwYXJlKFwiU0VMRUNUIENPVU5UKCopIGFzIGNvdW50IEZST00gbWVzc2FnZXMgV0hFUkUgY29udmVyc2F0aW9uX2lkID0gPyBBTkQgcm9sZSA9ICd1c2VyJ1wiKS5nZXQoY29udmVyc2F0aW9uSWQpIGFzIHsgY291bnQ6IG51bWJlciB9O1xuICByZXR1cm4gcmVzdWx0ID8gcmVzdWx0LmNvdW50IDogMDtcbn07XG5cbi8vIEhlbHBlciB0byBnZXQgdXNlciBwcm9maWxlIChnZXQgdGhlIGxhdGVzdCBvbmUpXG5leHBvcnQgY29uc3QgZ2V0VXNlclByb2ZpbGVGcm9tRGIgPSAoKTogVXNlclByb2ZpbGUgfCBudWxsID0+IHtcbiAgY29uc3QgZGIgPSBnZXREYigpO1xuICBjb25zdCBzdG10ID0gZGIucHJlcGFyZShcIlNFTEVDVCAqIEZST00gdXNlcl9wcm9maWxlcyBPUkRFUiBCWSBpZCBERVNDIExJTUlUIDFcIik7XG4gIGNvbnN0IHJvdyA9IHN0bXQuZ2V0KCkgYXMgYW55O1xuICBcbiAgaWYgKCFyb3cpIHJldHVybiBudWxsO1xuICBcbiAgbGV0IHJhd1RhZ3MgPSB7fTtcbiAgdHJ5IHtcbiAgICByYXdUYWdzID0gSlNPTi5wYXJzZShyb3cudGFncyk7XG4gIH0gY2F0Y2ggKGUpIHtcbiAgICBjb25zb2xlLmVycm9yKFwiRmFpbGVkIHRvIHBhcnNlIHByb2ZpbGUgdGFnc1wiLCBlKTtcbiAgfVxuXG4gIC8vIFJ1bnRpbWUgTWlncmF0aW9uOiBDb252ZXJ0IG9sZCBzdHJpbmcgdGFncyB0byBuZXcgUHJvZmlsZVZhbHVlIHN0cnVjdHVyZVxuICBjb25zdCBkZW1vZ3JhcGhpY3M6IFJlY29yZDxzdHJpbmcsIGFueT4gPSB7fTtcbiAgZm9yIChjb25zdCBba2V5LCB2YWxdIG9mIE9iamVjdC5lbnRyaWVzKHJhd1RhZ3MpKSB7XG4gICAgaWYgKHR5cGVvZiB2YWwgPT09ICdzdHJpbmcnKSB7XG4gICAgICAvLyBPbGQgZm9ybWF0OiBqdXN0IHN0cmluZyB2YWx1ZVxuICAgICAgZGVtb2dyYXBoaWNzW2tleV0gPSB7IHZhbHVlOiB2YWwsIGNvbmZpZGVuY2U6IDUwIH07IC8vIERlZmF1bHQgbG93IGNvbmZpZGVuY2UgZm9yIGxlZ2FjeSBkYXRhXG4gICAgfSBlbHNlIHtcbiAgICAgIC8vIE5ldyBmb3JtYXQ6IGFscmVhZHkgb2JqZWN0XG4gICAgICBkZW1vZ3JhcGhpY3Nba2V5XSA9IHZhbDtcbiAgICB9XG4gIH1cblxuICByZXR1cm4ge1xuICAgIGRlbW9ncmFwaGljczogZGVtb2dyYXBoaWNzLFxuICAgIHBlcnNvbmFsaXR5OiByb3cucGVyc29uYWxpdHksXG4gICAgbGVhZGVyc2hpcF9sZXZlbDogSlNPTi5wYXJzZShyb3cubGVhZGVyc2hpcF9sZXZlbCksXG4gICAgbGFzdF91cGRhdGVkOiByb3cubGFzdF91cGRhdGVkXG4gIH07XG59O1xuXG4vLyBIZWxwZXIgdG8gZGVsZXRlIGEgY29udmVyc2F0aW9uIGFuZCBpdHMgbWVzc2FnZXNcbmV4cG9ydCBjb25zdCBkZWxldGVDb252ZXJzYXRpb24gPSAoaWQ6IHN0cmluZykgPT4ge1xuICBjb25zdCBkYiA9IGdldERiKCk7XG4gIC8vIERlbGV0ZSBtZXNzYWdlcyBmaXJzdFxuICBjb25zdCBkZWxldGVNZXNzYWdlc1N0bXQgPSBkYi5wcmVwYXJlKFwiREVMRVRFIEZST00gbWVzc2FnZXMgV0hFUkUgY29udmVyc2F0aW9uX2lkID0gP1wiKTtcbiAgZGVsZXRlTWVzc2FnZXNTdG10LnJ1bihpZCk7XG5cbiAgLy8gRGVsZXRlIGNvbnZlcnNhdGlvblxuICBjb25zdCBkZWxldGVDb252U3RtdCA9IGRiLnByZXBhcmUoXCJERUxFVEUgRlJPTSBjb252ZXJzYXRpb25zIFdIRVJFIGlkID0gP1wiKTtcbiAgZGVsZXRlQ29udlN0bXQucnVuKGlkKTtcbn07XG5cbmV4cG9ydCBjb25zdCBzZWFyY2hNZXNzYWdlcyA9IChxdWVyeTogc3RyaW5nLCB1c2VySWQ6IG51bWJlciB8IG51bGwgPSBudWxsKSA9PiB7XG4gIGNvbnN0IGRiID0gZ2V0RGIoKTtcbiAgLy8gU2VhcmNoIGZvciBtZXNzYWdlcyB0aGF0IG1hdGNoIHRoZSBxdWVyeSBPUiBjb252ZXJzYXRpb25zIHdob3NlIHRpdGxlIG1hdGNoZXMgdGhlIHF1ZXJ5XG4gIC8vIFdlIGpvaW4gY29udmVyc2F0aW9ucyB0byBnZXQgdGhlIHRpdGxlIGFuZCBmaWx0ZXIgYnkgdXNlcl9pZCBpZiBuZWVkZWRcbiAgbGV0IHNxbCA9IGBcbiAgICBTRUxFQ1QgXG4gICAgICBtLmlkIGFzIG1lc3NhZ2VfaWQsXG4gICAgICBtLmNvbnZlcnNhdGlvbl9pZCxcbiAgICAgIG0uY29udGVudCxcbiAgICAgIG0uY3JlYXRlZF9hdCxcbiAgICAgIGMudGl0bGUgYXMgY29udmVyc2F0aW9uX3RpdGxlXG4gICAgRlJPTSBtZXNzYWdlcyBtXG4gICAgSk9JTiBjb252ZXJzYXRpb25zIGMgT04gbS5jb252ZXJzYXRpb25faWQgPSBjLmlkXG4gICAgV0hFUkUgKG0uY29udGVudCBMSUtFID8gT1IgYy50aXRsZSBMSUtFID8pXG4gIGA7XG5cbiAgY29uc3QgcGFyYW1zOiBhbnlbXSA9IFtgJSR7cXVlcnl9JWAsIGAlJHtxdWVyeX0lYF07XG5cbiAgaWYgKHVzZXJJZCkge1xuICAgIHNxbCArPSBcIiBBTkQgYy51c2VyX2lkID0gP1wiO1xuICAgIHBhcmFtcy5wdXNoKHVzZXJJZCk7XG4gIH0gZWxzZSB7XG4gICAgLy8gSWYgbm8gdXNlcl9pZCwgd2UgbWlnaHQgd2FudCB0byByZXN0cmljdCB0byBwdWJsaWMvYW5vbnltb3VzIGNoYXRzIG9yIGp1c3Qgc2hvdyBhbGwgKGRlcGVuZGluZyBvbiByZXF1aXJlbWVudHMpXG4gICAgLy8gRm9yIG5vdywgbGV0J3MgYXNzdW1lIGlmIHVzZXJJZCBpcyBudWxsLCB3ZSBvbmx5IHNlYXJjaCBhbm9ueW1vdXMgY2hhdHMgdG8gYmUgc2FmZSwgXG4gICAgLy8gb3IgbWF5YmUgd2UganVzdCBkb24ndCBmaWx0ZXIuIFxuICAgIC8vIEdpdmVuIHRoZSByZXF1aXJlbWVudCBcInNlY3VyZSBjb252ZXJzYXRpb24gZGF0YVwiLCB3ZSBzaG91bGQgcHJvYmFibHkgZmlsdGVyIGJ5IHVzZXIgb3duZXJzaGlwLlxuICAgIC8vIElmIHVzZXJJZCBpcyBOT1QgcHJvdmlkZWQgKGUuZy4gc2VydmVyLXNpZGUgY29udGV4dCBpc3N1ZSksIHdlIHNob3VsZCBiZSBjYXJlZnVsLlxuICAgIC8vIEJ1dCB1c3VhbGx5IHRoaXMgaXMgY2FsbGVkIHdpdGggYSB2ZXJpZmllZCB1c2VyIElELlxuICAgIC8vIExldCdzIGFzc3VtZSB1c2VySWQgSVMgTlVMTCBtZWFucyBhbm9ueW1vdXMgdXNlciwgc28gd2Ugb25seSBzZWFyY2ggYW5vbnltb3VzIGNoYXRzLlxuICAgIHNxbCArPSBcIiBBTkQgYy51c2VyX2lkIElTIE5VTExcIjtcbiAgfVxuXG4gIHNxbCArPSBcIiBPUkRFUiBCWSBtLmNyZWF0ZWRfYXQgREVTQyBMSU1JVCA1MFwiO1xuXG4gIGNvbnN0IHN0bXQgPSBkYi5wcmVwYXJlKHNxbCk7XG4gIHJldHVybiBzdG10LmFsbCguLi5wYXJhbXMpIGFzIHtcbiAgICBtZXNzYWdlX2lkOiBudW1iZXI7XG4gICAgY29udmVyc2F0aW9uX2lkOiBzdHJpbmc7XG4gICAgY29udGVudDogc3RyaW5nO1xuICAgIGNyZWF0ZWRfYXQ6IHN0cmluZztcbiAgICBjb252ZXJzYXRpb25fdGl0bGU6IHN0cmluZztcbiAgfVtdO1xufTtcblxuLy8gSGVscGVyIHRvIHNhdmUgdXNlciBwcm9maWxlXG5leHBvcnQgY29uc3Qgc2F2ZVVzZXJQcm9maWxlVG9EYiA9IChwcm9maWxlOiBVc2VyUHJvZmlsZSkgPT4ge1xuICBjb25zdCBkYiA9IGdldERiKCk7XG4gIGNvbnN0IHN0bXQgPSBkYi5wcmVwYXJlKFxuICAgIFwiSU5TRVJUIElOVE8gdXNlcl9wcm9maWxlcyAodGFncywgcGVyc29uYWxpdHksIGxlYWRlcnNoaXBfbGV2ZWwsIGxhc3RfdXBkYXRlZCkgVkFMVUVTICg/LCA/LCA/LCA/KVwiXG4gICk7XG4gIHN0bXQucnVuKFxuICAgIEpTT04uc3RyaW5naWZ5KHByb2ZpbGUuZGVtb2dyYXBoaWNzKSwgXG4gICAgcHJvZmlsZS5wZXJzb25hbGl0eSwgXG4gICAgSlNPTi5zdHJpbmdpZnkocHJvZmlsZS5sZWFkZXJzaGlwX2xldmVsKSwgXG4gICAgbmV3IERhdGUoKS50b0lTT1N0cmluZygpXG4gICk7XG59O1xuXG4vLyBIZWxwZXIgdG8gaW5jcmVtZW50IHVzZXIgdG9rZW4gdXNhZ2VcbmV4cG9ydCBjb25zdCBpbmNyZW1lbnRVc2VyVG9rZW5zID0gKHVzZXJJZDogbnVtYmVyLCB0b3RhbDogbnVtYmVyLCBpbnB1dDogbnVtYmVyLCBvdXRwdXQ6IG51bWJlcikgPT4ge1xuICBjb25zdCBkYiA9IGdldERiKCk7XG4gIGNvbnN0IG5vdyA9IG5ldyBEYXRlKCkudG9JU09TdHJpbmcoKTtcbiAgXG4gIC8vIENoZWNrIGlmIHN0YXRzIGV4aXN0XG4gIGNvbnN0IGV4aXN0cyA9IGRiLnByZXBhcmUoXCJTRUxFQ1QgMSBGUk9NIHVzZXJfc3RhdHMgV0hFUkUgdXNlcl9pZCA9ID9cIikuZ2V0KHVzZXJJZCk7XG4gIFxuICBpZiAoZXhpc3RzKSB7XG4gICAgY29uc3Qgc3RtdCA9IGRiLnByZXBhcmUoYFxuICAgICAgVVBEQVRFIHVzZXJfc3RhdHMgXG4gICAgICBTRVQgdG90YWxfdG9rZW5zID0gdG90YWxfdG9rZW5zICsgPywgXG4gICAgICAgICAgaW5wdXRfdG9rZW5zID0gaW5wdXRfdG9rZW5zICsgPywgXG4gICAgICAgICAgb3V0cHV0X3Rva2VucyA9IG91dHB1dF90b2tlbnMgKyA/LCBcbiAgICAgICAgICBsYXN0X3VwZGF0ZWQgPSA/IFxuICAgICAgV0hFUkUgdXNlcl9pZCA9ID9cbiAgICBgKTtcbiAgICBzdG10LnJ1bih0b3RhbCwgaW5wdXQsIG91dHB1dCwgbm93LCB1c2VySWQpO1xuICB9IGVsc2Uge1xuICAgIGNvbnN0IHN0bXQgPSBkYi5wcmVwYXJlKGBcbiAgICAgIElOU0VSVCBJTlRPIHVzZXJfc3RhdHMgKHVzZXJfaWQsIHRvdGFsX3Rva2VucywgaW5wdXRfdG9rZW5zLCBvdXRwdXRfdG9rZW5zLCBsYXN0X3VwZGF0ZWQpIFxuICAgICAgVkFMVUVTICg/LCA/LCA/LCA/LCA/KVxuICAgIGApO1xuICAgIHN0bXQucnVuKHVzZXJJZCwgdG90YWwsIGlucHV0LCBvdXRwdXQsIG5vdyk7XG4gIH1cbn07XG5cbi8vIEhlbHBlciB0byBpbmNyZW1lbnQgdG9vbCB1c2FnZVxuZXhwb3J0IGNvbnN0IGluY3JlbWVudFRvb2xVc2FnZSA9ICh1c2VySWQ6IG51bWJlciwgdG9vbElkOiBzdHJpbmcpID0+IHtcbiAgaWYgKCF0b29sSWQpIHJldHVybjtcbiAgY29uc3QgZGIgPSBnZXREYigpO1xuICBjb25zdCBub3cgPSBuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKCk7XG4gIFxuICAvLyBDaGVjayBpZiBleGlzdHNcbiAgY29uc3QgZXhpc3RzID0gZGIucHJlcGFyZShcIlNFTEVDVCAxIEZST00gdG9vbF91c2FnZSBXSEVSRSB1c2VyX2lkID0gPyBBTkQgdG9vbF9pZCA9ID9cIikuZ2V0KHVzZXJJZCwgdG9vbElkKTtcbiAgXG4gIGlmIChleGlzdHMpIHtcbiAgICBjb25zdCBzdG10ID0gZGIucHJlcGFyZShcIlVQREFURSB0b29sX3VzYWdlIFNFVCB1c2FnZV9jb3VudCA9IHVzYWdlX2NvdW50ICsgMSwgbGFzdF91c2VkID0gPyBXSEVSRSB1c2VyX2lkID0gPyBBTkQgdG9vbF9pZCA9ID9cIik7XG4gICAgc3RtdC5ydW4obm93LCB1c2VySWQsIHRvb2xJZCk7XG4gIH0gZWxzZSB7XG4gICAgY29uc3Qgc3RtdCA9IGRiLnByZXBhcmUoXCJJTlNFUlQgSU5UTyB0b29sX3VzYWdlICh1c2VyX2lkLCB0b29sX2lkLCB1c2FnZV9jb3VudCwgbGFzdF91c2VkKSBWQUxVRVMgKD8sID8sIDEsID8pXCIpO1xuICAgIHN0bXQucnVuKHVzZXJJZCwgdG9vbElkLCBub3cpO1xuICB9XG59O1xuXG5leHBvcnQgY29uc3QgZ2V0VXNlclN0YXRzID0gKHVzZXJJZDogbnVtYmVyKSA9PiB7XG4gIGNvbnN0IGRiID0gZ2V0RGIoKTtcbiAgY29uc3Qgc3RhdHMgPSBkYi5wcmVwYXJlKFwiU0VMRUNUICogRlJPTSB1c2VyX3N0YXRzIFdIRVJFIHVzZXJfaWQgPSA/XCIpLmdldCh1c2VySWQpIGFzIGFueTtcbiAgY29uc3QgdG9vbHMgPSBkYi5wcmVwYXJlKFwiU0VMRUNUIHRvb2xfaWQsIHVzYWdlX2NvdW50IEZST00gdG9vbF91c2FnZSBXSEVSRSB1c2VyX2lkID0gPyBPUkRFUiBCWSB1c2FnZV9jb3VudCBERVNDXCIpLmFsbCh1c2VySWQpIGFzIGFueVtdO1xuICBcbiAgcmV0dXJuIHtcbiAgICB0b2tlbnM6IHN0YXRzIHx8IHsgdG90YWxfdG9rZW5zOiAwLCBpbnB1dF90b2tlbnM6IDAsIG91dHB1dF90b2tlbnM6IDAgfSxcbiAgICB0b29sX3VzYWdlOiB0b29scyB8fCBbXVxuICB9O1xufTtcblxuLy8gR2VuZXJpYyBFdmVudCBUcmFja2luZ1xuZXhwb3J0IGNvbnN0IHRyYWNrRXZlbnQgPSAoXG4gIHVzZXJJZDogbnVtYmVyIHwgbnVsbCwgXG4gIGV2ZW50VHlwZTogc3RyaW5nLCBcbiAgY2F0ZWdvcnk6IHN0cmluZyA9IFwiZ2VuZXJhbFwiLCBcbiAgZGF0YTogUmVjb3JkPHN0cmluZywgYW55PiA9IHt9XG4pID0+IHtcbiAgY29uc3QgZGIgPSBnZXREYigpO1xuICBjb25zdCBub3cgPSBuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKCk7XG4gIFxuICB0cnkge1xuICAgIGNvbnN0IHN0bXQgPSBkYi5wcmVwYXJlKFxuICAgICAgXCJJTlNFUlQgSU5UTyBhbmFseXRpY3NfZXZlbnRzICh1c2VyX2lkLCBldmVudF90eXBlLCBjYXRlZ29yeSwgZXZlbnRfZGF0YSwgY3JlYXRlZF9hdCkgVkFMVUVTICg/LCA/LCA/LCA/LCA/KVwiXG4gICAgKTtcbiAgICBzdG10LnJ1bih1c2VySWQsIGV2ZW50VHlwZSwgY2F0ZWdvcnksIEpTT04uc3RyaW5naWZ5KGRhdGEpLCBub3cpO1xuICB9IGNhdGNoIChlcnJvcikge1xuICAgIGNvbnNvbGUuZXJyb3IoXCJGYWlsZWQgdG8gdHJhY2sgZXZlbnQ6XCIsIGVycm9yKTtcbiAgfVxufTtcblxuZXhwb3J0IGNvbnN0IGdldEFuYWx5dGljc0V2ZW50cyA9IChsaW1pdDogbnVtYmVyID0gNTAsIHVzZXJJZDogbnVtYmVyIHwgbnVsbCA9IG51bGwpID0+IHtcbiAgY29uc3QgZGIgPSBnZXREYigpO1xuICBsZXQgc3FsID0gXCJTRUxFQ1QgKiBGUk9NIGFuYWx5dGljc19ldmVudHNcIjtcbiAgY29uc3QgcGFyYW1zOiBhbnlbXSA9IFtdO1xuXG4gIGlmICh1c2VySWQpIHtcbiAgICBzcWwgKz0gXCIgV0hFUkUgdXNlcl9pZCA9ID9cIjtcbiAgICBwYXJhbXMucHVzaCh1c2VySWQpO1xuICB9XG5cbiAgc3FsICs9IFwiIE9SREVSIEJZIGNyZWF0ZWRfYXQgREVTQyBMSU1JVCA/XCI7XG4gIHBhcmFtcy5wdXNoKGxpbWl0KTtcblxuICBjb25zdCBzdG10ID0gZGIucHJlcGFyZShzcWwpO1xuICByZXR1cm4gc3RtdC5hbGwoLi4ucGFyYW1zKTtcbn07XG4iXSwibmFtZXMiOlsicGF0aCIsIkRhdGFiYXNlIiwiZGJQYXRoIiwiam9pbiIsInByb2Nlc3MiLCJjd2QiLCJnbG9iYWxGb3JEYiIsImdsb2JhbCIsImdldERiIiwiZGJJbnN0YW5jZSIsImluaXRpYWxpemVTY2hlbWEiLCJpc0luaXRpYWxpemVkIiwiZGIiLCJleGVjIiwiY29sdW1ucyIsInByZXBhcmUiLCJhbGwiLCJoYXNOYW1lIiwic29tZSIsImNvbCIsIm5hbWUiLCJoYXNBdmF0YXIiLCJoYXNQYXNzd29yZEhhc2giLCJlIiwiY29uc29sZSIsImVycm9yIiwiaGFzQ29udmVyc2F0aW9uSWQiLCJoYXNVcGRhdGVkQXQiLCJoYXNUb29sSWQiLCJoYXNVc2VySWQiLCJoYXNLaW5kIiwiaGFzTWV0YWRhdGEiLCJjcmVhdGVDb252ZXJzYXRpb24iLCJpZCIsInRpdGxlIiwidG9vbElkIiwidXNlcklkIiwiZXhpc3RzIiwiZ2V0Iiwibm93IiwiRGF0ZSIsInRvSVNPU3RyaW5nIiwic3RtdCIsInJ1biIsInVwZGF0ZUNvbnZlcnNhdGlvblRpdGxlIiwibmV3VGl0bGUiLCJ1cGRhdGVDb252ZXJzYXRpb25Ub29sIiwiZ2V0Q29udmVyc2F0aW9uc0Zyb21EYiIsInNxbCIsInBhcmFtcyIsInB1c2giLCJnZXRDb252ZXJzYXRpb25CeUlkIiwic2F2ZVZlcmlmaWNhdGlvbkNvZGUiLCJlbWFpbCIsImNvZGUiLCJleHBpcmVzQXQiLCJjcmVhdGVkQXQiLCJ2ZXJpZnlDb2RlIiwicmVjb3JkIiwiZ2V0T3JDcmVhdGVVc2VyIiwidXNlciIsInNwbGl0IiwiY3JlYXRlVXNlcldpdGhQYXNzd29yZCIsInBhc3N3b3JkSGFzaCIsImVyciIsIm1lc3NhZ2UiLCJpbmNsdWRlcyIsIkVycm9yIiwiZ2V0VXNlckJ5RW1haWwiLCJ1cGRhdGVVc2VyUGFzc3dvcmQiLCJ1cGRhdGVVc2VyUHJvZmlsZSIsInVwZGF0ZXMiLCJhdmF0YXIiLCJ1bmRlZmluZWQiLCJzYXZlTWVzc2FnZVRvRGIiLCJjb252ZXJzYXRpb25JZCIsInJvbGUiLCJjb250ZW50Iiwia2luZCIsIm1ldGFkYXRhIiwiaW5pdGlhbFRpdGxlIiwiaW5pdGlhbFRvb2xJZCIsImNvbnYiLCJzbGljZSIsImxlbmd0aCIsInVzZXJfaWQiLCJ1cGRhdGVTdG10IiwiZ2V0TWVzc2FnZXNGcm9tRGIiLCJsaW1pdCIsInJvd3MiLCJyZXZlcnNlIiwiY291bnRVc2VyTWVzc2FnZXMiLCJyZXN1bHQiLCJjb3VudCIsImdldFVzZXJQcm9maWxlRnJvbURiIiwicm93IiwicmF3VGFncyIsIkpTT04iLCJwYXJzZSIsInRhZ3MiLCJkZW1vZ3JhcGhpY3MiLCJrZXkiLCJ2YWwiLCJPYmplY3QiLCJlbnRyaWVzIiwidmFsdWUiLCJjb25maWRlbmNlIiwicGVyc29uYWxpdHkiLCJsZWFkZXJzaGlwX2xldmVsIiwibGFzdF91cGRhdGVkIiwiZGVsZXRlQ29udmVyc2F0aW9uIiwiZGVsZXRlTWVzc2FnZXNTdG10IiwiZGVsZXRlQ29udlN0bXQiLCJzZWFyY2hNZXNzYWdlcyIsInF1ZXJ5Iiwic2F2ZVVzZXJQcm9maWxlVG9EYiIsInByb2ZpbGUiLCJzdHJpbmdpZnkiLCJpbmNyZW1lbnRVc2VyVG9rZW5zIiwidG90YWwiLCJpbnB1dCIsIm91dHB1dCIsImluY3JlbWVudFRvb2xVc2FnZSIsImdldFVzZXJTdGF0cyIsInN0YXRzIiwidG9vbHMiLCJ0b2tlbnMiLCJ0b3RhbF90b2tlbnMiLCJpbnB1dF90b2tlbnMiLCJvdXRwdXRfdG9rZW5zIiwidG9vbF91c2FnZSIsInRyYWNrRXZlbnQiLCJldmVudFR5cGUiLCJjYXRlZ29yeSIsImRhdGEiLCJnZXRBbmFseXRpY3NFdmVudHMiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./lib/db.ts\n");

/***/ }),

/***/ "(rsc)/./lib/session.ts":
/*!************************!*\
  !*** ./lib/session.ts ***!
  \************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   getCurrentUser: () => (/* binding */ getCurrentUser)\n/* harmony export */ });\n/* harmony import */ var next_headers__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/headers */ \"(rsc)/./node_modules/next/dist/api/headers.js\");\n/* harmony import */ var jsonwebtoken__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! jsonwebtoken */ \"(rsc)/./node_modules/jsonwebtoken/index.js\");\n/* harmony import */ var jsonwebtoken__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(jsonwebtoken__WEBPACK_IMPORTED_MODULE_1__);\n\n\nconst JWT_SECRET = process.env.JWT_SECRET || \"default-secret\";\nfunction getCurrentUser() {\n    const cookieStore = (0,next_headers__WEBPACK_IMPORTED_MODULE_0__.cookies)();\n    const token = cookieStore.get(\"auth_token\");\n    if (!token) return null;\n    try {\n        const decoded = jsonwebtoken__WEBPACK_IMPORTED_MODULE_1___default().verify(token.value, JWT_SECRET);\n        return {\n            id: decoded.userId,\n            email: decoded.email\n        };\n    } catch (error) {\n        return null;\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9saWIvc2Vzc2lvbi50cyIsIm1hcHBpbmdzIjoiOzs7Ozs7O0FBQXVDO0FBQ1I7QUFFL0IsTUFBTUUsYUFBYUMsUUFBUUMsR0FBRyxDQUFDRixVQUFVLElBQUk7QUFFdEMsU0FBU0c7SUFDZCxNQUFNQyxjQUFjTixxREFBT0E7SUFDM0IsTUFBTU8sUUFBUUQsWUFBWUUsR0FBRyxDQUFDO0lBRTlCLElBQUksQ0FBQ0QsT0FBTyxPQUFPO0lBRW5CLElBQUk7UUFDRixNQUFNRSxVQUFVUiwwREFBVSxDQUFDTSxNQUFNSSxLQUFLLEVBQUVUO1FBQ3hDLE9BQU87WUFBRVUsSUFBSUgsUUFBUUksTUFBTTtZQUFFQyxPQUFPTCxRQUFRSyxLQUFLO1FBQUM7SUFDcEQsRUFBRSxPQUFPQyxPQUFPO1FBQ2QsT0FBTztJQUNUO0FBQ0YiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9haS1jb2FjaC1mcm9udGVuZC8uL2xpYi9zZXNzaW9uLnRzPzFkZTEiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgY29va2llcyB9IGZyb20gXCJuZXh0L2hlYWRlcnNcIjtcbmltcG9ydCBqd3QgZnJvbSBcImpzb253ZWJ0b2tlblwiO1xuXG5jb25zdCBKV1RfU0VDUkVUID0gcHJvY2Vzcy5lbnYuSldUX1NFQ1JFVCB8fCBcImRlZmF1bHQtc2VjcmV0XCI7XG5cbmV4cG9ydCBmdW5jdGlvbiBnZXRDdXJyZW50VXNlcigpIHtcbiAgY29uc3QgY29va2llU3RvcmUgPSBjb29raWVzKCk7XG4gIGNvbnN0IHRva2VuID0gY29va2llU3RvcmUuZ2V0KFwiYXV0aF90b2tlblwiKTtcblxuICBpZiAoIXRva2VuKSByZXR1cm4gbnVsbDtcblxuICB0cnkge1xuICAgIGNvbnN0IGRlY29kZWQgPSBqd3QudmVyaWZ5KHRva2VuLnZhbHVlLCBKV1RfU0VDUkVUKSBhcyBhbnk7XG4gICAgcmV0dXJuIHsgaWQ6IGRlY29kZWQudXNlcklkLCBlbWFpbDogZGVjb2RlZC5lbWFpbCB9O1xuICB9IGNhdGNoIChlcnJvcikge1xuICAgIHJldHVybiBudWxsO1xuICB9XG59XG4iXSwibmFtZXMiOlsiY29va2llcyIsImp3dCIsIkpXVF9TRUNSRVQiLCJwcm9jZXNzIiwiZW52IiwiZ2V0Q3VycmVudFVzZXIiLCJjb29raWVTdG9yZSIsInRva2VuIiwiZ2V0IiwiZGVjb2RlZCIsInZlcmlmeSIsInZhbHVlIiwiaWQiLCJ1c2VySWQiLCJlbWFpbCIsImVycm9yIl0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./lib/session.ts\n");

/***/ })

};
;

// load runtime
var __webpack_require__ = require("../../../webpack-runtime.js");
__webpack_require__.C(exports);
var __webpack_exec__ = (moduleId) => (__webpack_require__(__webpack_require__.s = moduleId))
var __webpack_exports__ = __webpack_require__.X(0, ["vendor-chunks/next","vendor-chunks/ms","vendor-chunks/semver","vendor-chunks/jsonwebtoken","vendor-chunks/lodash.includes","vendor-chunks/jws","vendor-chunks/jwa","vendor-chunks/lodash.once","vendor-chunks/lodash.isinteger","vendor-chunks/ecdsa-sig-formatter","vendor-chunks/lodash.isplainobject","vendor-chunks/lodash.isstring","vendor-chunks/lodash.isnumber","vendor-chunks/lodash.isboolean","vendor-chunks/safe-buffer","vendor-chunks/buffer-equal-constant-time"], () => (__webpack_exec__("(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fhistory%2Froute&page=%2Fapi%2Fhistory%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fhistory%2Froute.ts&appDir=G%3A%5CTrea%5CAICoach%5Cfrontend%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=G%3A%5CTrea%5CAICoach%5Cfrontend&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!")));
module.exports = __webpack_exports__;

})();