"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(() => {
var exports = {};
exports.id = "app/api/history/route";
exports.ids = ["app/api/history/route"];
exports.modules = {

/***/ "../../client/components/action-async-storage.external":
/*!*******************************************************************************!*\
  !*** external "next/dist/client/components/action-async-storage.external.js" ***!
  \*******************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/client/components/action-async-storage.external.js");

/***/ }),

/***/ "../../client/components/request-async-storage.external":
/*!********************************************************************************!*\
  !*** external "next/dist/client/components/request-async-storage.external.js" ***!
  \********************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/client/components/request-async-storage.external.js");

/***/ }),

/***/ "../../client/components/static-generation-async-storage.external":
/*!******************************************************************************************!*\
  !*** external "next/dist/client/components/static-generation-async-storage.external.js" ***!
  \******************************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/client/components/static-generation-async-storage.external.js");

/***/ }),

/***/ "next/dist/compiled/next-server/app-route.runtime.dev.js":
/*!**************************************************************************!*\
  !*** external "next/dist/compiled/next-server/app-route.runtime.dev.js" ***!
  \**************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/app-route.runtime.dev.js");

/***/ }),

/***/ "buffer":
/*!*************************!*\
  !*** external "buffer" ***!
  \*************************/
/***/ ((module) => {

module.exports = require("buffer");

/***/ }),

/***/ "crypto":
/*!*************************!*\
  !*** external "crypto" ***!
  \*************************/
/***/ ((module) => {

module.exports = require("crypto");

/***/ }),

/***/ "node:sqlite":
/*!******************************!*\
  !*** external "node:sqlite" ***!
  \******************************/
/***/ ((module) => {

module.exports = require("node:sqlite");

/***/ }),

/***/ "path":
/*!***********************!*\
  !*** external "path" ***!
  \***********************/
/***/ ((module) => {

module.exports = require("path");

/***/ }),

/***/ "stream":
/*!*************************!*\
  !*** external "stream" ***!
  \*************************/
/***/ ((module) => {

module.exports = require("stream");

/***/ }),

/***/ "util":
/*!***********************!*\
  !*** external "util" ***!
  \***********************/
/***/ ((module) => {

module.exports = require("util");

/***/ }),

/***/ "(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fhistory%2Froute&page=%2Fapi%2Fhistory%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fhistory%2Froute.ts&appDir=G%3A%5CTrea%5CAICoach%5Cfrontend%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=G%3A%5CTrea%5CAICoach%5Cfrontend&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!":
/*!*****************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fhistory%2Froute&page=%2Fapi%2Fhistory%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fhistory%2Froute.ts&appDir=G%3A%5CTrea%5CAICoach%5Cfrontend%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=G%3A%5CTrea%5CAICoach%5Cfrontend&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D! ***!
  \*****************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   headerHooks: () => (/* binding */ headerHooks),\n/* harmony export */   originalPathname: () => (/* binding */ originalPathname),\n/* harmony export */   patchFetch: () => (/* binding */ patchFetch),\n/* harmony export */   requestAsyncStorage: () => (/* binding */ requestAsyncStorage),\n/* harmony export */   routeModule: () => (/* binding */ routeModule),\n/* harmony export */   serverHooks: () => (/* binding */ serverHooks),\n/* harmony export */   staticGenerationAsyncStorage: () => (/* binding */ staticGenerationAsyncStorage),\n/* harmony export */   staticGenerationBailout: () => (/* binding */ staticGenerationBailout)\n/* harmony export */ });\n/* harmony import */ var next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/dist/server/future/route-modules/app-route/module.compiled */ \"(rsc)/./node_modules/next/dist/server/future/route-modules/app-route/module.compiled.js\");\n/* harmony import */ var next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! next/dist/server/future/route-kind */ \"(rsc)/./node_modules/next/dist/server/future/route-kind.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! next/dist/server/lib/patch-fetch */ \"(rsc)/./node_modules/next/dist/server/lib/patch-fetch.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var G_Trea_AICoach_frontend_app_api_history_route_ts__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./app/api/history/route.ts */ \"(rsc)/./app/api/history/route.ts\");\n\n\n\n\n// We inject the nextConfigOutput here so that we can use them in the route\n// module.\nconst nextConfigOutput = \"\"\nconst routeModule = new next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__.AppRouteRouteModule({\n    definition: {\n        kind: next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__.RouteKind.APP_ROUTE,\n        page: \"/api/history/route\",\n        pathname: \"/api/history\",\n        filename: \"route\",\n        bundlePath: \"app/api/history/route\"\n    },\n    resolvedPagePath: \"G:\\\\Trea\\\\AICoach\\\\frontend\\\\app\\\\api\\\\history\\\\route.ts\",\n    nextConfigOutput,\n    userland: G_Trea_AICoach_frontend_app_api_history_route_ts__WEBPACK_IMPORTED_MODULE_3__\n});\n// Pull out the exports that we need to expose from the module. This should\n// be eliminated when we've moved the other routes to the new format. These\n// are used to hook into the route.\nconst { requestAsyncStorage, staticGenerationAsyncStorage, serverHooks, headerHooks, staticGenerationBailout } = routeModule;\nconst originalPathname = \"/api/history/route\";\nfunction patchFetch() {\n    return (0,next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__.patchFetch)({\n        serverHooks,\n        staticGenerationAsyncStorage\n    });\n}\n\n\n//# sourceMappingURL=app-route.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvbmV4dC9kaXN0L2J1aWxkL3dlYnBhY2svbG9hZGVycy9uZXh0LWFwcC1sb2FkZXIuanM/bmFtZT1hcHAlMkZhcGklMkZoaXN0b3J5JTJGcm91dGUmcGFnZT0lMkZhcGklMkZoaXN0b3J5JTJGcm91dGUmYXBwUGF0aHM9JnBhZ2VQYXRoPXByaXZhdGUtbmV4dC1hcHAtZGlyJTJGYXBpJTJGaGlzdG9yeSUyRnJvdXRlLnRzJmFwcERpcj1HJTNBJTVDVHJlYSU1Q0FJQ29hY2glNUNmcm9udGVuZCU1Q2FwcCZwYWdlRXh0ZW5zaW9ucz10c3gmcGFnZUV4dGVuc2lvbnM9dHMmcGFnZUV4dGVuc2lvbnM9anN4JnBhZ2VFeHRlbnNpb25zPWpzJnJvb3REaXI9RyUzQSU1Q1RyZWElNUNBSUNvYWNoJTVDZnJvbnRlbmQmaXNEZXY9dHJ1ZSZ0c2NvbmZpZ1BhdGg9dHNjb25maWcuanNvbiZiYXNlUGF0aD0mYXNzZXRQcmVmaXg9Jm5leHRDb25maWdPdXRwdXQ9JnByZWZlcnJlZFJlZ2lvbj0mbWlkZGxld2FyZUNvbmZpZz1lMzAlM0QhIiwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7Ozs7O0FBQXNHO0FBQ3ZDO0FBQ2M7QUFDUTtBQUNyRjtBQUNBO0FBQ0E7QUFDQSx3QkFBd0IsZ0hBQW1CO0FBQzNDO0FBQ0EsY0FBYyx5RUFBUztBQUN2QjtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0EsWUFBWTtBQUNaLENBQUM7QUFDRDtBQUNBO0FBQ0E7QUFDQSxRQUFRLHVHQUF1RztBQUMvRztBQUNBO0FBQ0EsV0FBVyw0RUFBVztBQUN0QjtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQzZKOztBQUU3SiIsInNvdXJjZXMiOlsid2VicGFjazovL2FpLWNvYWNoLWZyb250ZW5kLz9mYjE1Il0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IEFwcFJvdXRlUm91dGVNb2R1bGUgfSBmcm9tIFwibmV4dC9kaXN0L3NlcnZlci9mdXR1cmUvcm91dGUtbW9kdWxlcy9hcHAtcm91dGUvbW9kdWxlLmNvbXBpbGVkXCI7XG5pbXBvcnQgeyBSb3V0ZUtpbmQgfSBmcm9tIFwibmV4dC9kaXN0L3NlcnZlci9mdXR1cmUvcm91dGUta2luZFwiO1xuaW1wb3J0IHsgcGF0Y2hGZXRjaCBhcyBfcGF0Y2hGZXRjaCB9IGZyb20gXCJuZXh0L2Rpc3Qvc2VydmVyL2xpYi9wYXRjaC1mZXRjaFwiO1xuaW1wb3J0ICogYXMgdXNlcmxhbmQgZnJvbSBcIkc6XFxcXFRyZWFcXFxcQUlDb2FjaFxcXFxmcm9udGVuZFxcXFxhcHBcXFxcYXBpXFxcXGhpc3RvcnlcXFxccm91dGUudHNcIjtcbi8vIFdlIGluamVjdCB0aGUgbmV4dENvbmZpZ091dHB1dCBoZXJlIHNvIHRoYXQgd2UgY2FuIHVzZSB0aGVtIGluIHRoZSByb3V0ZVxuLy8gbW9kdWxlLlxuY29uc3QgbmV4dENvbmZpZ091dHB1dCA9IFwiXCJcbmNvbnN0IHJvdXRlTW9kdWxlID0gbmV3IEFwcFJvdXRlUm91dGVNb2R1bGUoe1xuICAgIGRlZmluaXRpb246IHtcbiAgICAgICAga2luZDogUm91dGVLaW5kLkFQUF9ST1VURSxcbiAgICAgICAgcGFnZTogXCIvYXBpL2hpc3Rvcnkvcm91dGVcIixcbiAgICAgICAgcGF0aG5hbWU6IFwiL2FwaS9oaXN0b3J5XCIsXG4gICAgICAgIGZpbGVuYW1lOiBcInJvdXRlXCIsXG4gICAgICAgIGJ1bmRsZVBhdGg6IFwiYXBwL2FwaS9oaXN0b3J5L3JvdXRlXCJcbiAgICB9LFxuICAgIHJlc29sdmVkUGFnZVBhdGg6IFwiRzpcXFxcVHJlYVxcXFxBSUNvYWNoXFxcXGZyb250ZW5kXFxcXGFwcFxcXFxhcGlcXFxcaGlzdG9yeVxcXFxyb3V0ZS50c1wiLFxuICAgIG5leHRDb25maWdPdXRwdXQsXG4gICAgdXNlcmxhbmRcbn0pO1xuLy8gUHVsbCBvdXQgdGhlIGV4cG9ydHMgdGhhdCB3ZSBuZWVkIHRvIGV4cG9zZSBmcm9tIHRoZSBtb2R1bGUuIFRoaXMgc2hvdWxkXG4vLyBiZSBlbGltaW5hdGVkIHdoZW4gd2UndmUgbW92ZWQgdGhlIG90aGVyIHJvdXRlcyB0byB0aGUgbmV3IGZvcm1hdC4gVGhlc2Vcbi8vIGFyZSB1c2VkIHRvIGhvb2sgaW50byB0aGUgcm91dGUuXG5jb25zdCB7IHJlcXVlc3RBc3luY1N0b3JhZ2UsIHN0YXRpY0dlbmVyYXRpb25Bc3luY1N0b3JhZ2UsIHNlcnZlckhvb2tzLCBoZWFkZXJIb29rcywgc3RhdGljR2VuZXJhdGlvbkJhaWxvdXQgfSA9IHJvdXRlTW9kdWxlO1xuY29uc3Qgb3JpZ2luYWxQYXRobmFtZSA9IFwiL2FwaS9oaXN0b3J5L3JvdXRlXCI7XG5mdW5jdGlvbiBwYXRjaEZldGNoKCkge1xuICAgIHJldHVybiBfcGF0Y2hGZXRjaCh7XG4gICAgICAgIHNlcnZlckhvb2tzLFxuICAgICAgICBzdGF0aWNHZW5lcmF0aW9uQXN5bmNTdG9yYWdlXG4gICAgfSk7XG59XG5leHBvcnQgeyByb3V0ZU1vZHVsZSwgcmVxdWVzdEFzeW5jU3RvcmFnZSwgc3RhdGljR2VuZXJhdGlvbkFzeW5jU3RvcmFnZSwgc2VydmVySG9va3MsIGhlYWRlckhvb2tzLCBzdGF0aWNHZW5lcmF0aW9uQmFpbG91dCwgb3JpZ2luYWxQYXRobmFtZSwgcGF0Y2hGZXRjaCwgIH07XG5cbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWFwcC1yb3V0ZS5qcy5tYXAiXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fhistory%2Froute&page=%2Fapi%2Fhistory%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fhistory%2Froute.ts&appDir=G%3A%5CTrea%5CAICoach%5Cfrontend%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=G%3A%5CTrea%5CAICoach%5Cfrontend&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!\n");

/***/ }),

/***/ "(rsc)/./app/api/history/route.ts":
/*!**********************************!*\
  !*** ./app/api/history/route.ts ***!
  \**********************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   GET: () => (/* binding */ GET),\n/* harmony export */   dynamic: () => (/* binding */ dynamic)\n/* harmony export */ });\n/* harmony import */ var next_dist_server_web_exports_next_response__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/dist/server/web/exports/next-response */ \"(rsc)/./node_modules/next/dist/server/web/exports/next-response.js\");\n/* harmony import */ var _lib_db__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @/lib/db */ \"(rsc)/./lib/db.ts\");\n/* harmony import */ var _lib_session__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @/lib/session */ \"(rsc)/./lib/session.ts\");\n\n\n\nconst dynamic = \"force-dynamic\";\nasync function GET() {\n    try {\n        const user = (0,_lib_session__WEBPACK_IMPORTED_MODULE_2__.getCurrentUser)();\n        const userId = user ? user.id : null;\n        const rows = (0,_lib_db__WEBPACK_IMPORTED_MODULE_1__.getConversationsFromDb)(userId);\n        return next_dist_server_web_exports_next_response__WEBPACK_IMPORTED_MODULE_0__[\"default\"].json(rows);\n    } catch (error) {\n        console.error(\"Failed to fetch conversations:\", error);\n        return next_dist_server_web_exports_next_response__WEBPACK_IMPORTED_MODULE_0__[\"default\"].json({\n            error: \"Failed to fetch conversations\"\n        }, {\n            status: 500\n        });\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9hcHAvYXBpL2hpc3Rvcnkvcm91dGUudHMiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7QUFBMkM7QUFDTztBQUNIO0FBRXhDLE1BQU1HLFVBQVUsZ0JBQWdCO0FBRWhDLGVBQWVDO0lBQ3BCLElBQUk7UUFDRixNQUFNQyxPQUFPSCw0REFBY0E7UUFDM0IsTUFBTUksU0FBU0QsT0FBT0EsS0FBS0UsRUFBRSxHQUFHO1FBRWhDLE1BQU1DLE9BQU9QLCtEQUFzQkEsQ0FBQ0s7UUFDcEMsT0FBT04sa0ZBQVlBLENBQUNTLElBQUksQ0FBQ0Q7SUFDM0IsRUFBRSxPQUFPRSxPQUFPO1FBQ2RDLFFBQVFELEtBQUssQ0FBQyxrQ0FBa0NBO1FBQ2hELE9BQU9WLGtGQUFZQSxDQUFDUyxJQUFJLENBQUM7WUFBRUMsT0FBTztRQUFnQyxHQUFHO1lBQUVFLFFBQVE7UUFBSTtJQUNyRjtBQUNGIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vYWktY29hY2gtZnJvbnRlbmQvLi9hcHAvYXBpL2hpc3Rvcnkvcm91dGUudHM/OTMyOSJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBOZXh0UmVzcG9uc2UgfSBmcm9tIFwibmV4dC9zZXJ2ZXJcIjtcbmltcG9ydCB7IGdldENvbnZlcnNhdGlvbnNGcm9tRGIgfSBmcm9tIFwiQC9saWIvZGJcIjtcbmltcG9ydCB7IGdldEN1cnJlbnRVc2VyIH0gZnJvbSBcIkAvbGliL3Nlc3Npb25cIjtcblxuZXhwb3J0IGNvbnN0IGR5bmFtaWMgPSBcImZvcmNlLWR5bmFtaWNcIjtcblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIEdFVCgpIHtcbiAgdHJ5IHtcbiAgICBjb25zdCB1c2VyID0gZ2V0Q3VycmVudFVzZXIoKTtcbiAgICBjb25zdCB1c2VySWQgPSB1c2VyID8gdXNlci5pZCA6IG51bGw7XG4gICAgXG4gICAgY29uc3Qgcm93cyA9IGdldENvbnZlcnNhdGlvbnNGcm9tRGIodXNlcklkKTtcbiAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24ocm93cyk7XG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgY29uc29sZS5lcnJvcihcIkZhaWxlZCB0byBmZXRjaCBjb252ZXJzYXRpb25zOlwiLCBlcnJvcik7XG4gICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKHsgZXJyb3I6IFwiRmFpbGVkIHRvIGZldGNoIGNvbnZlcnNhdGlvbnNcIiB9LCB7IHN0YXR1czogNTAwIH0pO1xuICB9XG59XG4iXSwibmFtZXMiOlsiTmV4dFJlc3BvbnNlIiwiZ2V0Q29udmVyc2F0aW9uc0Zyb21EYiIsImdldEN1cnJlbnRVc2VyIiwiZHluYW1pYyIsIkdFVCIsInVzZXIiLCJ1c2VySWQiLCJpZCIsInJvd3MiLCJqc29uIiwiZXJyb3IiLCJjb25zb2xlIiwic3RhdHVzIl0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./app/api/history/route.ts\n");

/***/ }),

/***/ "(rsc)/./lib/db.ts":
/*!*******************!*\
  !*** ./lib/db.ts ***!
  \*******************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   countUserMessages: () => (/* binding */ countUserMessages),\n/* harmony export */   createConversation: () => (/* binding */ createConversation),\n/* harmony export */   createUserWithPassword: () => (/* binding */ createUserWithPassword),\n/* harmony export */   deleteConversation: () => (/* binding */ deleteConversation),\n/* harmony export */   getAnalyticsEvents: () => (/* binding */ getAnalyticsEvents),\n/* harmony export */   getConversationById: () => (/* binding */ getConversationById),\n/* harmony export */   getConversationsFromDb: () => (/* binding */ getConversationsFromDb),\n/* harmony export */   getDb: () => (/* binding */ getDb),\n/* harmony export */   getMessagesFromDb: () => (/* binding */ getMessagesFromDb),\n/* harmony export */   getOrCreateUser: () => (/* binding */ getOrCreateUser),\n/* harmony export */   getUserByEmail: () => (/* binding */ getUserByEmail),\n/* harmony export */   getUserProfileFromDb: () => (/* binding */ getUserProfileFromDb),\n/* harmony export */   getUserStats: () => (/* binding */ getUserStats),\n/* harmony export */   incrementToolUsage: () => (/* binding */ incrementToolUsage),\n/* harmony export */   incrementUserTokens: () => (/* binding */ incrementUserTokens),\n/* harmony export */   saveMessageToDb: () => (/* binding */ saveMessageToDb),\n/* harmony export */   saveUserProfileToDb: () => (/* binding */ saveUserProfileToDb),\n/* harmony export */   saveVerificationCode: () => (/* binding */ saveVerificationCode),\n/* harmony export */   searchMessages: () => (/* binding */ searchMessages),\n/* harmony export */   trackEvent: () => (/* binding */ trackEvent),\n/* harmony export */   updateConversationTitle: () => (/* binding */ updateConversationTitle),\n/* harmony export */   updateConversationTool: () => (/* binding */ updateConversationTool),\n/* harmony export */   updateUserPassword: () => (/* binding */ updateUserPassword),\n/* harmony export */   updateUserProfile: () => (/* binding */ updateUserProfile),\n/* harmony export */   verifyCode: () => (/* binding */ verifyCode)\n/* harmony export */ });\n/* harmony import */ var path__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! path */ \"path\");\n/* harmony import */ var path__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(path__WEBPACK_IMPORTED_MODULE_0__);\n\nconst { DatabaseSync } = __webpack_require__(/*! node:sqlite */ \"node:sqlite\");\nconst dbPath = path__WEBPACK_IMPORTED_MODULE_0___default().join(process.cwd(), \"sqlite.db\");\n// Use a global variable to store the database instance in development\n// to prevent multiple connections during hot reloading\nconst globalForDb = global;\nconst getDb = ()=>{\n    if (!globalForDb.dbInstance) {\n        globalForDb.dbInstance = new DatabaseSync(dbPath);\n        initializeSchema(globalForDb.dbInstance);\n    } else {\n        // Ensure schema is up to date (safe due to IF NOT EXISTS)\n        initializeSchema(globalForDb.dbInstance);\n    }\n    return globalForDb.dbInstance;\n};\nconst initializeSchema = (db)=>{\n    db.exec(`CREATE TABLE IF NOT EXISTS conversations (\n       id TEXT PRIMARY KEY, \n       title TEXT NOT NULL, \n       created_at TEXT NOT NULL,\n       updated_at TEXT NOT NULL,\n       tool_id TEXT\n     )`);\n    db.exec(`CREATE TABLE IF NOT EXISTS messages (\n       id INTEGER PRIMARY KEY AUTOINCREMENT, \n       conversation_id TEXT NOT NULL,\n       role TEXT NOT NULL, \n       content TEXT NOT NULL, \n       created_at TEXT NOT NULL\n     )`);\n    // New Table: User Profiles\n    db.exec(`CREATE TABLE IF NOT EXISTS user_profiles (\n       id INTEGER PRIMARY KEY AUTOINCREMENT,\n       tags TEXT NOT NULL,\n       personality TEXT NOT NULL,\n       leadership_level TEXT NOT NULL,\n       last_updated TEXT NOT NULL\n     )`);\n    // New Table: Users (for Auth)\n    db.exec(`CREATE TABLE IF NOT EXISTS users (\n       id INTEGER PRIMARY KEY AUTOINCREMENT,\n       email TEXT UNIQUE NOT NULL,\n       name TEXT,\n       avatar TEXT,\n       created_at TEXT NOT NULL\n     )`);\n    // Migration for existing users table\n    try {\n        const columns = db.prepare(\"PRAGMA table_info(users)\").all();\n        const hasName = columns.some((col)=>col.name === \"name\");\n        if (!hasName) {\n            db.exec(\"ALTER TABLE users ADD COLUMN name TEXT\");\n        }\n        const hasAvatar = columns.some((col)=>col.name === \"avatar\");\n        if (!hasAvatar) {\n            db.exec(\"ALTER TABLE users ADD COLUMN avatar TEXT\");\n        }\n        const hasPasswordHash = columns.some((col)=>col.name === \"password_hash\");\n        if (!hasPasswordHash) {\n            db.exec(\"ALTER TABLE users ADD COLUMN password_hash TEXT\");\n        }\n    } catch (e) {\n        console.error(\"Schema migration error (users):\", e);\n    }\n    // New Table: Verification Codes\n    db.exec(`CREATE TABLE IF NOT EXISTS verification_codes (\n       id INTEGER PRIMARY KEY AUTOINCREMENT,\n       email TEXT NOT NULL,\n       code TEXT NOT NULL,\n       expires_at TEXT NOT NULL,\n       created_at TEXT NOT NULL\n     )`);\n    // Optimize: Add indices for performance\n    db.exec(\"CREATE INDEX IF NOT EXISTS idx_conversations_updated_at ON conversations(updated_at DESC)\");\n    db.exec(\"CREATE INDEX IF NOT EXISTS idx_messages_conversation_id ON messages(conversation_id)\");\n    db.exec(\"CREATE INDEX IF NOT EXISTS idx_users_email ON users(email)\");\n    db.exec(\"CREATE INDEX IF NOT EXISTS idx_verification_codes_email ON verification_codes(email)\");\n    // New Table: User Stats (Token Usage)\n    db.exec(`CREATE TABLE IF NOT EXISTS user_stats (\n       user_id INTEGER PRIMARY KEY,\n       total_tokens INTEGER DEFAULT 0,\n       input_tokens INTEGER DEFAULT 0,\n       output_tokens INTEGER DEFAULT 0,\n       last_updated TEXT\n     )`);\n    // New Table: Tool Usage Stats\n    db.exec(`CREATE TABLE IF NOT EXISTS tool_usage (\n       user_id INTEGER,\n       tool_id TEXT,\n       usage_count INTEGER DEFAULT 0,\n       last_used TEXT,\n       PRIMARY KEY (user_id, tool_id)\n     )`);\n    // New Table: Analytics Events (Generic)\n    db.exec(`CREATE TABLE IF NOT EXISTS analytics_events (\n       id INTEGER PRIMARY KEY AUTOINCREMENT,\n       user_id INTEGER,\n       event_type TEXT NOT NULL,\n       category TEXT,\n       event_data TEXT,\n       created_at TEXT NOT NULL\n     )`);\n    db.exec(\"CREATE INDEX IF NOT EXISTS idx_analytics_events_type ON analytics_events(event_type)\");\n    db.exec(\"CREATE INDEX IF NOT EXISTS idx_analytics_events_user ON analytics_events(user_id)\");\n    // Check if conversation_id column exists in messages table\n    try {\n        const columns = db.prepare(\"PRAGMA table_info(messages)\").all();\n        const hasConversationId = columns.some((col)=>col.name === \"conversation_id\");\n        if (!hasConversationId) {\n            db.exec(\"ALTER TABLE messages ADD COLUMN conversation_id TEXT\");\n        }\n    } catch (e) {\n        console.error(\"Schema migration error (messages):\", e);\n    }\n    // Check if updated_at column exists in conversations table\n    try {\n        const columns = db.prepare(\"PRAGMA table_info(conversations)\").all();\n        const hasUpdatedAt = columns.some((col)=>col.name === \"updated_at\");\n        if (!hasUpdatedAt) {\n            // Add column and backfill with created_at value\n            db.exec(\"ALTER TABLE conversations ADD COLUMN updated_at TEXT\");\n            db.exec(\"UPDATE conversations SET updated_at = created_at WHERE updated_at IS NULL\");\n        }\n    } catch (e) {\n        console.error(\"Schema migration error (conversations):\", e);\n    }\n    try {\n        const columns = db.prepare(\"PRAGMA table_info(conversations)\").all();\n        const hasToolId = columns.some((col)=>col.name === \"tool_id\");\n        if (!hasToolId) {\n            db.exec(\"ALTER TABLE conversations ADD COLUMN tool_id TEXT\");\n        }\n    } catch (e) {\n        console.error(\"Schema migration error (conversations tool_id):\", e);\n    }\n    // Check if user_id column exists in conversations table\n    try {\n        const columns = db.prepare(\"PRAGMA table_info(conversations)\").all();\n        const hasUserId = columns.some((col)=>col.name === \"user_id\");\n        if (!hasUserId) {\n            db.exec(\"ALTER TABLE conversations ADD COLUMN user_id INTEGER\");\n        }\n    } catch (e) {\n        console.error(\"Schema migration error (conversations user_id):\", e);\n    }\n    // Check if kind and metadata columns exist in messages table\n    try {\n        const columns = db.prepare(\"PRAGMA table_info(messages)\").all();\n        const hasKind = columns.some((col)=>col.name === \"kind\");\n        const hasMetadata = columns.some((col)=>col.name === \"metadata\");\n        if (!hasKind) {\n            db.exec(\"ALTER TABLE messages ADD COLUMN kind TEXT DEFAULT 'text'\");\n        }\n        if (!hasMetadata) {\n            db.exec(\"ALTER TABLE messages ADD COLUMN metadata TEXT\");\n        }\n    } catch (e) {\n        console.error(\"Schema migration error (messages extra columns):\", e);\n    }\n};\n// Helper to create or update a conversation\nconst createConversation = (id, title, toolId = null, userId = null)=>{\n    const db = getDb();\n    // Check if exists\n    const exists = db.prepare(\"SELECT 1 FROM conversations WHERE id = ?\").get(id);\n    if (!exists) {\n        const now = new Date().toISOString();\n        const stmt = db.prepare(\"INSERT INTO conversations (id, title, created_at, updated_at, tool_id, user_id) VALUES (?, ?, ?, ?, ?, ?)\");\n        stmt.run(id, title, now, now, toolId, userId);\n    }\n};\n// Helper to update conversation title\nconst updateConversationTitle = (id, newTitle)=>{\n    const db = getDb();\n    const stmt = db.prepare(\"UPDATE conversations SET title = ? WHERE id = ?\");\n    stmt.run(newTitle, id);\n};\nconst updateConversationTool = (id, toolId)=>{\n    const db = getDb();\n    const stmt = db.prepare(\"UPDATE conversations SET tool_id = ? WHERE id = ?\");\n    stmt.run(toolId, id);\n};\n// Helper to get all conversations\nconst getConversationsFromDb = (userId = null)=>{\n    const db = getDb();\n    // Sort by updated_at DESC (recently active first)\n    let sql = \"SELECT id, title, created_at, updated_at, tool_id FROM conversations\";\n    const params = [];\n    if (userId) {\n        sql += \" WHERE user_id = ?\";\n        params.push(userId);\n    } else {\n        sql += \" WHERE user_id IS NULL\";\n    }\n    sql += \" ORDER BY updated_at DESC LIMIT 50\";\n    const stmt = db.prepare(sql);\n    return stmt.all(...params);\n};\nconst getConversationById = (id)=>{\n    const db = getDb();\n    return db.prepare(\"SELECT * FROM conversations WHERE id = ?\").get(id);\n};\nconst saveVerificationCode = (email, code)=>{\n    const db = getDb();\n    const expiresAt = new Date(Date.now() + 5 * 60 * 1000).toISOString(); // 5 minutes\n    const createdAt = new Date().toISOString();\n    db.prepare(\"INSERT INTO verification_codes (email, code, expires_at, created_at) VALUES (?, ?, ?, ?)\").run(email, code, expiresAt, createdAt);\n};\nconst verifyCode = (email, code)=>{\n    const db = getDb();\n    const now = new Date().toISOString();\n    // Find valid code\n    const record = db.prepare(\"SELECT * FROM verification_codes WHERE email = ? AND code = ? AND expires_at > ? ORDER BY created_at DESC LIMIT 1\").get(email, code, now);\n    if (record) {\n        // Delete used code (optional, or just rely on expiration)\n        // db.prepare(\"DELETE FROM verification_codes WHERE id = ?\").run(record.id);\n        return true;\n    }\n    return false;\n};\nconst getOrCreateUser = (email, name)=>{\n    const db = getDb();\n    const now = new Date().toISOString();\n    let user = db.prepare(\"SELECT * FROM users WHERE email = ?\").get(email);\n    if (!user) {\n        // Only used for OTP login where we might implicitly create user if we want\n        // But now we prefer explicit registration. \n        // This function is kept for backward compatibility with pure OTP login if we still support it as \"magic link\" style\n        db.prepare(\"INSERT INTO users (email, name, created_at) VALUES (?, ?, ?)\").run(email, name || email.split(\"@\")[0], now);\n        user = db.prepare(\"SELECT * FROM users WHERE email = ?\").get(email);\n    } else if (name && !user.name) {\n        // Backfill name if missing and provided\n        db.prepare(\"UPDATE users SET name = ? WHERE id = ?\").run(name, user.id);\n        user.name = name;\n    }\n    return user;\n};\nconst createUserWithPassword = (email, passwordHash, name)=>{\n    const db = getDb();\n    const now = new Date().toISOString();\n    try {\n        db.prepare(\"INSERT INTO users (email, password_hash, name, created_at) VALUES (?, ?, ?, ?)\").run(email, passwordHash, name, now);\n        return db.prepare(\"SELECT * FROM users WHERE email = ?\").get(email);\n    } catch (err) {\n        if (err.message.includes(\"UNIQUE constraint failed\")) {\n            throw new Error(\"User already exists\");\n        }\n        throw err;\n    }\n};\nconst getUserByEmail = (email)=>{\n    const db = getDb();\n    return db.prepare(\"SELECT * FROM users WHERE email = ?\").get(email);\n};\nconst updateUserPassword = (userId, passwordHash)=>{\n    const db = getDb();\n    db.prepare(\"UPDATE users SET password_hash = ? WHERE id = ?\").run(passwordHash, userId);\n};\nconst updateUserProfile = (userId, updates)=>{\n    const db = getDb();\n    const { name, avatar } = updates;\n    if (name !== undefined) {\n        db.prepare(\"UPDATE users SET name = ? WHERE id = ?\").run(name, userId);\n    }\n    if (avatar !== undefined) {\n        db.prepare(\"UPDATE users SET avatar = ? WHERE id = ?\").run(avatar, userId);\n    }\n    return db.prepare(\"SELECT * FROM users WHERE id = ?\").get(userId);\n};\n// Helper to save a message\nconst saveMessageToDb = (conversationId, role, content, kind = \"text\", metadata = null, userId = null, initialTitle = null, initialToolId = null)=>{\n    const db = getDb();\n    // Ensure conversation exists. If not, create it with a default title or snippet.\n    // In a real app, we might want to generate a title from the first message.\n    const conv = db.prepare(\"SELECT user_id FROM conversations WHERE id = ?\").get(conversationId);\n    if (!conv) {\n        // Use provided title or create a default one\n        let title = initialTitle;\n        if (!title) {\n            title = role === \"user\" ? content.slice(0, 20) + (content.length > 20 ? \"...\" : \"\") : \"New Chat\";\n        }\n        createConversation(conversationId, title, initialToolId, userId);\n    } else if (userId && conv.user_id === null) {\n        // Claim the conversation if it's currently anonymous and we have a user\n        db.prepare(\"UPDATE conversations SET user_id = ? WHERE id = ?\").run(userId, conversationId);\n    }\n    const now = new Date().toISOString();\n    const stmt = db.prepare(\"INSERT INTO messages (conversation_id, role, content, created_at, kind, metadata) VALUES (?, ?, ?, ?, ?, ?)\");\n    stmt.run(conversationId, role, content, now, kind, metadata);\n    // Update conversation updated_at\n    const updateStmt = db.prepare(\"UPDATE conversations SET updated_at = ? WHERE id = ?\");\n    updateStmt.run(now, conversationId);\n};\n// Helper to get recent messages\nconst getMessagesFromDb = (conversationId, limit = 10)=>{\n    const db = getDb();\n    // Get last N messages for specific conversation, then reverse to chronological order\n    const stmt = db.prepare(`SELECT id, role, content, created_at, kind, metadata FROM messages WHERE conversation_id = ? ORDER BY id DESC LIMIT ?`);\n    const rows = stmt.all(conversationId, limit);\n    return rows.reverse();\n};\nconst countUserMessages = (conversationId)=>{\n    const db = getDb();\n    const result = db.prepare(\"SELECT COUNT(*) as count FROM messages WHERE conversation_id = ? AND role = 'user'\").get(conversationId);\n    return result ? result.count : 0;\n};\n// Helper to get user profile (get the latest one)\nconst getUserProfileFromDb = ()=>{\n    const db = getDb();\n    const stmt = db.prepare(\"SELECT * FROM user_profiles ORDER BY id DESC LIMIT 1\");\n    const row = stmt.get();\n    if (!row) return null;\n    let rawTags = {};\n    try {\n        rawTags = JSON.parse(row.tags);\n    } catch (e) {\n        console.error(\"Failed to parse profile tags\", e);\n    }\n    // Runtime Migration: Convert old string tags to new ProfileValue structure\n    const demographics = {};\n    for (const [key, val] of Object.entries(rawTags)){\n        if (typeof val === \"string\") {\n            // Old format: just string value\n            demographics[key] = {\n                value: val,\n                confidence: 50\n            }; // Default low confidence for legacy data\n        } else {\n            // New format: already object\n            demographics[key] = val;\n        }\n    }\n    return {\n        demographics: demographics,\n        personality: row.personality,\n        leadership_level: JSON.parse(row.leadership_level),\n        last_updated: row.last_updated\n    };\n};\n// Helper to delete a conversation and its messages\nconst deleteConversation = (id)=>{\n    const db = getDb();\n    // Delete messages first\n    const deleteMessagesStmt = db.prepare(\"DELETE FROM messages WHERE conversation_id = ?\");\n    deleteMessagesStmt.run(id);\n    // Delete conversation\n    const deleteConvStmt = db.prepare(\"DELETE FROM conversations WHERE id = ?\");\n    deleteConvStmt.run(id);\n};\nconst searchMessages = (query, userId = null)=>{\n    const db = getDb();\n    // Search for messages that match the query OR conversations whose title matches the query\n    // We join conversations to get the title and filter by user_id if needed\n    let sql = `\n    SELECT \n      m.id as message_id,\n      m.conversation_id,\n      m.content,\n      m.created_at,\n      c.title as conversation_title\n    FROM messages m\n    JOIN conversations c ON m.conversation_id = c.id\n    WHERE (m.content LIKE ? OR c.title LIKE ?)\n  `;\n    const params = [\n        `%${query}%`,\n        `%${query}%`\n    ];\n    if (userId) {\n        sql += \" AND c.user_id = ?\";\n        params.push(userId);\n    } else {\n        // If no user_id, we might want to restrict to public/anonymous chats or just show all (depending on requirements)\n        // For now, let's assume if userId is null, we only search anonymous chats to be safe, \n        // or maybe we just don't filter. \n        // Given the requirement \"secure conversation data\", we should probably filter by user ownership.\n        // If userId is NOT provided (e.g. server-side context issue), we should be careful.\n        // But usually this is called with a verified user ID.\n        // Let's assume userId IS NULL means anonymous user, so we only search anonymous chats.\n        sql += \" AND c.user_id IS NULL\";\n    }\n    sql += \" ORDER BY m.created_at DESC LIMIT 50\";\n    const stmt = db.prepare(sql);\n    return stmt.all(...params);\n};\n// Helper to save user profile\nconst saveUserProfileToDb = (profile)=>{\n    const db = getDb();\n    const stmt = db.prepare(\"INSERT INTO user_profiles (tags, personality, leadership_level, last_updated) VALUES (?, ?, ?, ?)\");\n    stmt.run(JSON.stringify(profile.demographics), profile.personality, JSON.stringify(profile.leadership_level), new Date().toISOString());\n};\n// Helper to increment user token usage\nconst incrementUserTokens = (userId, total, input, output)=>{\n    const db = getDb();\n    const now = new Date().toISOString();\n    // Check if stats exist\n    const exists = db.prepare(\"SELECT 1 FROM user_stats WHERE user_id = ?\").get(userId);\n    if (exists) {\n        const stmt = db.prepare(`\n      UPDATE user_stats \n      SET total_tokens = total_tokens + ?, \n          input_tokens = input_tokens + ?, \n          output_tokens = output_tokens + ?, \n          last_updated = ? \n      WHERE user_id = ?\n    `);\n        stmt.run(total, input, output, now, userId);\n    } else {\n        const stmt = db.prepare(`\n      INSERT INTO user_stats (user_id, total_tokens, input_tokens, output_tokens, last_updated) \n      VALUES (?, ?, ?, ?, ?)\n    `);\n        stmt.run(userId, total, input, output, now);\n    }\n};\n// Helper to increment tool usage\nconst incrementToolUsage = (userId, toolId)=>{\n    if (!toolId) return;\n    const db = getDb();\n    const now = new Date().toISOString();\n    // Check if exists\n    const exists = db.prepare(\"SELECT 1 FROM tool_usage WHERE user_id = ? AND tool_id = ?\").get(userId, toolId);\n    if (exists) {\n        const stmt = db.prepare(\"UPDATE tool_usage SET usage_count = usage_count + 1, last_used = ? WHERE user_id = ? AND tool_id = ?\");\n        stmt.run(now, userId, toolId);\n    } else {\n        const stmt = db.prepare(\"INSERT INTO tool_usage (user_id, tool_id, usage_count, last_used) VALUES (?, ?, 1, ?)\");\n        stmt.run(userId, toolId, now);\n    }\n};\nconst getUserStats = (userId)=>{\n    const db = getDb();\n    const stats = db.prepare(\"SELECT * FROM user_stats WHERE user_id = ?\").get(userId);\n    const tools = db.prepare(\"SELECT tool_id, usage_count FROM tool_usage WHERE user_id = ? ORDER BY usage_count DESC\").all(userId);\n    return {\n        tokens: stats || {\n            total_tokens: 0,\n            input_tokens: 0,\n            output_tokens: 0\n        },\n        tool_usage: tools || []\n    };\n};\n// Generic Event Tracking\nconst trackEvent = (userId, eventType, category = \"general\", data = {})=>{\n    const db = getDb();\n    const now = new Date().toISOString();\n    try {\n        const stmt = db.prepare(\"INSERT INTO analytics_events (user_id, event_type, category, event_data, created_at) VALUES (?, ?, ?, ?, ?)\");\n        stmt.run(userId, eventType, category, JSON.stringify(data), now);\n    } catch (error) {\n        console.error(\"Failed to track event:\", error);\n    }\n};\nconst getAnalyticsEvents = (limit = 50, userId = null)=>{\n    const db = getDb();\n    let sql = \"SELECT * FROM analytics_events\";\n    const params = [];\n    if (userId) {\n        sql += \" WHERE user_id = ?\";\n        params.push(userId);\n    }\n    sql += \" ORDER BY created_at DESC LIMIT ?\";\n    params.push(limit);\n    const stmt = db.prepare(sql);\n    return stmt.all(...params);\n};\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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TXhCLEtBQUtIO0lBQ1gsSUFBSXVDLE1BQU07SUFDVixNQUFNQyxTQUFnQixFQUFFO0lBRXhCLElBQUliLFFBQVE7UUFDVlksT0FBTztRQUNQQyxPQUFPQyxJQUFJLENBQUNkO0lBQ2Q7SUFFQVksT0FBTztJQUNQQyxPQUFPQyxJQUFJLENBQUNzQztJQUVaLE1BQU05QyxPQUFPOUIsR0FBR0csT0FBTyxDQUFDaUM7SUFDeEIsT0FBT04sS0FBSzFCLEdBQUcsSUFBSWlDO0FBQ3JCLEVBQUUiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9haS1jb2FjaC1mcm9udGVuZC8uL2xpYi9kYi50cz8xZGYwIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBwYXRoIGZyb20gXCJwYXRoXCI7XG5pbXBvcnQgeyBVc2VyUHJvZmlsZSB9IGZyb20gXCIuL3R5cGVzXCI7XG5cbnR5cGUgRGF0YWJhc2VTdGF0ZW1lbnQgPSB7XG4gIGFsbDogKC4uLmFyZ3M6IHVua25vd25bXSkgPT4gdW5rbm93bltdO1xuICBnZXQ6ICguLi5hcmdzOiB1bmtub3duW10pID0+IHVua25vd247XG4gIHJ1bjogKC4uLmFyZ3M6IHVua25vd25bXSkgPT4gdW5rbm93bjtcbn07XG5cbnR5cGUgRGF0YWJhc2VTeW5jID0ge1xuICBleGVjOiAoc3FsOiBzdHJpbmcpID0+IHZvaWQ7XG4gIHByZXBhcmU6IChzcWw6IHN0cmluZykgPT4gRGF0YWJhc2VTdGF0ZW1lbnQ7XG59O1xuXG5jb25zdCB7IERhdGFiYXNlU3luYyB9ID0gcmVxdWlyZShcIm5vZGU6c3FsaXRlXCIpIGFzIHsgRGF0YWJhc2VTeW5jOiBuZXcgKHBhdGg6IHN0cmluZykgPT4gRGF0YWJhc2VTeW5jIH07XG5cbmNvbnN0IGRiUGF0aCA9IHBhdGguam9pbihwcm9jZXNzLmN3ZCgpLCBcInNxbGl0ZS5kYlwiKTtcblxuLy8gVXNlIGEgZ2xvYmFsIHZhcmlhYmxlIHRvIHN0b3JlIHRoZSBkYXRhYmFzZSBpbnN0YW5jZSBpbiBkZXZlbG9wbWVudFxuLy8gdG8gcHJldmVudCBtdWx0aXBsZSBjb25uZWN0aW9ucyBkdXJpbmcgaG90IHJlbG9hZGluZ1xuY29uc3QgZ2xvYmFsRm9yRGIgPSBnbG9iYWwgYXMgdW5rbm93biBhcyB7IGRiSW5zdGFuY2U6IERhdGFiYXNlU3luYyB8IHVuZGVmaW5lZCB9O1xuXG5leHBvcnQgY29uc3QgZ2V0RGIgPSAoKSA9PiB7XG4gIGlmICghZ2xvYmFsRm9yRGIuZGJJbnN0YW5jZSkge1xuICAgIGdsb2JhbEZvckRiLmRiSW5zdGFuY2UgPSBuZXcgRGF0YWJhc2VTeW5jKGRiUGF0aCk7XG4gICAgaW5pdGlhbGl6ZVNjaGVtYShnbG9iYWxGb3JEYi5kYkluc3RhbmNlKTtcbiAgfSBlbHNlIHtcbiAgICAvLyBFbnN1cmUgc2NoZW1hIGlzIHVwIHRvIGRhdGUgKHNhZmUgZHVlIHRvIElGIE5PVCBFWElTVFMpXG4gICAgaW5pdGlhbGl6ZVNjaGVtYShnbG9iYWxGb3JEYi5kYkluc3RhbmNlKTtcbiAgfVxuICByZXR1cm4gZ2xvYmFsRm9yRGIuZGJJbnN0YW5jZTtcbn07XG5cbmNvbnN0IGluaXRpYWxpemVTY2hlbWEgPSAoZGI6IERhdGFiYXNlU3luYykgPT4ge1xuICBkYi5leGVjKFxuICAgIGBDUkVBVEUgVEFCTEUgSUYgTk9UIEVYSVNUUyBjb252ZXJzYXRpb25zIChcbiAgICAgICBpZCBURVhUIFBSSU1BUlkgS0VZLCBcbiAgICAgICB0aXRsZSBURVhUIE5PVCBOVUxMLCBcbiAgICAgICBjcmVhdGVkX2F0IFRFWFQgTk9UIE5VTEwsXG4gICAgICAgdXBkYXRlZF9hdCBURVhUIE5PVCBOVUxMLFxuICAgICAgIHRvb2xfaWQgVEVYVFxuICAgICApYFxuICApO1xuICBkYi5leGVjKFxuICAgIGBDUkVBVEUgVEFCTEUgSUYgTk9UIEVYSVNUUyBtZXNzYWdlcyAoXG4gICAgICAgaWQgSU5URUdFUiBQUklNQVJZIEtFWSBBVVRPSU5DUkVNRU5ULCBcbiAgICAgICBjb252ZXJzYXRpb25faWQgVEVYVCBOT1QgTlVMTCxcbiAgICAgICByb2xlIFRFWFQgTk9UIE5VTEwsIFxuICAgICAgIGNvbnRlbnQgVEVYVCBOT1QgTlVMTCwgXG4gICAgICAgY3JlYXRlZF9hdCBURVhUIE5PVCBOVUxMXG4gICAgIClgXG4gICk7XG4gIFxuICAvLyBOZXcgVGFibGU6IFVzZXIgUHJvZmlsZXNcbiAgZGIuZXhlYyhcbiAgICBgQ1JFQVRFIFRBQkxFIElGIE5PVCBFWElTVFMgdXNlcl9wcm9maWxlcyAoXG4gICAgICAgaWQgSU5URUdFUiBQUklNQVJZIEtFWSBBVVRPSU5DUkVNRU5ULFxuICAgICAgIHRhZ3MgVEVYVCBOT1QgTlVMTCxcbiAgICAgICBwZXJzb25hbGl0eSBURVhUIE5PVCBOVUxMLFxuICAgICAgIGxlYWRlcnNoaXBfbGV2ZWwgVEVYVCBOT1QgTlVMTCxcbiAgICAgICBsYXN0X3VwZGF0ZWQgVEVYVCBOT1QgTlVMTFxuICAgICApYFxuICApO1xuXG4gIC8vIE5ldyBUYWJsZTogVXNlcnMgKGZvciBBdXRoKVxuICBkYi5leGVjKFxuICAgIGBDUkVBVEUgVEFCTEUgSUYgTk9UIEVYSVNUUyB1c2VycyAoXG4gICAgICAgaWQgSU5URUdFUiBQUklNQVJZIEtFWSBBVVRPSU5DUkVNRU5ULFxuICAgICAgIGVtYWlsIFRFWFQgVU5JUVVFIE5PVCBOVUxMLFxuICAgICAgIG5hbWUgVEVYVCxcbiAgICAgICBhdmF0YXIgVEVYVCxcbiAgICAgICBjcmVhdGVkX2F0IFRFWFQgTk9UIE5VTExcbiAgICAgKWBcbiAgKTtcblxuICAvLyBNaWdyYXRpb24gZm9yIGV4aXN0aW5nIHVzZXJzIHRhYmxlXG4gIHRyeSB7XG4gICAgY29uc3QgY29sdW1ucyA9IGRiLnByZXBhcmUoXCJQUkFHTUEgdGFibGVfaW5mbyh1c2VycylcIikuYWxsKCkgYXMgYW55W107XG4gICAgY29uc3QgaGFzTmFtZSA9IGNvbHVtbnMuc29tZShjb2wgPT4gY29sLm5hbWUgPT09IFwibmFtZVwiKTtcbiAgICBpZiAoIWhhc05hbWUpIHtcbiAgICAgIGRiLmV4ZWMoXCJBTFRFUiBUQUJMRSB1c2VycyBBREQgQ09MVU1OIG5hbWUgVEVYVFwiKTtcbiAgICB9XG4gICAgY29uc3QgaGFzQXZhdGFyID0gY29sdW1ucy5zb21lKGNvbCA9PiBjb2wubmFtZSA9PT0gXCJhdmF0YXJcIik7XG4gICAgaWYgKCFoYXNBdmF0YXIpIHtcbiAgICAgIGRiLmV4ZWMoXCJBTFRFUiBUQUJMRSB1c2VycyBBREQgQ09MVU1OIGF2YXRhciBURVhUXCIpO1xuICAgIH1cbiAgICBjb25zdCBoYXNQYXNzd29yZEhhc2ggPSBjb2x1bW5zLnNvbWUoY29sID0+IGNvbC5uYW1lID09PSBcInBhc3N3b3JkX2hhc2hcIik7XG4gICAgaWYgKCFoYXNQYXNzd29yZEhhc2gpIHtcbiAgICAgIGRiLmV4ZWMoXCJBTFRFUiBUQUJMRSB1c2VycyBBREQgQ09MVU1OIHBhc3N3b3JkX2hhc2ggVEVYVFwiKTtcbiAgICB9XG4gIH0gY2F0Y2ggKGUpIHtcbiAgICBjb25zb2xlLmVycm9yKFwiU2NoZW1hIG1pZ3JhdGlvbiBlcnJvciAodXNlcnMpOlwiLCBlKTtcbiAgfVxuXG4gIC8vIE5ldyBUYWJsZTogVmVyaWZpY2F0aW9uIENvZGVzXG4gIGRiLmV4ZWMoXG4gICAgYENSRUFURSBUQUJMRSBJRiBOT1QgRVhJU1RTIHZlcmlmaWNhdGlvbl9jb2RlcyAoXG4gICAgICAgaWQgSU5URUdFUiBQUklNQVJZIEtFWSBBVVRPSU5DUkVNRU5ULFxuICAgICAgIGVtYWlsIFRFWFQgTk9UIE5VTEwsXG4gICAgICAgY29kZSBURVhUIE5PVCBOVUxMLFxuICAgICAgIGV4cGlyZXNfYXQgVEVYVCBOT1QgTlVMTCxcbiAgICAgICBjcmVhdGVkX2F0IFRFWFQgTk9UIE5VTExcbiAgICAgKWBcbiAgKTtcbiAgXG4gIC8vIE9wdGltaXplOiBBZGQgaW5kaWNlcyBmb3IgcGVyZm9ybWFuY2VcbiAgZGIuZXhlYyhcIkNSRUFURSBJTkRFWCBJRiBOT1QgRVhJU1RTIGlkeF9jb252ZXJzYXRpb25zX3VwZGF0ZWRfYXQgT04gY29udmVyc2F0aW9ucyh1cGRhdGVkX2F0IERFU0MpXCIpO1xuICBkYi5leGVjKFwiQ1JFQVRFIElOREVYIElGIE5PVCBFWElTVFMgaWR4X21lc3NhZ2VzX2NvbnZlcnNhdGlvbl9pZCBPTiBtZXNzYWdlcyhjb252ZXJzYXRpb25faWQpXCIpO1xuICBkYi5leGVjKFwiQ1JFQVRFIElOREVYIElGIE5PVCBFWElTVFMgaWR4X3VzZXJzX2VtYWlsIE9OIHVzZXJzKGVtYWlsKVwiKTtcbiAgZGIuZXhlYyhcIkNSRUFURSBJTkRFWCBJRiBOT1QgRVhJU1RTIGlkeF92ZXJpZmljYXRpb25fY29kZXNfZW1haWwgT04gdmVyaWZpY2F0aW9uX2NvZGVzKGVtYWlsKVwiKTtcblxuICAvLyBOZXcgVGFibGU6IFVzZXIgU3RhdHMgKFRva2VuIFVzYWdlKVxuICBkYi5leGVjKFxuICAgIGBDUkVBVEUgVEFCTEUgSUYgTk9UIEVYSVNUUyB1c2VyX3N0YXRzIChcbiAgICAgICB1c2VyX2lkIElOVEVHRVIgUFJJTUFSWSBLRVksXG4gICAgICAgdG90YWxfdG9rZW5zIElOVEVHRVIgREVGQVVMVCAwLFxuICAgICAgIGlucHV0X3Rva2VucyBJTlRFR0VSIERFRkFVTFQgMCxcbiAgICAgICBvdXRwdXRfdG9rZW5zIElOVEVHRVIgREVGQVVMVCAwLFxuICAgICAgIGxhc3RfdXBkYXRlZCBURVhUXG4gICAgIClgXG4gICk7XG5cbiAgLy8gTmV3IFRhYmxlOiBUb29sIFVzYWdlIFN0YXRzXG4gIGRiLmV4ZWMoXG4gICAgYENSRUFURSBUQUJMRSBJRiBOT1QgRVhJU1RTIHRvb2xfdXNhZ2UgKFxuICAgICAgIHVzZXJfaWQgSU5URUdFUixcbiAgICAgICB0b29sX2lkIFRFWFQsXG4gICAgICAgdXNhZ2VfY291bnQgSU5URUdFUiBERUZBVUxUIDAsXG4gICAgICAgbGFzdF91c2VkIFRFWFQsXG4gICAgICAgUFJJTUFSWSBLRVkgKHVzZXJfaWQsIHRvb2xfaWQpXG4gICAgIClgXG4gICk7XG5cbiAgLy8gTmV3IFRhYmxlOiBBbmFseXRpY3MgRXZlbnRzIChHZW5lcmljKVxuICBkYi5leGVjKFxuICAgIGBDUkVBVEUgVEFCTEUgSUYgTk9UIEVYSVNUUyBhbmFseXRpY3NfZXZlbnRzIChcbiAgICAgICBpZCBJTlRFR0VSIFBSSU1BUlkgS0VZIEFVVE9JTkNSRU1FTlQsXG4gICAgICAgdXNlcl9pZCBJTlRFR0VSLFxuICAgICAgIGV2ZW50X3R5cGUgVEVYVCBOT1QgTlVMTCxcbiAgICAgICBjYXRlZ29yeSBURVhULFxuICAgICAgIGV2ZW50X2RhdGEgVEVYVCxcbiAgICAgICBjcmVhdGVkX2F0IFRFWFQgTk9UIE5VTExcbiAgICAgKWBcbiAgKTtcbiAgXG4gIGRiLmV4ZWMoXCJDUkVBVEUgSU5ERVggSUYgTk9UIEVYSVNUUyBpZHhfYW5hbHl0aWNzX2V2ZW50c190eXBlIE9OIGFuYWx5dGljc19ldmVudHMoZXZlbnRfdHlwZSlcIik7XG4gIGRiLmV4ZWMoXCJDUkVBVEUgSU5ERVggSUYgTk9UIEVYSVNUUyBpZHhfYW5hbHl0aWNzX2V2ZW50c191c2VyIE9OIGFuYWx5dGljc19ldmVudHModXNlcl9pZClcIik7XG5cbiAgLy8gQ2hlY2sgaWYgY29udmVyc2F0aW9uX2lkIGNvbHVtbiBleGlzdHMgaW4gbWVzc2FnZXMgdGFibGVcbiAgdHJ5IHtcbiAgICBjb25zdCBjb2x1bW5zID0gZGIucHJlcGFyZShcIlBSQUdNQSB0YWJsZV9pbmZvKG1lc3NhZ2VzKVwiKS5hbGwoKSBhcyBhbnlbXTtcbiAgICBjb25zdCBoYXNDb252ZXJzYXRpb25JZCA9IGNvbHVtbnMuc29tZShjb2wgPT4gY29sLm5hbWUgPT09IFwiY29udmVyc2F0aW9uX2lkXCIpO1xuICAgIFxuICAgIGlmICghaGFzQ29udmVyc2F0aW9uSWQpIHtcbiAgICAgICBkYi5leGVjKFwiQUxURVIgVEFCTEUgbWVzc2FnZXMgQUREIENPTFVNTiBjb252ZXJzYXRpb25faWQgVEVYVFwiKTtcbiAgICB9XG4gIH0gY2F0Y2ggKGUpIHtcbiAgICBjb25zb2xlLmVycm9yKFwiU2NoZW1hIG1pZ3JhdGlvbiBlcnJvciAobWVzc2FnZXMpOlwiLCBlKTtcbiAgfVxuXG4gIC8vIENoZWNrIGlmIHVwZGF0ZWRfYXQgY29sdW1uIGV4aXN0cyBpbiBjb252ZXJzYXRpb25zIHRhYmxlXG4gIHRyeSB7XG4gICAgY29uc3QgY29sdW1ucyA9IGRiLnByZXBhcmUoXCJQUkFHTUEgdGFibGVfaW5mbyhjb252ZXJzYXRpb25zKVwiKS5hbGwoKSBhcyBhbnlbXTtcbiAgICBjb25zdCBoYXNVcGRhdGVkQXQgPSBjb2x1bW5zLnNvbWUoY29sID0+IGNvbC5uYW1lID09PSBcInVwZGF0ZWRfYXRcIik7XG4gICAgXG4gICAgaWYgKCFoYXNVcGRhdGVkQXQpIHtcbiAgICAgICAvLyBBZGQgY29sdW1uIGFuZCBiYWNrZmlsbCB3aXRoIGNyZWF0ZWRfYXQgdmFsdWVcbiAgICAgICBkYi5leGVjKFwiQUxURVIgVEFCTEUgY29udmVyc2F0aW9ucyBBREQgQ09MVU1OIHVwZGF0ZWRfYXQgVEVYVFwiKTtcbiAgICAgICBkYi5leGVjKFwiVVBEQVRFIGNvbnZlcnNhdGlvbnMgU0VUIHVwZGF0ZWRfYXQgPSBjcmVhdGVkX2F0IFdIRVJFIHVwZGF0ZWRfYXQgSVMgTlVMTFwiKTtcbiAgICB9XG4gIH0gY2F0Y2ggKGUpIHtcbiAgICBjb25zb2xlLmVycm9yKFwiU2NoZW1hIG1pZ3JhdGlvbiBlcnJvciAoY29udmVyc2F0aW9ucyk6XCIsIGUpO1xuICB9XG5cbiAgdHJ5IHtcbiAgICBjb25zdCBjb2x1bW5zID0gZGIucHJlcGFyZShcIlBSQUdNQSB0YWJsZV9pbmZvKGNvbnZlcnNhdGlvbnMpXCIpLmFsbCgpIGFzIGFueVtdO1xuICAgIGNvbnN0IGhhc1Rvb2xJZCA9IGNvbHVtbnMuc29tZShjb2wgPT4gY29sLm5hbWUgPT09IFwidG9vbF9pZFwiKTtcbiAgICBpZiAoIWhhc1Rvb2xJZCkge1xuICAgICAgZGIuZXhlYyhcIkFMVEVSIFRBQkxFIGNvbnZlcnNhdGlvbnMgQUREIENPTFVNTiB0b29sX2lkIFRFWFRcIik7XG4gICAgfVxuICB9IGNhdGNoIChlKSB7XG4gICAgY29uc29sZS5lcnJvcihcIlNjaGVtYSBtaWdyYXRpb24gZXJyb3IgKGNvbnZlcnNhdGlvbnMgdG9vbF9pZCk6XCIsIGUpO1xuICB9XG5cbiAgLy8gQ2hlY2sgaWYgdXNlcl9pZCBjb2x1bW4gZXhpc3RzIGluIGNvbnZlcnNhdGlvbnMgdGFibGVcbiAgdHJ5IHtcbiAgICBjb25zdCBjb2x1bW5zID0gZGIucHJlcGFyZShcIlBSQUdNQSB0YWJsZV9pbmZvKGNvbnZlcnNhdGlvbnMpXCIpLmFsbCgpIGFzIGFueVtdO1xuICAgIGNvbnN0IGhhc1VzZXJJZCA9IGNvbHVtbnMuc29tZShjb2wgPT4gY29sLm5hbWUgPT09IFwidXNlcl9pZFwiKTtcbiAgICBpZiAoIWhhc1VzZXJJZCkge1xuICAgICAgZGIuZXhlYyhcIkFMVEVSIFRBQkxFIGNvbnZlcnNhdGlvbnMgQUREIENPTFVNTiB1c2VyX2lkIElOVEVHRVJcIik7XG4gICAgfVxuICB9IGNhdGNoIChlKSB7XG4gICAgY29uc29sZS5lcnJvcihcIlNjaGVtYSBtaWdyYXRpb24gZXJyb3IgKGNvbnZlcnNhdGlvbnMgdXNlcl9pZCk6XCIsIGUpO1xuICB9XG5cbiAgLy8gQ2hlY2sgaWYga2luZCBhbmQgbWV0YWRhdGEgY29sdW1ucyBleGlzdCBpbiBtZXNzYWdlcyB0YWJsZVxuICB0cnkge1xuICAgIGNvbnN0IGNvbHVtbnMgPSBkYi5wcmVwYXJlKFwiUFJBR01BIHRhYmxlX2luZm8obWVzc2FnZXMpXCIpLmFsbCgpIGFzIGFueVtdO1xuICAgIGNvbnN0IGhhc0tpbmQgPSBjb2x1bW5zLnNvbWUoY29sID0+IGNvbC5uYW1lID09PSBcImtpbmRcIik7XG4gICAgY29uc3QgaGFzTWV0YWRhdGEgPSBjb2x1bW5zLnNvbWUoY29sID0+IGNvbC5uYW1lID09PSBcIm1ldGFkYXRhXCIpO1xuICAgIFxuICAgIGlmICghaGFzS2luZCkge1xuICAgICAgIGRiLmV4ZWMoXCJBTFRFUiBUQUJMRSBtZXNzYWdlcyBBREQgQ09MVU1OIGtpbmQgVEVYVCBERUZBVUxUICd0ZXh0J1wiKTtcbiAgICB9XG4gICAgaWYgKCFoYXNNZXRhZGF0YSkge1xuICAgICAgIGRiLmV4ZWMoXCJBTFRFUiBUQUJMRSBtZXNzYWdlcyBBREQgQ09MVU1OIG1ldGFkYXRhIFRFWFRcIik7XG4gICAgfVxuICB9IGNhdGNoIChlKSB7XG4gICAgY29uc29sZS5lcnJvcihcIlNjaGVtYSBtaWdyYXRpb24gZXJyb3IgKG1lc3NhZ2VzIGV4dHJhIGNvbHVtbnMpOlwiLCBlKTtcbiAgfVxufTtcblxuLy8gSGVscGVyIHRvIGNyZWF0ZSBvciB1cGRhdGUgYSBjb252ZXJzYXRpb25cbmV4cG9ydCBjb25zdCBjcmVhdGVDb252ZXJzYXRpb24gPSAoaWQ6IHN0cmluZywgdGl0bGU6IHN0cmluZywgdG9vbElkOiBzdHJpbmcgfCBudWxsID0gbnVsbCwgdXNlcklkOiBudW1iZXIgfCBudWxsID0gbnVsbCkgPT4ge1xuICBjb25zdCBkYiA9IGdldERiKCk7XG4gIC8vIENoZWNrIGlmIGV4aXN0c1xuICBjb25zdCBleGlzdHMgPSBkYi5wcmVwYXJlKFwiU0VMRUNUIDEgRlJPTSBjb252ZXJzYXRpb25zIFdIRVJFIGlkID0gP1wiKS5nZXQoaWQpO1xuICBpZiAoIWV4aXN0cykge1xuICAgIGNvbnN0IG5vdyA9IG5ldyBEYXRlKCkudG9JU09TdHJpbmcoKTtcbiAgICBjb25zdCBzdG10ID0gZGIucHJlcGFyZShcIklOU0VSVCBJTlRPIGNvbnZlcnNhdGlvbnMgKGlkLCB0aXRsZSwgY3JlYXRlZF9hdCwgdXBkYXRlZF9hdCwgdG9vbF9pZCwgdXNlcl9pZCkgVkFMVUVTICg/LCA/LCA/LCA/LCA/LCA/KVwiKTtcbiAgICBzdG10LnJ1bihpZCwgdGl0bGUsIG5vdywgbm93LCB0b29sSWQsIHVzZXJJZCk7XG4gIH1cbn07XG5cbi8vIEhlbHBlciB0byB1cGRhdGUgY29udmVyc2F0aW9uIHRpdGxlXG5leHBvcnQgY29uc3QgdXBkYXRlQ29udmVyc2F0aW9uVGl0bGUgPSAoaWQ6IHN0cmluZywgbmV3VGl0bGU6IHN0cmluZykgPT4ge1xuICBjb25zdCBkYiA9IGdldERiKCk7XG4gIGNvbnN0IHN0bXQgPSBkYi5wcmVwYXJlKFwiVVBEQVRFIGNvbnZlcnNhdGlvbnMgU0VUIHRpdGxlID0gPyBXSEVSRSBpZCA9ID9cIik7XG4gIHN0bXQucnVuKG5ld1RpdGxlLCBpZCk7XG59O1xuXG5leHBvcnQgY29uc3QgdXBkYXRlQ29udmVyc2F0aW9uVG9vbCA9IChpZDogc3RyaW5nLCB0b29sSWQ6IHN0cmluZyB8IG51bGwpID0+IHtcbiAgY29uc3QgZGIgPSBnZXREYigpO1xuICBjb25zdCBzdG10ID0gZGIucHJlcGFyZShcIlVQREFURSBjb252ZXJzYXRpb25zIFNFVCB0b29sX2lkID0gPyBXSEVSRSBpZCA9ID9cIik7XG4gIHN0bXQucnVuKHRvb2xJZCwgaWQpO1xufTtcblxuLy8gSGVscGVyIHRvIGdldCBhbGwgY29udmVyc2F0aW9uc1xuZXhwb3J0IGNvbnN0IGdldENvbnZlcnNhdGlvbnNGcm9tRGIgPSAodXNlcklkOiBudW1iZXIgfCBudWxsID0gbnVsbCkgPT4ge1xuICBjb25zdCBkYiA9IGdldERiKCk7XG4gIC8vIFNvcnQgYnkgdXBkYXRlZF9hdCBERVNDIChyZWNlbnRseSBhY3RpdmUgZmlyc3QpXG4gIGxldCBzcWwgPSBcIlNFTEVDVCBpZCwgdGl0bGUsIGNyZWF0ZWRfYXQsIHVwZGF0ZWRfYXQsIHRvb2xfaWQgRlJPTSBjb252ZXJzYXRpb25zXCI7XG4gIGNvbnN0IHBhcmFtczogYW55W10gPSBbXTtcblxuICBpZiAodXNlcklkKSB7XG4gICAgc3FsICs9IFwiIFdIRVJFIHVzZXJfaWQgPSA/XCI7XG4gICAgcGFyYW1zLnB1c2godXNlcklkKTtcbiAgfSBlbHNlIHtcbiAgICBzcWwgKz0gXCIgV0hFUkUgdXNlcl9pZCBJUyBOVUxMXCI7XG4gIH1cblxuICBzcWwgKz0gXCIgT1JERVIgQlkgdXBkYXRlZF9hdCBERVNDIExJTUlUIDUwXCI7XG4gIFxuICBjb25zdCBzdG10ID0gZGIucHJlcGFyZShzcWwpO1xuICByZXR1cm4gc3RtdC5hbGwoLi4ucGFyYW1zKSBhcyB7IGlkOiBzdHJpbmc7IHRpdGxlOiBzdHJpbmc7IGNyZWF0ZWRfYXQ6IHN0cmluZzsgdXBkYXRlZF9hdDogc3RyaW5nOyB0b29sX2lkOiBzdHJpbmcgfCBudWxsIH1bXTtcbn07XG5cbmV4cG9ydCBjb25zdCBnZXRDb252ZXJzYXRpb25CeUlkID0gKGlkOiBzdHJpbmcpID0+IHtcbiAgY29uc3QgZGIgPSBnZXREYigpO1xuICByZXR1cm4gZGIucHJlcGFyZShcIlNFTEVDVCAqIEZST00gY29udmVyc2F0aW9ucyBXSEVSRSBpZCA9ID9cIikuZ2V0KGlkKSBhcyB7IGlkOiBzdHJpbmc7IHVzZXJfaWQ6IG51bWJlciB8IG51bGw7IHRpdGxlOiBzdHJpbmcgfSB8IHVuZGVmaW5lZDtcbn07XG5cbmV4cG9ydCBjb25zdCBzYXZlVmVyaWZpY2F0aW9uQ29kZSA9IChlbWFpbDogc3RyaW5nLCBjb2RlOiBzdHJpbmcpID0+IHtcbiAgY29uc3QgZGIgPSBnZXREYigpO1xuICBjb25zdCBleHBpcmVzQXQgPSBuZXcgRGF0ZShEYXRlLm5vdygpICsgNSAqIDYwICogMTAwMCkudG9JU09TdHJpbmcoKTsgLy8gNSBtaW51dGVzXG4gIGNvbnN0IGNyZWF0ZWRBdCA9IG5ldyBEYXRlKCkudG9JU09TdHJpbmcoKTtcbiAgXG4gIGRiLnByZXBhcmUoXG4gICAgXCJJTlNFUlQgSU5UTyB2ZXJpZmljYXRpb25fY29kZXMgKGVtYWlsLCBjb2RlLCBleHBpcmVzX2F0LCBjcmVhdGVkX2F0KSBWQUxVRVMgKD8sID8sID8sID8pXCJcbiAgKS5ydW4oZW1haWwsIGNvZGUsIGV4cGlyZXNBdCwgY3JlYXRlZEF0KTtcbn07XG5cbmV4cG9ydCBjb25zdCB2ZXJpZnlDb2RlID0gKGVtYWlsOiBzdHJpbmcsIGNvZGU6IHN0cmluZyk6IGJvb2xlYW4gPT4ge1xuICBjb25zdCBkYiA9IGdldERiKCk7XG4gIGNvbnN0IG5vdyA9IG5ldyBEYXRlKCkudG9JU09TdHJpbmcoKTtcbiAgXG4gIC8vIEZpbmQgdmFsaWQgY29kZVxuICBjb25zdCByZWNvcmQgPSBkYi5wcmVwYXJlKFxuICAgIFwiU0VMRUNUICogRlJPTSB2ZXJpZmljYXRpb25fY29kZXMgV0hFUkUgZW1haWwgPSA/IEFORCBjb2RlID0gPyBBTkQgZXhwaXJlc19hdCA+ID8gT1JERVIgQlkgY3JlYXRlZF9hdCBERVNDIExJTUlUIDFcIlxuICApLmdldChlbWFpbCwgY29kZSwgbm93KSBhcyBhbnk7XG4gIFxuICBpZiAocmVjb3JkKSB7XG4gICAgLy8gRGVsZXRlIHVzZWQgY29kZSAob3B0aW9uYWwsIG9yIGp1c3QgcmVseSBvbiBleHBpcmF0aW9uKVxuICAgIC8vIGRiLnByZXBhcmUoXCJERUxFVEUgRlJPTSB2ZXJpZmljYXRpb25fY29kZXMgV0hFUkUgaWQgPSA/XCIpLnJ1bihyZWNvcmQuaWQpO1xuICAgIHJldHVybiB0cnVlO1xuICB9XG4gIHJldHVybiBmYWxzZTtcbn07XG5cbmV4cG9ydCBjb25zdCBnZXRPckNyZWF0ZVVzZXIgPSAoZW1haWw6IHN0cmluZywgbmFtZT86IHN0cmluZykgPT4ge1xuICBjb25zdCBkYiA9IGdldERiKCk7XG4gIGNvbnN0IG5vdyA9IG5ldyBEYXRlKCkudG9JU09TdHJpbmcoKTtcbiAgXG4gIGxldCB1c2VyID0gZGIucHJlcGFyZShcIlNFTEVDVCAqIEZST00gdXNlcnMgV0hFUkUgZW1haWwgPSA/XCIpLmdldChlbWFpbCkgYXMgYW55O1xuICBcbiAgaWYgKCF1c2VyKSB7XG4gICAgLy8gT25seSB1c2VkIGZvciBPVFAgbG9naW4gd2hlcmUgd2UgbWlnaHQgaW1wbGljaXRseSBjcmVhdGUgdXNlciBpZiB3ZSB3YW50XG4gICAgLy8gQnV0IG5vdyB3ZSBwcmVmZXIgZXhwbGljaXQgcmVnaXN0cmF0aW9uLiBcbiAgICAvLyBUaGlzIGZ1bmN0aW9uIGlzIGtlcHQgZm9yIGJhY2t3YXJkIGNvbXBhdGliaWxpdHkgd2l0aCBwdXJlIE9UUCBsb2dpbiBpZiB3ZSBzdGlsbCBzdXBwb3J0IGl0IGFzIFwibWFnaWMgbGlua1wiIHN0eWxlXG4gICAgZGIucHJlcGFyZShcIklOU0VSVCBJTlRPIHVzZXJzIChlbWFpbCwgbmFtZSwgY3JlYXRlZF9hdCkgVkFMVUVTICg/LCA/LCA/KVwiKS5ydW4oZW1haWwsIG5hbWUgfHwgZW1haWwuc3BsaXQoJ0AnKVswXSwgbm93KTtcbiAgICB1c2VyID0gZGIucHJlcGFyZShcIlNFTEVDVCAqIEZST00gdXNlcnMgV0hFUkUgZW1haWwgPSA/XCIpLmdldChlbWFpbCk7XG4gIH0gZWxzZSBpZiAobmFtZSAmJiAhdXNlci5uYW1lKSB7XG4gICAgLy8gQmFja2ZpbGwgbmFtZSBpZiBtaXNzaW5nIGFuZCBwcm92aWRlZFxuICAgIGRiLnByZXBhcmUoXCJVUERBVEUgdXNlcnMgU0VUIG5hbWUgPSA/IFdIRVJFIGlkID0gP1wiKS5ydW4obmFtZSwgdXNlci5pZCk7XG4gICAgdXNlci5uYW1lID0gbmFtZTtcbiAgfVxuICBcbiAgcmV0dXJuIHVzZXI7XG59O1xuXG5leHBvcnQgY29uc3QgY3JlYXRlVXNlcldpdGhQYXNzd29yZCA9IChlbWFpbDogc3RyaW5nLCBwYXNzd29yZEhhc2g6IHN0cmluZywgbmFtZTogc3RyaW5nKSA9PiB7XG4gIGNvbnN0IGRiID0gZ2V0RGIoKTtcbiAgY29uc3Qgbm93ID0gbmV3IERhdGUoKS50b0lTT1N0cmluZygpO1xuICBcbiAgdHJ5IHtcbiAgICBkYi5wcmVwYXJlKFwiSU5TRVJUIElOVE8gdXNlcnMgKGVtYWlsLCBwYXNzd29yZF9oYXNoLCBuYW1lLCBjcmVhdGVkX2F0KSBWQUxVRVMgKD8sID8sID8sID8pXCIpLnJ1bihlbWFpbCwgcGFzc3dvcmRIYXNoLCBuYW1lLCBub3cpO1xuICAgIHJldHVybiBkYi5wcmVwYXJlKFwiU0VMRUNUICogRlJPTSB1c2VycyBXSEVSRSBlbWFpbCA9ID9cIikuZ2V0KGVtYWlsKTtcbiAgfSBjYXRjaCAoZXJyOiBhbnkpIHtcbiAgICBpZiAoZXJyLm1lc3NhZ2UuaW5jbHVkZXMoXCJVTklRVUUgY29uc3RyYWludCBmYWlsZWRcIikpIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcihcIlVzZXIgYWxyZWFkeSBleGlzdHNcIik7XG4gICAgfVxuICAgIHRocm93IGVycjtcbiAgfVxufTtcblxuZXhwb3J0IGNvbnN0IGdldFVzZXJCeUVtYWlsID0gKGVtYWlsOiBzdHJpbmcpID0+IHtcbiAgY29uc3QgZGIgPSBnZXREYigpO1xuICByZXR1cm4gZGIucHJlcGFyZShcIlNFTEVDVCAqIEZST00gdXNlcnMgV0hFUkUgZW1haWwgPSA/XCIpLmdldChlbWFpbCk7XG59O1xuXG5leHBvcnQgY29uc3QgdXBkYXRlVXNlclBhc3N3b3JkID0gKHVzZXJJZDogbnVtYmVyLCBwYXNzd29yZEhhc2g6IHN0cmluZykgPT4ge1xuICBjb25zdCBkYiA9IGdldERiKCk7XG4gIGRiLnByZXBhcmUoXCJVUERBVEUgdXNlcnMgU0VUIHBhc3N3b3JkX2hhc2ggPSA/IFdIRVJFIGlkID0gP1wiKS5ydW4ocGFzc3dvcmRIYXNoLCB1c2VySWQpO1xufTtcblxuZXhwb3J0IGNvbnN0IHVwZGF0ZVVzZXJQcm9maWxlID0gKHVzZXJJZDogbnVtYmVyLCB1cGRhdGVzOiB7IG5hbWU/OiBzdHJpbmc7IGF2YXRhcj86IHN0cmluZyB9KSA9PiB7XG4gIGNvbnN0IGRiID0gZ2V0RGIoKTtcbiAgY29uc3QgeyBuYW1lLCBhdmF0YXIgfSA9IHVwZGF0ZXM7XG4gIFxuICBpZiAobmFtZSAhPT0gdW5kZWZpbmVkKSB7XG4gICAgZGIucHJlcGFyZShcIlVQREFURSB1c2VycyBTRVQgbmFtZSA9ID8gV0hFUkUgaWQgPSA/XCIpLnJ1bihuYW1lLCB1c2VySWQpO1xuICB9XG4gIGlmIChhdmF0YXIgIT09IHVuZGVmaW5lZCkge1xuICAgIGRiLnByZXBhcmUoXCJVUERBVEUgdXNlcnMgU0VUIGF2YXRhciA9ID8gV0hFUkUgaWQgPSA/XCIpLnJ1bihhdmF0YXIsIHVzZXJJZCk7XG4gIH1cbiAgXG4gIHJldHVybiBkYi5wcmVwYXJlKFwiU0VMRUNUICogRlJPTSB1c2VycyBXSEVSRSBpZCA9ID9cIikuZ2V0KHVzZXJJZCk7XG59O1xuXG4vLyBIZWxwZXIgdG8gc2F2ZSBhIG1lc3NhZ2VcbmV4cG9ydCBjb25zdCBzYXZlTWVzc2FnZVRvRGIgPSAoXG4gIGNvbnZlcnNhdGlvbklkOiBzdHJpbmcsIFxuICByb2xlOiBcInVzZXJcIiB8IFwiYWlcIiwgXG4gIGNvbnRlbnQ6IHN0cmluZyxcbiAga2luZDogXCJ0ZXh0XCIgfCBcImFuYWx5c2lzXCIgPSBcInRleHRcIixcbiAgbWV0YWRhdGE6IHN0cmluZyB8IG51bGwgPSBudWxsLFxuICB1c2VySWQ6IG51bWJlciB8IG51bGwgPSBudWxsLFxuICBpbml0aWFsVGl0bGU6IHN0cmluZyB8IG51bGwgPSBudWxsLFxuICBpbml0aWFsVG9vbElkOiBzdHJpbmcgfCBudWxsID0gbnVsbFxuKSA9PiB7XG4gIGNvbnN0IGRiID0gZ2V0RGIoKTtcbiAgXG4gIC8vIEVuc3VyZSBjb252ZXJzYXRpb24gZXhpc3RzLiBJZiBub3QsIGNyZWF0ZSBpdCB3aXRoIGEgZGVmYXVsdCB0aXRsZSBvciBzbmlwcGV0LlxuICAvLyBJbiBhIHJlYWwgYXBwLCB3ZSBtaWdodCB3YW50IHRvIGdlbmVyYXRlIGEgdGl0bGUgZnJvbSB0aGUgZmlyc3QgbWVzc2FnZS5cbiAgY29uc3QgY29udiA9IGRiLnByZXBhcmUoXCJTRUxFQ1QgdXNlcl9pZCBGUk9NIGNvbnZlcnNhdGlvbnMgV0hFUkUgaWQgPSA/XCIpLmdldChjb252ZXJzYXRpb25JZCkgYXMgYW55O1xuICBcbiAgaWYgKCFjb252KSB7XG4gICAgICAvLyBVc2UgcHJvdmlkZWQgdGl0bGUgb3IgY3JlYXRlIGEgZGVmYXVsdCBvbmVcbiAgICAgIGxldCB0aXRsZSA9IGluaXRpYWxUaXRsZTtcbiAgICAgIGlmICghdGl0bGUpIHtcbiAgICAgICAgIHRpdGxlID0gcm9sZSA9PT0gJ3VzZXInID8gKGNvbnRlbnQuc2xpY2UoMCwgMjApICsgKGNvbnRlbnQubGVuZ3RoID4gMjAgPyBcIi4uLlwiIDogXCJcIikpIDogXCJOZXcgQ2hhdFwiO1xuICAgICAgfVxuICAgICAgY3JlYXRlQ29udmVyc2F0aW9uKGNvbnZlcnNhdGlvbklkLCB0aXRsZSwgaW5pdGlhbFRvb2xJZCwgdXNlcklkKTtcbiAgfSBlbHNlIGlmICh1c2VySWQgJiYgY29udi51c2VyX2lkID09PSBudWxsKSB7XG4gICAgICAvLyBDbGFpbSB0aGUgY29udmVyc2F0aW9uIGlmIGl0J3MgY3VycmVudGx5IGFub255bW91cyBhbmQgd2UgaGF2ZSBhIHVzZXJcbiAgICAgIGRiLnByZXBhcmUoXCJVUERBVEUgY29udmVyc2F0aW9ucyBTRVQgdXNlcl9pZCA9ID8gV0hFUkUgaWQgPSA/XCIpLnJ1bih1c2VySWQsIGNvbnZlcnNhdGlvbklkKTtcbiAgfVxuXG4gIGNvbnN0IG5vdyA9IG5ldyBEYXRlKCkudG9JU09TdHJpbmcoKTtcbiAgY29uc3Qgc3RtdCA9IGRiLnByZXBhcmUoXCJJTlNFUlQgSU5UTyBtZXNzYWdlcyAoY29udmVyc2F0aW9uX2lkLCByb2xlLCBjb250ZW50LCBjcmVhdGVkX2F0LCBraW5kLCBtZXRhZGF0YSkgVkFMVUVTICg/LCA/LCA/LCA/LCA/LCA/KVwiKTtcbiAgc3RtdC5ydW4oY29udmVyc2F0aW9uSWQsIHJvbGUsIGNvbnRlbnQsIG5vdywga2luZCwgbWV0YWRhdGEpO1xuXG4gIC8vIFVwZGF0ZSBjb252ZXJzYXRpb24gdXBkYXRlZF9hdFxuICBjb25zdCB1cGRhdGVTdG10ID0gZGIucHJlcGFyZShcIlVQREFURSBjb252ZXJzYXRpb25zIFNFVCB1cGRhdGVkX2F0ID0gPyBXSEVSRSBpZCA9ID9cIik7XG4gIHVwZGF0ZVN0bXQucnVuKG5vdywgY29udmVyc2F0aW9uSWQpO1xufTtcblxuLy8gSGVscGVyIHRvIGdldCByZWNlbnQgbWVzc2FnZXNcbmV4cG9ydCBjb25zdCBnZXRNZXNzYWdlc0Zyb21EYiA9IChjb252ZXJzYXRpb25JZDogc3RyaW5nLCBsaW1pdDogbnVtYmVyID0gMTApID0+IHtcbiAgY29uc3QgZGIgPSBnZXREYigpO1xuICAvLyBHZXQgbGFzdCBOIG1lc3NhZ2VzIGZvciBzcGVjaWZpYyBjb252ZXJzYXRpb24sIHRoZW4gcmV2ZXJzZSB0byBjaHJvbm9sb2dpY2FsIG9yZGVyXG4gIGNvbnN0IHN0bXQgPSBkYi5wcmVwYXJlKGBTRUxFQ1QgaWQsIHJvbGUsIGNvbnRlbnQsIGNyZWF0ZWRfYXQsIGtpbmQsIG1ldGFkYXRhIEZST00gbWVzc2FnZXMgV0hFUkUgY29udmVyc2F0aW9uX2lkID0gPyBPUkRFUiBCWSBpZCBERVNDIExJTUlUID9gKTtcbiAgY29uc3Qgcm93cyA9IHN0bXQuYWxsKGNvbnZlcnNhdGlvbklkLCBsaW1pdCk7XG4gIHJldHVybiAocm93cyBhcyB7IGlkOiBudW1iZXI7IHJvbGU6IHN0cmluZzsgY29udGVudDogc3RyaW5nOyBjcmVhdGVkX2F0OiBzdHJpbmc7IGtpbmQ6IHN0cmluZzsgbWV0YWRhdGE6IHN0cmluZyB8IG51bGwgfVtdKS5yZXZlcnNlKCk7XG59O1xuXG5leHBvcnQgY29uc3QgY291bnRVc2VyTWVzc2FnZXMgPSAoY29udmVyc2F0aW9uSWQ6IHN0cmluZykgPT4ge1xuICBjb25zdCBkYiA9IGdldERiKCk7XG4gIGNvbnN0IHJlc3VsdCA9IGRiLnByZXBhcmUoXCJTRUxFQ1QgQ09VTlQoKikgYXMgY291bnQgRlJPTSBtZXNzYWdlcyBXSEVSRSBjb252ZXJzYXRpb25faWQgPSA/IEFORCByb2xlID0gJ3VzZXInXCIpLmdldChjb252ZXJzYXRpb25JZCkgYXMgeyBjb3VudDogbnVtYmVyIH07XG4gIHJldHVybiByZXN1bHQgPyByZXN1bHQuY291bnQgOiAwO1xufTtcblxuLy8gSGVscGVyIHRvIGdldCB1c2VyIHByb2ZpbGUgKGdldCB0aGUgbGF0ZXN0IG9uZSlcbmV4cG9ydCBjb25zdCBnZXRVc2VyUHJvZmlsZUZyb21EYiA9ICgpOiBVc2VyUHJvZmlsZSB8IG51bGwgPT4ge1xuICBjb25zdCBkYiA9IGdldERiKCk7XG4gIGNvbnN0IHN0bXQgPSBkYi5wcmVwYXJlKFwiU0VMRUNUICogRlJPTSB1c2VyX3Byb2ZpbGVzIE9SREVSIEJZIGlkIERFU0MgTElNSVQgMVwiKTtcbiAgY29uc3Qgcm93ID0gc3RtdC5nZXQoKSBhcyBhbnk7XG4gIFxuICBpZiAoIXJvdykgcmV0dXJuIG51bGw7XG4gIFxuICBsZXQgcmF3VGFncyA9IHt9O1xuICB0cnkge1xuICAgIHJhd1RhZ3MgPSBKU09OLnBhcnNlKHJvdy50YWdzKTtcbiAgfSBjYXRjaCAoZSkge1xuICAgIGNvbnNvbGUuZXJyb3IoXCJGYWlsZWQgdG8gcGFyc2UgcHJvZmlsZSB0YWdzXCIsIGUpO1xuICB9XG5cbiAgLy8gUnVudGltZSBNaWdyYXRpb246IENvbnZlcnQgb2xkIHN0cmluZyB0YWdzIHRvIG5ldyBQcm9maWxlVmFsdWUgc3RydWN0dXJlXG4gIGNvbnN0IGRlbW9ncmFwaGljczogUmVjb3JkPHN0cmluZywgYW55PiA9IHt9O1xuICBmb3IgKGNvbnN0IFtrZXksIHZhbF0gb2YgT2JqZWN0LmVudHJpZXMocmF3VGFncykpIHtcbiAgICBpZiAodHlwZW9mIHZhbCA9PT0gJ3N0cmluZycpIHtcbiAgICAgIC8vIE9sZCBmb3JtYXQ6IGp1c3Qgc3RyaW5nIHZhbHVlXG4gICAgICBkZW1vZ3JhcGhpY3Nba2V5XSA9IHsgdmFsdWU6IHZhbCwgY29uZmlkZW5jZTogNTAgfTsgLy8gRGVmYXVsdCBsb3cgY29uZmlkZW5jZSBmb3IgbGVnYWN5IGRhdGFcbiAgICB9IGVsc2Uge1xuICAgICAgLy8gTmV3IGZvcm1hdDogYWxyZWFkeSBvYmplY3RcbiAgICAgIGRlbW9ncmFwaGljc1trZXldID0gdmFsO1xuICAgIH1cbiAgfVxuXG4gIHJldHVybiB7XG4gICAgZGVtb2dyYXBoaWNzOiBkZW1vZ3JhcGhpY3MsXG4gICAgcGVyc29uYWxpdHk6IHJvdy5wZXJzb25hbGl0eSxcbiAgICBsZWFkZXJzaGlwX2xldmVsOiBKU09OLnBhcnNlKHJvdy5sZWFkZXJzaGlwX2xldmVsKSxcbiAgICBsYXN0X3VwZGF0ZWQ6IHJvdy5sYXN0X3VwZGF0ZWRcbiAgfTtcbn07XG5cbi8vIEhlbHBlciB0byBkZWxldGUgYSBjb252ZXJzYXRpb24gYW5kIGl0cyBtZXNzYWdlc1xuZXhwb3J0IGNvbnN0IGRlbGV0ZUNvbnZlcnNhdGlvbiA9IChpZDogc3RyaW5nKSA9PiB7XG4gIGNvbnN0IGRiID0gZ2V0RGIoKTtcbiAgLy8gRGVsZXRlIG1lc3NhZ2VzIGZpcnN0XG4gIGNvbnN0IGRlbGV0ZU1lc3NhZ2VzU3RtdCA9IGRiLnByZXBhcmUoXCJERUxFVEUgRlJPTSBtZXNzYWdlcyBXSEVSRSBjb252ZXJzYXRpb25faWQgPSA/XCIpO1xuICBkZWxldGVNZXNzYWdlc1N0bXQucnVuKGlkKTtcblxuICAvLyBEZWxldGUgY29udmVyc2F0aW9uXG4gIGNvbnN0IGRlbGV0ZUNvbnZTdG10ID0gZGIucHJlcGFyZShcIkRFTEVURSBGUk9NIGNvbnZlcnNhdGlvbnMgV0hFUkUgaWQgPSA/XCIpO1xuICBkZWxldGVDb252U3RtdC5ydW4oaWQpO1xufTtcblxuZXhwb3J0IGNvbnN0IHNlYXJjaE1lc3NhZ2VzID0gKHF1ZXJ5OiBzdHJpbmcsIHVzZXJJZDogbnVtYmVyIHwgbnVsbCA9IG51bGwpID0+IHtcbiAgY29uc3QgZGIgPSBnZXREYigpO1xuICAvLyBTZWFyY2ggZm9yIG1lc3NhZ2VzIHRoYXQgbWF0Y2ggdGhlIHF1ZXJ5IE9SIGNvbnZlcnNhdGlvbnMgd2hvc2UgdGl0bGUgbWF0Y2hlcyB0aGUgcXVlcnlcbiAgLy8gV2Ugam9pbiBjb252ZXJzYXRpb25zIHRvIGdldCB0aGUgdGl0bGUgYW5kIGZpbHRlciBieSB1c2VyX2lkIGlmIG5lZWRlZFxuICBsZXQgc3FsID0gYFxuICAgIFNFTEVDVCBcbiAgICAgIG0uaWQgYXMgbWVzc2FnZV9pZCxcbiAgICAgIG0uY29udmVyc2F0aW9uX2lkLFxuICAgICAgbS5jb250ZW50LFxuICAgICAgbS5jcmVhdGVkX2F0LFxuICAgICAgYy50aXRsZSBhcyBjb252ZXJzYXRpb25fdGl0bGVcbiAgICBGUk9NIG1lc3NhZ2VzIG1cbiAgICBKT0lOIGNvbnZlcnNhdGlvbnMgYyBPTiBtLmNvbnZlcnNhdGlvbl9pZCA9IGMuaWRcbiAgICBXSEVSRSAobS5jb250ZW50IExJS0UgPyBPUiBjLnRpdGxlIExJS0UgPylcbiAgYDtcblxuICBjb25zdCBwYXJhbXM6IGFueVtdID0gW2AlJHtxdWVyeX0lYCwgYCUke3F1ZXJ5fSVgXTtcblxuICBpZiAodXNlcklkKSB7XG4gICAgc3FsICs9IFwiIEFORCBjLnVzZXJfaWQgPSA/XCI7XG4gICAgcGFyYW1zLnB1c2godXNlcklkKTtcbiAgfSBlbHNlIHtcbiAgICAvLyBJZiBubyB1c2VyX2lkLCB3ZSBtaWdodCB3YW50IHRvIHJlc3RyaWN0IHRvIHB1YmxpYy9hbm9ueW1vdXMgY2hhdHMgb3IganVzdCBzaG93IGFsbCAoZGVwZW5kaW5nIG9uIHJlcXVpcmVtZW50cylcbiAgICAvLyBGb3Igbm93LCBsZXQncyBhc3N1bWUgaWYgdXNlcklkIGlzIG51bGwsIHdlIG9ubHkgc2VhcmNoIGFub255bW91cyBjaGF0cyB0byBiZSBzYWZlLCBcbiAgICAvLyBvciBtYXliZSB3ZSBqdXN0IGRvbid0IGZpbHRlci4gXG4gICAgLy8gR2l2ZW4gdGhlIHJlcXVpcmVtZW50IFwic2VjdXJlIGNvbnZlcnNhdGlvbiBkYXRhXCIsIHdlIHNob3VsZCBwcm9iYWJseSBmaWx0ZXIgYnkgdXNlciBvd25lcnNoaXAuXG4gICAgLy8gSWYgdXNlcklkIGlzIE5PVCBwcm92aWRlZCAoZS5nLiBzZXJ2ZXItc2lkZSBjb250ZXh0IGlzc3VlKSwgd2Ugc2hvdWxkIGJlIGNhcmVmdWwuXG4gICAgLy8gQnV0IHVzdWFsbHkgdGhpcyBpcyBjYWxsZWQgd2l0aCBhIHZlcmlmaWVkIHVzZXIgSUQuXG4gICAgLy8gTGV0J3MgYXNzdW1lIHVzZXJJZCBJUyBOVUxMIG1lYW5zIGFub255bW91cyB1c2VyLCBzbyB3ZSBvbmx5IHNlYXJjaCBhbm9ueW1vdXMgY2hhdHMuXG4gICAgc3FsICs9IFwiIEFORCBjLnVzZXJfaWQgSVMgTlVMTFwiO1xuICB9XG5cbiAgc3FsICs9IFwiIE9SREVSIEJZIG0uY3JlYXRlZF9hdCBERVNDIExJTUlUIDUwXCI7XG5cbiAgY29uc3Qgc3RtdCA9IGRiLnByZXBhcmUoc3FsKTtcbiAgcmV0dXJuIHN0bXQuYWxsKC4uLnBhcmFtcykgYXMge1xuICAgIG1lc3NhZ2VfaWQ6IG51bWJlcjtcbiAgICBjb252ZXJzYXRpb25faWQ6IHN0cmluZztcbiAgICBjb250ZW50OiBzdHJpbmc7XG4gICAgY3JlYXRlZF9hdDogc3RyaW5nO1xuICAgIGNvbnZlcnNhdGlvbl90aXRsZTogc3RyaW5nO1xuICB9W107XG59O1xuXG4vLyBIZWxwZXIgdG8gc2F2ZSB1c2VyIHByb2ZpbGVcbmV4cG9ydCBjb25zdCBzYXZlVXNlclByb2ZpbGVUb0RiID0gKHByb2ZpbGU6IFVzZXJQcm9maWxlKSA9PiB7XG4gIGNvbnN0IGRiID0gZ2V0RGIoKTtcbiAgY29uc3Qgc3RtdCA9IGRiLnByZXBhcmUoXG4gICAgXCJJTlNFUlQgSU5UTyB1c2VyX3Byb2ZpbGVzICh0YWdzLCBwZXJzb25hbGl0eSwgbGVhZGVyc2hpcF9sZXZlbCwgbGFzdF91cGRhdGVkKSBWQUxVRVMgKD8sID8sID8sID8pXCJcbiAgKTtcbiAgc3RtdC5ydW4oXG4gICAgSlNPTi5zdHJpbmdpZnkocHJvZmlsZS5kZW1vZ3JhcGhpY3MpLCBcbiAgICBwcm9maWxlLnBlcnNvbmFsaXR5LCBcbiAgICBKU09OLnN0cmluZ2lmeShwcm9maWxlLmxlYWRlcnNoaXBfbGV2ZWwpLCBcbiAgICBuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKClcbiAgKTtcbn07XG5cbi8vIEhlbHBlciB0byBpbmNyZW1lbnQgdXNlciB0b2tlbiB1c2FnZVxuZXhwb3J0IGNvbnN0IGluY3JlbWVudFVzZXJUb2tlbnMgPSAodXNlcklkOiBudW1iZXIsIHRvdGFsOiBudW1iZXIsIGlucHV0OiBudW1iZXIsIG91dHB1dDogbnVtYmVyKSA9PiB7XG4gIGNvbnN0IGRiID0gZ2V0RGIoKTtcbiAgY29uc3Qgbm93ID0gbmV3IERhdGUoKS50b0lTT1N0cmluZygpO1xuICBcbiAgLy8gQ2hlY2sgaWYgc3RhdHMgZXhpc3RcbiAgY29uc3QgZXhpc3RzID0gZGIucHJlcGFyZShcIlNFTEVDVCAxIEZST00gdXNlcl9zdGF0cyBXSEVSRSB1c2VyX2lkID0gP1wiKS5nZXQodXNlcklkKTtcbiAgXG4gIGlmIChleGlzdHMpIHtcbiAgICBjb25zdCBzdG10ID0gZGIucHJlcGFyZShgXG4gICAgICBVUERBVEUgdXNlcl9zdGF0cyBcbiAgICAgIFNFVCB0b3RhbF90b2tlbnMgPSB0b3RhbF90b2tlbnMgKyA/LCBcbiAgICAgICAgICBpbnB1dF90b2tlbnMgPSBpbnB1dF90b2tlbnMgKyA/LCBcbiAgICAgICAgICBvdXRwdXRfdG9rZW5zID0gb3V0cHV0X3Rva2VucyArID8sIFxuICAgICAgICAgIGxhc3RfdXBkYXRlZCA9ID8gXG4gICAgICBXSEVSRSB1c2VyX2lkID0gP1xuICAgIGApO1xuICAgIHN0bXQucnVuKHRvdGFsLCBpbnB1dCwgb3V0cHV0LCBub3csIHVzZXJJZCk7XG4gIH0gZWxzZSB7XG4gICAgY29uc3Qgc3RtdCA9IGRiLnByZXBhcmUoYFxuICAgICAgSU5TRVJUIElOVE8gdXNlcl9zdGF0cyAodXNlcl9pZCwgdG90YWxfdG9rZW5zLCBpbnB1dF90b2tlbnMsIG91dHB1dF90b2tlbnMsIGxhc3RfdXBkYXRlZCkgXG4gICAgICBWQUxVRVMgKD8sID8sID8sID8sID8pXG4gICAgYCk7XG4gICAgc3RtdC5ydW4odXNlcklkLCB0b3RhbCwgaW5wdXQsIG91dHB1dCwgbm93KTtcbiAgfVxufTtcblxuLy8gSGVscGVyIHRvIGluY3JlbWVudCB0b29sIHVzYWdlXG5leHBvcnQgY29uc3QgaW5jcmVtZW50VG9vbFVzYWdlID0gKHVzZXJJZDogbnVtYmVyLCB0b29sSWQ6IHN0cmluZykgPT4ge1xuICBpZiAoIXRvb2xJZCkgcmV0dXJuO1xuICBjb25zdCBkYiA9IGdldERiKCk7XG4gIGNvbnN0IG5vdyA9IG5ldyBEYXRlKCkudG9JU09TdHJpbmcoKTtcbiAgXG4gIC8vIENoZWNrIGlmIGV4aXN0c1xuICBjb25zdCBleGlzdHMgPSBkYi5wcmVwYXJlKFwiU0VMRUNUIDEgRlJPTSB0b29sX3VzYWdlIFdIRVJFIHVzZXJfaWQgPSA/IEFORCB0b29sX2lkID0gP1wiKS5nZXQodXNlcklkLCB0b29sSWQpO1xuICBcbiAgaWYgKGV4aXN0cykge1xuICAgIGNvbnN0IHN0bXQgPSBkYi5wcmVwYXJlKFwiVVBEQVRFIHRvb2xfdXNhZ2UgU0VUIHVzYWdlX2NvdW50ID0gdXNhZ2VfY291bnQgKyAxLCBsYXN0X3VzZWQgPSA/IFdIRVJFIHVzZXJfaWQgPSA/IEFORCB0b29sX2lkID0gP1wiKTtcbiAgICBzdG10LnJ1bihub3csIHVzZXJJZCwgdG9vbElkKTtcbiAgfSBlbHNlIHtcbiAgICBjb25zdCBzdG10ID0gZGIucHJlcGFyZShcIklOU0VSVCBJTlRPIHRvb2xfdXNhZ2UgKHVzZXJfaWQsIHRvb2xfaWQsIHVzYWdlX2NvdW50LCBsYXN0X3VzZWQpIFZBTFVFUyAoPywgPywgMSwgPylcIik7XG4gICAgc3RtdC5ydW4odXNlcklkLCB0b29sSWQsIG5vdyk7XG4gIH1cbn07XG5cbmV4cG9ydCBjb25zdCBnZXRVc2VyU3RhdHMgPSAodXNlcklkOiBudW1iZXIpID0+IHtcbiAgY29uc3QgZGIgPSBnZXREYigpO1xuICBjb25zdCBzdGF0cyA9IGRiLnByZXBhcmUoXCJTRUxFQ1QgKiBGUk9NIHVzZXJfc3RhdHMgV0hFUkUgdXNlcl9pZCA9ID9cIikuZ2V0KHVzZXJJZCkgYXMgYW55O1xuICBjb25zdCB0b29scyA9IGRiLnByZXBhcmUoXCJTRUxFQ1QgdG9vbF9pZCwgdXNhZ2VfY291bnQgRlJPTSB0b29sX3VzYWdlIFdIRVJFIHVzZXJfaWQgPSA/IE9SREVSIEJZIHVzYWdlX2NvdW50IERFU0NcIikuYWxsKHVzZXJJZCkgYXMgYW55W107XG4gIFxuICByZXR1cm4ge1xuICAgIHRva2Vuczogc3RhdHMgfHwgeyB0b3RhbF90b2tlbnM6IDAsIGlucHV0X3Rva2VuczogMCwgb3V0cHV0X3Rva2VuczogMCB9LFxuICAgIHRvb2xfdXNhZ2U6IHRvb2xzIHx8IFtdXG4gIH07XG59O1xuXG4vLyBHZW5lcmljIEV2ZW50IFRyYWNraW5nXG5leHBvcnQgY29uc3QgdHJhY2tFdmVudCA9IChcbiAgdXNlcklkOiBudW1iZXIgfCBudWxsLCBcbiAgZXZlbnRUeXBlOiBzdHJpbmcsIFxuICBjYXRlZ29yeTogc3RyaW5nID0gXCJnZW5lcmFsXCIsIFxuICBkYXRhOiBSZWNvcmQ8c3RyaW5nLCBhbnk+ID0ge31cbikgPT4ge1xuICBjb25zdCBkYiA9IGdldERiKCk7XG4gIGNvbnN0IG5vdyA9IG5ldyBEYXRlKCkudG9JU09TdHJpbmcoKTtcbiAgXG4gIHRyeSB7XG4gICAgY29uc3Qgc3RtdCA9IGRiLnByZXBhcmUoXG4gICAgICBcIklOU0VSVCBJTlRPIGFuYWx5dGljc19ldmVudHMgKHVzZXJfaWQsIGV2ZW50X3R5cGUsIGNhdGVnb3J5LCBldmVudF9kYXRhLCBjcmVhdGVkX2F0KSBWQUxVRVMgKD8sID8sID8sID8sID8pXCJcbiAgICApO1xuICAgIHN0bXQucnVuKHVzZXJJZCwgZXZlbnRUeXBlLCBjYXRlZ29yeSwgSlNPTi5zdHJpbmdpZnkoZGF0YSksIG5vdyk7XG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgY29uc29sZS5lcnJvcihcIkZhaWxlZCB0byB0cmFjayBldmVudDpcIiwgZXJyb3IpO1xuICB9XG59O1xuXG5leHBvcnQgY29uc3QgZ2V0QW5hbHl0aWNzRXZlbnRzID0gKGxpbWl0OiBudW1iZXIgPSA1MCwgdXNlcklkOiBudW1iZXIgfCBudWxsID0gbnVsbCkgPT4ge1xuICBjb25zdCBkYiA9IGdldERiKCk7XG4gIGxldCBzcWwgPSBcIlNFTEVDVCAqIEZST00gYW5hbHl0aWNzX2V2ZW50c1wiO1xuICBjb25zdCBwYXJhbXM6IGFueVtdID0gW107XG5cbiAgaWYgKHVzZXJJZCkge1xuICAgIHNxbCArPSBcIiBXSEVSRSB1c2VyX2lkID0gP1wiO1xuICAgIHBhcmFtcy5wdXNoKHVzZXJJZCk7XG4gIH1cblxuICBzcWwgKz0gXCIgT1JERVIgQlkgY3JlYXRlZF9hdCBERVNDIExJTUlUID9cIjtcbiAgcGFyYW1zLnB1c2gobGltaXQpO1xuXG4gIGNvbnN0IHN0bXQgPSBkYi5wcmVwYXJlKHNxbCk7XG4gIHJldHVybiBzdG10LmFsbCguLi5wYXJhbXMpO1xufTtcbiJdLCJuYW1lcyI6WyJwYXRoIiwiRGF0YWJhc2VTeW5jIiwicmVxdWlyZSIsImRiUGF0aCIsImpvaW4iLCJwcm9jZXNzIiwiY3dkIiwiZ2xvYmFsRm9yRGIiLCJnbG9iYWwiLCJnZXREYiIsImRiSW5zdGFuY2UiLCJpbml0aWFsaXplU2NoZW1hIiwiZGIiLCJleGVjIiwiY29sdW1ucyIsInByZXBhcmUiLCJhbGwiLCJoYXNOYW1lIiwic29tZSIsImNvbCIsIm5hbWUiLCJoYXNBdmF0YXIiLCJoYXNQYXNzd29yZEhhc2giLCJlIiwiY29uc29sZSIsImVycm9yIiwiaGFzQ29udmVyc2F0aW9uSWQiLCJoYXNVcGRhdGVkQXQiLCJoYXNUb29sSWQiLCJoYXNVc2VySWQiLCJoYXNLaW5kIiwiaGFzTWV0YWRhdGEiLCJjcmVhdGVDb252ZXJzYXRpb24iLCJpZCIsInRpdGxlIiwidG9vbElkIiwidXNlcklkIiwiZXhpc3RzIiwiZ2V0Iiwibm93IiwiRGF0ZSIsInRvSVNPU3RyaW5nIiwic3RtdCIsInJ1biIsInVwZGF0ZUNvbnZlcnNhdGlvblRpdGxlIiwibmV3VGl0bGUiLCJ1cGRhdGVDb252ZXJzYXRpb25Ub29sIiwiZ2V0Q29udmVyc2F0aW9uc0Zyb21EYiIsInNxbCIsInBhcmFtcyIsInB1c2giLCJnZXRDb252ZXJzYXRpb25CeUlkIiwic2F2ZVZlcmlmaWNhdGlvbkNvZGUiLCJlbWFpbCIsImNvZGUiLCJleHBpcmVzQXQiLCJjcmVhdGVkQXQiLCJ2ZXJpZnlDb2RlIiwicmVjb3JkIiwiZ2V0T3JDcmVhdGVVc2VyIiwidXNlciIsInNwbGl0IiwiY3JlYXRlVXNlcldpdGhQYXNzd29yZCIsInBhc3N3b3JkSGFzaCIsImVyciIsIm1lc3NhZ2UiLCJpbmNsdWRlcyIsIkVycm9yIiwiZ2V0VXNlckJ5RW1haWwiLCJ1cGRhdGVVc2VyUGFzc3dvcmQiLCJ1cGRhdGVVc2VyUHJvZmlsZSIsInVwZGF0ZXMiLCJhdmF0YXIiLCJ1bmRlZmluZWQiLCJzYXZlTWVzc2FnZVRvRGIiLCJjb252ZXJzYXRpb25JZCIsInJvbGUiLCJjb250ZW50Iiwia2luZCIsIm1ldGFkYXRhIiwiaW5pdGlhbFRpdGxlIiwiaW5pdGlhbFRvb2xJZCIsImNvbnYiLCJzbGljZSIsImxlbmd0aCIsInVzZXJfaWQiLCJ1cGRhdGVTdG10IiwiZ2V0TWVzc2FnZXNGcm9tRGIiLCJsaW1pdCIsInJvd3MiLCJyZXZlcnNlIiwiY291bnRVc2VyTWVzc2FnZXMiLCJyZXN1bHQiLCJjb3VudCIsImdldFVzZXJQcm9maWxlRnJvbURiIiwicm93IiwicmF3VGFncyIsIkpTT04iLCJwYXJzZSIsInRhZ3MiLCJkZW1vZ3JhcGhpY3MiLCJrZXkiLCJ2YWwiLCJPYmplY3QiLCJlbnRyaWVzIiwidmFsdWUiLCJjb25maWRlbmNlIiwicGVyc29uYWxpdHkiLCJsZWFkZXJzaGlwX2xldmVsIiwibGFzdF91cGRhdGVkIiwiZGVsZXRlQ29udmVyc2F0aW9uIiwiZGVsZXRlTWVzc2FnZXNTdG10IiwiZGVsZXRlQ29udlN0bXQiLCJzZWFyY2hNZXNzYWdlcyIsInF1ZXJ5Iiwic2F2ZVVzZXJQcm9maWxlVG9EYiIsInByb2ZpbGUiLCJzdHJpbmdpZnkiLCJpbmNyZW1lbnRVc2VyVG9rZW5zIiwidG90YWwiLCJpbnB1dCIsIm91dHB1dCIsImluY3JlbWVudFRvb2xVc2FnZSIsImdldFVzZXJTdGF0cyIsInN0YXRzIiwidG9vbHMiLCJ0b2tlbnMiLCJ0b3RhbF90b2tlbnMiLCJpbnB1dF90b2tlbnMiLCJvdXRwdXRfdG9rZW5zIiwidG9vbF91c2FnZSIsInRyYWNrRXZlbnQiLCJldmVudFR5cGUiLCJjYXRlZ29yeSIsImRhdGEiLCJnZXRBbmFseXRpY3NFdmVudHMiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./lib/db.ts\n");

/***/ }),

/***/ "(rsc)/./lib/session.ts":
/*!************************!*\
  !*** ./lib/session.ts ***!
  \************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   getCurrentUser: () => (/* binding */ getCurrentUser)\n/* harmony export */ });\n/* harmony import */ var next_headers__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/headers */ \"(rsc)/./node_modules/next/dist/api/headers.js\");\n/* harmony import */ var jsonwebtoken__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! jsonwebtoken */ \"(rsc)/./node_modules/jsonwebtoken/index.js\");\n/* harmony import */ var jsonwebtoken__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(jsonwebtoken__WEBPACK_IMPORTED_MODULE_1__);\n\n\nconst JWT_SECRET = process.env.JWT_SECRET || \"default-secret\";\nfunction getCurrentUser() {\n    const cookieStore = (0,next_headers__WEBPACK_IMPORTED_MODULE_0__.cookies)();\n    const token = cookieStore.get(\"auth_token\");\n    if (!token) return null;\n    try {\n        const decoded = jsonwebtoken__WEBPACK_IMPORTED_MODULE_1___default().verify(token.value, JWT_SECRET);\n        return {\n            id: decoded.userId,\n            email: decoded.email\n        };\n    } catch (error) {\n        return null;\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9saWIvc2Vzc2lvbi50cyIsIm1hcHBpbmdzIjoiOzs7Ozs7O0FBQXVDO0FBQ1I7QUFFL0IsTUFBTUUsYUFBYUMsUUFBUUMsR0FBRyxDQUFDRixVQUFVLElBQUk7QUFFdEMsU0FBU0c7SUFDZCxNQUFNQyxjQUFjTixxREFBT0E7SUFDM0IsTUFBTU8sUUFBUUQsWUFBWUUsR0FBRyxDQUFDO0lBRTlCLElBQUksQ0FBQ0QsT0FBTyxPQUFPO0lBRW5CLElBQUk7UUFDRixNQUFNRSxVQUFVUiwwREFBVSxDQUFDTSxNQUFNSSxLQUFLLEVBQUVUO1FBQ3hDLE9BQU87WUFBRVUsSUFBSUgsUUFBUUksTUFBTTtZQUFFQyxPQUFPTCxRQUFRSyxLQUFLO1FBQUM7SUFDcEQsRUFBRSxPQUFPQyxPQUFPO1FBQ2QsT0FBTztJQUNUO0FBQ0YiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9haS1jb2FjaC1mcm9udGVuZC8uL2xpYi9zZXNzaW9uLnRzPzFkZTEiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgY29va2llcyB9IGZyb20gXCJuZXh0L2hlYWRlcnNcIjtcbmltcG9ydCBqd3QgZnJvbSBcImpzb253ZWJ0b2tlblwiO1xuXG5jb25zdCBKV1RfU0VDUkVUID0gcHJvY2Vzcy5lbnYuSldUX1NFQ1JFVCB8fCBcImRlZmF1bHQtc2VjcmV0XCI7XG5cbmV4cG9ydCBmdW5jdGlvbiBnZXRDdXJyZW50VXNlcigpIHtcbiAgY29uc3QgY29va2llU3RvcmUgPSBjb29raWVzKCk7XG4gIGNvbnN0IHRva2VuID0gY29va2llU3RvcmUuZ2V0KFwiYXV0aF90b2tlblwiKTtcblxuICBpZiAoIXRva2VuKSByZXR1cm4gbnVsbDtcblxuICB0cnkge1xuICAgIGNvbnN0IGRlY29kZWQgPSBqd3QudmVyaWZ5KHRva2VuLnZhbHVlLCBKV1RfU0VDUkVUKSBhcyBhbnk7XG4gICAgcmV0dXJuIHsgaWQ6IGRlY29kZWQudXNlcklkLCBlbWFpbDogZGVjb2RlZC5lbWFpbCB9O1xuICB9IGNhdGNoIChlcnJvcikge1xuICAgIHJldHVybiBudWxsO1xuICB9XG59XG4iXSwibmFtZXMiOlsiY29va2llcyIsImp3dCIsIkpXVF9TRUNSRVQiLCJwcm9jZXNzIiwiZW52IiwiZ2V0Q3VycmVudFVzZXIiLCJjb29raWVTdG9yZSIsInRva2VuIiwiZ2V0IiwiZGVjb2RlZCIsInZlcmlmeSIsInZhbHVlIiwiaWQiLCJ1c2VySWQiLCJlbWFpbCIsImVycm9yIl0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./lib/session.ts\n");

/***/ })

};
;

// load runtime
var __webpack_require__ = require("../../../webpack-runtime.js");
__webpack_require__.C(exports);
var __webpack_exec__ = (moduleId) => (__webpack_require__(__webpack_require__.s = moduleId))
var __webpack_exports__ = __webpack_require__.X(0, ["vendor-chunks/next","vendor-chunks/ms","vendor-chunks/semver","vendor-chunks/jsonwebtoken","vendor-chunks/lodash.includes","vendor-chunks/jws","vendor-chunks/jwa","vendor-chunks/lodash.once","vendor-chunks/lodash.isinteger","vendor-chunks/ecdsa-sig-formatter","vendor-chunks/lodash.isplainobject","vendor-chunks/lodash.isstring","vendor-chunks/lodash.isnumber","vendor-chunks/lodash.isboolean","vendor-chunks/safe-buffer","vendor-chunks/buffer-equal-constant-time"], () => (__webpack_exec__("(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fhistory%2Froute&page=%2Fapi%2Fhistory%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fhistory%2Froute.ts&appDir=G%3A%5CTrea%5CAICoach%5Cfrontend%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=G%3A%5CTrea%5CAICoach%5Cfrontend&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!")));
module.exports = __webpack_exports__;

})();