"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(() => {
var exports = {};
exports.id = "app/api/chat/route";
exports.ids = ["app/api/chat/route"];
exports.modules = {

/***/ "next/dist/compiled/next-server/app-route.runtime.dev.js":
/*!**************************************************************************!*\
  !*** external "next/dist/compiled/next-server/app-route.runtime.dev.js" ***!
  \**************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/app-route.runtime.dev.js");

/***/ }),

/***/ "node:sqlite":
/*!******************************!*\
  !*** external "node:sqlite" ***!
  \******************************/
/***/ ((module) => {

module.exports = require("node:sqlite");

/***/ }),

/***/ "path":
/*!***********************!*\
  !*** external "path" ***!
  \***********************/
/***/ ((module) => {

module.exports = require("path");

/***/ }),

/***/ "(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fchat%2Froute&page=%2Fapi%2Fchat%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fchat%2Froute.ts&appDir=G%3A%5CTrea%5CAICoach%5Cfrontend%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=G%3A%5CTrea%5CAICoach%5Cfrontend&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!":
/*!********************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fchat%2Froute&page=%2Fapi%2Fchat%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fchat%2Froute.ts&appDir=G%3A%5CTrea%5CAICoach%5Cfrontend%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=G%3A%5CTrea%5CAICoach%5Cfrontend&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D! ***!
  \********************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   headerHooks: () => (/* binding */ headerHooks),\n/* harmony export */   originalPathname: () => (/* binding */ originalPathname),\n/* harmony export */   patchFetch: () => (/* binding */ patchFetch),\n/* harmony export */   requestAsyncStorage: () => (/* binding */ requestAsyncStorage),\n/* harmony export */   routeModule: () => (/* binding */ routeModule),\n/* harmony export */   serverHooks: () => (/* binding */ serverHooks),\n/* harmony export */   staticGenerationAsyncStorage: () => (/* binding */ staticGenerationAsyncStorage),\n/* harmony export */   staticGenerationBailout: () => (/* binding */ staticGenerationBailout)\n/* harmony export */ });\n/* harmony import */ var next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/dist/server/future/route-modules/app-route/module.compiled */ \"(rsc)/./node_modules/next/dist/server/future/route-modules/app-route/module.compiled.js\");\n/* harmony import */ var next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! next/dist/server/future/route-kind */ \"(rsc)/./node_modules/next/dist/server/future/route-kind.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! next/dist/server/lib/patch-fetch */ \"(rsc)/./node_modules/next/dist/server/lib/patch-fetch.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var G_Trea_AICoach_frontend_app_api_chat_route_ts__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./app/api/chat/route.ts */ \"(rsc)/./app/api/chat/route.ts\");\n\n\n\n\n// We inject the nextConfigOutput here so that we can use them in the route\n// module.\nconst nextConfigOutput = \"\"\nconst routeModule = new next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__.AppRouteRouteModule({\n    definition: {\n        kind: next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__.RouteKind.APP_ROUTE,\n        page: \"/api/chat/route\",\n        pathname: \"/api/chat\",\n        filename: \"route\",\n        bundlePath: \"app/api/chat/route\"\n    },\n    resolvedPagePath: \"G:\\\\Trea\\\\AICoach\\\\frontend\\\\app\\\\api\\\\chat\\\\route.ts\",\n    nextConfigOutput,\n    userland: G_Trea_AICoach_frontend_app_api_chat_route_ts__WEBPACK_IMPORTED_MODULE_3__\n});\n// Pull out the exports that we need to expose from the module. This should\n// be eliminated when we've moved the other routes to the new format. These\n// are used to hook into the route.\nconst { requestAsyncStorage, staticGenerationAsyncStorage, serverHooks, headerHooks, staticGenerationBailout } = routeModule;\nconst originalPathname = \"/api/chat/route\";\nfunction patchFetch() {\n    return (0,next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__.patchFetch)({\n        serverHooks,\n        staticGenerationAsyncStorage\n    });\n}\n\n\n//# sourceMappingURL=app-route.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvbmV4dC9kaXN0L2J1aWxkL3dlYnBhY2svbG9hZGVycy9uZXh0LWFwcC1sb2FkZXIuanM/bmFtZT1hcHAlMkZhcGklMkZjaGF0JTJGcm91dGUmcGFnZT0lMkZhcGklMkZjaGF0JTJGcm91dGUmYXBwUGF0aHM9JnBhZ2VQYXRoPXByaXZhdGUtbmV4dC1hcHAtZGlyJTJGYXBpJTJGY2hhdCUyRnJvdXRlLnRzJmFwcERpcj1HJTNBJTVDVHJlYSU1Q0FJQ29hY2glNUNmcm9udGVuZCU1Q2FwcCZwYWdlRXh0ZW5zaW9ucz10c3gmcGFnZUV4dGVuc2lvbnM9dHMmcGFnZUV4dGVuc2lvbnM9anN4JnBhZ2VFeHRlbnNpb25zPWpzJnJvb3REaXI9RyUzQSU1Q1RyZWElNUNBSUNvYWNoJTVDZnJvbnRlbmQmaXNEZXY9dHJ1ZSZ0c2NvbmZpZ1BhdGg9dHNjb25maWcuanNvbiZiYXNlUGF0aD0mYXNzZXRQcmVmaXg9Jm5leHRDb25maWdPdXRwdXQ9JnByZWZlcnJlZFJlZ2lvbj0mbWlkZGxld2FyZUNvbmZpZz1lMzAlM0QhIiwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7Ozs7O0FBQXNHO0FBQ3ZDO0FBQ2M7QUFDSztBQUNsRjtBQUNBO0FBQ0E7QUFDQSx3QkFBd0IsZ0hBQW1CO0FBQzNDO0FBQ0EsY0FBYyx5RUFBUztBQUN2QjtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0EsWUFBWTtBQUNaLENBQUM7QUFDRDtBQUNBO0FBQ0E7QUFDQSxRQUFRLHVHQUF1RztBQUMvRztBQUNBO0FBQ0EsV0FBVyw0RUFBVztBQUN0QjtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQzZKOztBQUU3SiIsInNvdXJjZXMiOlsid2VicGFjazovL2FpLWNvYWNoLWZyb250ZW5kLz8wYzU1Il0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IEFwcFJvdXRlUm91dGVNb2R1bGUgfSBmcm9tIFwibmV4dC9kaXN0L3NlcnZlci9mdXR1cmUvcm91dGUtbW9kdWxlcy9hcHAtcm91dGUvbW9kdWxlLmNvbXBpbGVkXCI7XG5pbXBvcnQgeyBSb3V0ZUtpbmQgfSBmcm9tIFwibmV4dC9kaXN0L3NlcnZlci9mdXR1cmUvcm91dGUta2luZFwiO1xuaW1wb3J0IHsgcGF0Y2hGZXRjaCBhcyBfcGF0Y2hGZXRjaCB9IGZyb20gXCJuZXh0L2Rpc3Qvc2VydmVyL2xpYi9wYXRjaC1mZXRjaFwiO1xuaW1wb3J0ICogYXMgdXNlcmxhbmQgZnJvbSBcIkc6XFxcXFRyZWFcXFxcQUlDb2FjaFxcXFxmcm9udGVuZFxcXFxhcHBcXFxcYXBpXFxcXGNoYXRcXFxccm91dGUudHNcIjtcbi8vIFdlIGluamVjdCB0aGUgbmV4dENvbmZpZ091dHB1dCBoZXJlIHNvIHRoYXQgd2UgY2FuIHVzZSB0aGVtIGluIHRoZSByb3V0ZVxuLy8gbW9kdWxlLlxuY29uc3QgbmV4dENvbmZpZ091dHB1dCA9IFwiXCJcbmNvbnN0IHJvdXRlTW9kdWxlID0gbmV3IEFwcFJvdXRlUm91dGVNb2R1bGUoe1xuICAgIGRlZmluaXRpb246IHtcbiAgICAgICAga2luZDogUm91dGVLaW5kLkFQUF9ST1VURSxcbiAgICAgICAgcGFnZTogXCIvYXBpL2NoYXQvcm91dGVcIixcbiAgICAgICAgcGF0aG5hbWU6IFwiL2FwaS9jaGF0XCIsXG4gICAgICAgIGZpbGVuYW1lOiBcInJvdXRlXCIsXG4gICAgICAgIGJ1bmRsZVBhdGg6IFwiYXBwL2FwaS9jaGF0L3JvdXRlXCJcbiAgICB9LFxuICAgIHJlc29sdmVkUGFnZVBhdGg6IFwiRzpcXFxcVHJlYVxcXFxBSUNvYWNoXFxcXGZyb250ZW5kXFxcXGFwcFxcXFxhcGlcXFxcY2hhdFxcXFxyb3V0ZS50c1wiLFxuICAgIG5leHRDb25maWdPdXRwdXQsXG4gICAgdXNlcmxhbmRcbn0pO1xuLy8gUHVsbCBvdXQgdGhlIGV4cG9ydHMgdGhhdCB3ZSBuZWVkIHRvIGV4cG9zZSBmcm9tIHRoZSBtb2R1bGUuIFRoaXMgc2hvdWxkXG4vLyBiZSBlbGltaW5hdGVkIHdoZW4gd2UndmUgbW92ZWQgdGhlIG90aGVyIHJvdXRlcyB0byB0aGUgbmV3IGZvcm1hdC4gVGhlc2Vcbi8vIGFyZSB1c2VkIHRvIGhvb2sgaW50byB0aGUgcm91dGUuXG5jb25zdCB7IHJlcXVlc3RBc3luY1N0b3JhZ2UsIHN0YXRpY0dlbmVyYXRpb25Bc3luY1N0b3JhZ2UsIHNlcnZlckhvb2tzLCBoZWFkZXJIb29rcywgc3RhdGljR2VuZXJhdGlvbkJhaWxvdXQgfSA9IHJvdXRlTW9kdWxlO1xuY29uc3Qgb3JpZ2luYWxQYXRobmFtZSA9IFwiL2FwaS9jaGF0L3JvdXRlXCI7XG5mdW5jdGlvbiBwYXRjaEZldGNoKCkge1xuICAgIHJldHVybiBfcGF0Y2hGZXRjaCh7XG4gICAgICAgIHNlcnZlckhvb2tzLFxuICAgICAgICBzdGF0aWNHZW5lcmF0aW9uQXN5bmNTdG9yYWdlXG4gICAgfSk7XG59XG5leHBvcnQgeyByb3V0ZU1vZHVsZSwgcmVxdWVzdEFzeW5jU3RvcmFnZSwgc3RhdGljR2VuZXJhdGlvbkFzeW5jU3RvcmFnZSwgc2VydmVySG9va3MsIGhlYWRlckhvb2tzLCBzdGF0aWNHZW5lcmF0aW9uQmFpbG91dCwgb3JpZ2luYWxQYXRobmFtZSwgcGF0Y2hGZXRjaCwgIH07XG5cbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWFwcC1yb3V0ZS5qcy5tYXAiXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fchat%2Froute&page=%2Fapi%2Fchat%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fchat%2Froute.ts&appDir=G%3A%5CTrea%5CAICoach%5Cfrontend%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=G%3A%5CTrea%5CAICoach%5Cfrontend&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!\n");

/***/ }),

/***/ "(rsc)/./app/api/chat/route.ts":
/*!*******************************!*\
  !*** ./app/api/chat/route.ts ***!
  \*******************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   POST: () => (/* binding */ POST)\n/* harmony export */ });\n/* harmony import */ var next_dist_server_web_exports_next_response__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/dist/server/web/exports/next-response */ \"(rsc)/./node_modules/next/dist/server/web/exports/next-response.js\");\n/* harmony import */ var _lib_pipeline__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @/lib/pipeline */ \"(rsc)/./lib/pipeline.ts\");\n/* harmony import */ var _lib_db__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @/lib/db */ \"(rsc)/./lib/db.ts\");\n\n\n\nasync function POST(request) {\n    try {\n        const { message, conversationId } = await request.json();\n        if (!message || !conversationId) {\n            return next_dist_server_web_exports_next_response__WEBPACK_IMPORTED_MODULE_0__[\"default\"].json({\n                error: \"Message and conversationId are required\"\n            }, {\n                status: 400\n            });\n        }\n        // 1. Save User Message to DB\n        try {\n            (0,_lib_db__WEBPACK_IMPORTED_MODULE_2__.saveMessageToDb)(conversationId, \"user\", message);\n        } catch (dbError) {\n            console.error(\"DB Save Error (User):\", dbError);\n        // Continue execution even if DB save fails, to provide reply\n        }\n        // 2. Stage 2: Retrieve Memory\n        const memory = (0,_lib_pipeline__WEBPACK_IMPORTED_MODULE_1__.getRecentHistory)(conversationId);\n        // Parallel Execution: Stage 1 (Analysis) & Stage 5 (Profile)\n        // Use Promise.allSettled to ensure one failure doesn't stop the other\n        const [analysisResult, profileResult] = await Promise.allSettled([\n            (0,_lib_pipeline__WEBPACK_IMPORTED_MODULE_1__.stage1_analyze)(message),\n            (0,_lib_pipeline__WEBPACK_IMPORTED_MODULE_1__.stage5Profile)(memory)\n        ]);\n        // Handle Stage 1 Result\n        const analysis = analysisResult.status === \"fulfilled\" ? analysisResult.value : {\n            intent: \"CHAT\",\n            sentiment: \"Unknown\",\n            complexity: \"LOW\",\n            keywords: [\n                \"Error\"\n            ]\n        }; // Fallback analysis\n        if (analysisResult.status === \"rejected\") {\n            console.error(\"Stage 1 Failed:\", analysisResult.reason);\n        }\n        // Handle Stage 5 Result\n        const userProfile = profileResult.status === \"fulfilled\" ? profileResult.value : null;\n        if (profileResult.status === \"rejected\") {\n            console.error(\"Stage 5 Failed:\", profileResult.reason);\n        }\n        // 4. Stage 3: Deep Thinking (Strategy)\n        const strategy = await (0,_lib_pipeline__WEBPACK_IMPORTED_MODULE_1__.stage3Think)(message, analysis, memory);\n        // 5. Stage 4: Expression (Final Reply)\n        const aiReply = strategy ? await (0,_lib_pipeline__WEBPACK_IMPORTED_MODULE_1__.stage4Reply)(strategy) : \"抱歉，我今天状态不佳，无法进行思考。\";\n        // 6. Construct Response\n        try {\n            (0,_lib_db__WEBPACK_IMPORTED_MODULE_2__.saveMessageToDb)(conversationId, \"ai\", aiReply);\n        } catch (dbError) {\n            console.error(\"DB Save Error (AI):\", dbError);\n        }\n        return next_dist_server_web_exports_next_response__WEBPACK_IMPORTED_MODULE_0__[\"default\"].json({\n            reply: aiReply,\n            debug_info: {\n                stage1: analysis,\n                stage2_memory: memory || \"无历史记忆\",\n                stage3_strategy: strategy || \"策略生成失败\",\n                stage5_profile: userProfile || \"画像更新失败或无变化\"\n            }\n        });\n    } catch (error) {\n        console.error(\"API Error:\", error);\n        return next_dist_server_web_exports_next_response__WEBPACK_IMPORTED_MODULE_0__[\"default\"].json({\n            error: \"Internal Server Error\"\n        }, {\n            status: 500\n        });\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9hcHAvYXBpL2NoYXQvcm91dGUudHMiLCJtYXBwaW5ncyI6Ijs7Ozs7OztBQUEyQztBQUNnRTtBQUNoRTtBQUVwQyxlQUFlTyxLQUFLQyxPQUFnQjtJQUN6QyxJQUFJO1FBQ0YsTUFBTSxFQUFFQyxPQUFPLEVBQUVDLGNBQWMsRUFBRSxHQUFHLE1BQU1GLFFBQVFHLElBQUk7UUFFdEQsSUFBSSxDQUFDRixXQUFXLENBQUNDLGdCQUFnQjtZQUMvQixPQUFPVixrRkFBWUEsQ0FBQ1csSUFBSSxDQUN0QjtnQkFBRUMsT0FBTztZQUEwQyxHQUNuRDtnQkFBRUMsUUFBUTtZQUFJO1FBRWxCO1FBRUEsNkJBQTZCO1FBQzdCLElBQUk7WUFDRlAsd0RBQWVBLENBQUNJLGdCQUFnQixRQUFRRDtRQUMxQyxFQUFFLE9BQU9LLFNBQVM7WUFDaEJDLFFBQVFILEtBQUssQ0FBQyx5QkFBeUJFO1FBQ3ZDLDZEQUE2RDtRQUMvRDtRQUVBLDhCQUE4QjtRQUM5QixNQUFNRSxTQUFTZCwrREFBZ0JBLENBQUNRO1FBRWhDLDZEQUE2RDtRQUM3RCxzRUFBc0U7UUFDdEUsTUFBTSxDQUFDTyxnQkFBZ0JDLGNBQWMsR0FBRyxNQUFNQyxRQUFRQyxVQUFVLENBQUM7WUFDL0RuQiw2REFBY0EsQ0FBQ1E7WUFDZkosNERBQWFBLENBQUNXO1NBQ2Y7UUFFRCx3QkFBd0I7UUFDeEIsTUFBTUssV0FBV0osZUFBZUosTUFBTSxLQUFLLGNBQ3ZDSSxlQUFlSyxLQUFLLEdBQ3BCO1lBQ0VDLFFBQVE7WUFDUkMsV0FBVztZQUNYQyxZQUFZO1lBQ1pDLFVBQVU7Z0JBQUM7YUFBUTtRQUNyQixHQUFHLG9CQUFvQjtRQUUzQixJQUFJVCxlQUFlSixNQUFNLEtBQUssWUFBWTtZQUN4Q0UsUUFBUUgsS0FBSyxDQUFDLG1CQUFtQkssZUFBZVUsTUFBTTtRQUN4RDtRQUVBLHdCQUF3QjtRQUN4QixNQUFNQyxjQUFjVixjQUFjTCxNQUFNLEtBQUssY0FDekNLLGNBQWNJLEtBQUssR0FDbkI7UUFFSixJQUFJSixjQUFjTCxNQUFNLEtBQUssWUFBWTtZQUN2Q0UsUUFBUUgsS0FBSyxDQUFDLG1CQUFtQk0sY0FBY1MsTUFBTTtRQUN2RDtRQUVBLHVDQUF1QztRQUN2QyxNQUFNRSxXQUFXLE1BQU0xQiwwREFBV0EsQ0FBQ00sU0FBU1ksVUFBVUw7UUFFdEQsdUNBQXVDO1FBQ3ZDLE1BQU1jLFVBQVVELFdBQ1osTUFBTXpCLDBEQUFXQSxDQUFDeUIsWUFDbEI7UUFFSix3QkFBd0I7UUFDeEIsSUFBSTtZQUNGdkIsd0RBQWVBLENBQUNJLGdCQUFnQixNQUFNb0I7UUFDeEMsRUFBRSxPQUFPaEIsU0FBUztZQUNoQkMsUUFBUUgsS0FBSyxDQUFDLHVCQUF1QkU7UUFDdkM7UUFFQSxPQUFPZCxrRkFBWUEsQ0FBQ1csSUFBSSxDQUFDO1lBQ3ZCb0IsT0FBT0Q7WUFDUEUsWUFBWTtnQkFDVkMsUUFBUVo7Z0JBQ1JhLGVBQWVsQixVQUFVO2dCQUN6Qm1CLGlCQUFpQk4sWUFBWTtnQkFDN0JPLGdCQUFnQlIsZUFBZTtZQUNqQztRQUNGO0lBRUYsRUFBRSxPQUFPaEIsT0FBTztRQUNkRyxRQUFRSCxLQUFLLENBQUMsY0FBY0E7UUFDNUIsT0FBT1osa0ZBQVlBLENBQUNXLElBQUksQ0FDdEI7WUFBRUMsT0FBTztRQUF3QixHQUNqQztZQUFFQyxRQUFRO1FBQUk7SUFFbEI7QUFDRiIsInNvdXJjZXMiOlsid2VicGFjazovL2FpLWNvYWNoLWZyb250ZW5kLy4vYXBwL2FwaS9jaGF0L3JvdXRlLnRzP2RlNDYiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgTmV4dFJlc3BvbnNlIH0gZnJvbSBcIm5leHQvc2VydmVyXCI7XG5pbXBvcnQgeyBzdGFnZTFfYW5hbHl6ZSwgZ2V0UmVjZW50SGlzdG9yeSwgc3RhZ2UzVGhpbmssIHN0YWdlNFJlcGx5LCBzdGFnZTVQcm9maWxlIH0gZnJvbSBcIkAvbGliL3BpcGVsaW5lXCI7XG5pbXBvcnQgeyBzYXZlTWVzc2FnZVRvRGIgfSBmcm9tIFwiQC9saWIvZGJcIjtcblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIFBPU1QocmVxdWVzdDogUmVxdWVzdCkge1xuICB0cnkge1xuICAgIGNvbnN0IHsgbWVzc2FnZSwgY29udmVyc2F0aW9uSWQgfSA9IGF3YWl0IHJlcXVlc3QuanNvbigpO1xuXG4gICAgaWYgKCFtZXNzYWdlIHx8ICFjb252ZXJzYXRpb25JZCkge1xuICAgICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKFxuICAgICAgICB7IGVycm9yOiBcIk1lc3NhZ2UgYW5kIGNvbnZlcnNhdGlvbklkIGFyZSByZXF1aXJlZFwiIH0sXG4gICAgICAgIHsgc3RhdHVzOiA0MDAgfVxuICAgICAgKTtcbiAgICB9XG5cbiAgICAvLyAxLiBTYXZlIFVzZXIgTWVzc2FnZSB0byBEQlxuICAgIHRyeSB7XG4gICAgICBzYXZlTWVzc2FnZVRvRGIoY29udmVyc2F0aW9uSWQsIFwidXNlclwiLCBtZXNzYWdlKTtcbiAgICB9IGNhdGNoIChkYkVycm9yKSB7XG4gICAgICBjb25zb2xlLmVycm9yKFwiREIgU2F2ZSBFcnJvciAoVXNlcik6XCIsIGRiRXJyb3IpO1xuICAgICAgLy8gQ29udGludWUgZXhlY3V0aW9uIGV2ZW4gaWYgREIgc2F2ZSBmYWlscywgdG8gcHJvdmlkZSByZXBseVxuICAgIH1cblxuICAgIC8vIDIuIFN0YWdlIDI6IFJldHJpZXZlIE1lbW9yeVxuICAgIGNvbnN0IG1lbW9yeSA9IGdldFJlY2VudEhpc3RvcnkoY29udmVyc2F0aW9uSWQpO1xuXG4gICAgLy8gUGFyYWxsZWwgRXhlY3V0aW9uOiBTdGFnZSAxIChBbmFseXNpcykgJiBTdGFnZSA1IChQcm9maWxlKVxuICAgIC8vIFVzZSBQcm9taXNlLmFsbFNldHRsZWQgdG8gZW5zdXJlIG9uZSBmYWlsdXJlIGRvZXNuJ3Qgc3RvcCB0aGUgb3RoZXJcbiAgICBjb25zdCBbYW5hbHlzaXNSZXN1bHQsIHByb2ZpbGVSZXN1bHRdID0gYXdhaXQgUHJvbWlzZS5hbGxTZXR0bGVkKFtcbiAgICAgIHN0YWdlMV9hbmFseXplKG1lc3NhZ2UpLFxuICAgICAgc3RhZ2U1UHJvZmlsZShtZW1vcnkpXG4gICAgXSk7XG5cbiAgICAvLyBIYW5kbGUgU3RhZ2UgMSBSZXN1bHRcbiAgICBjb25zdCBhbmFseXNpcyA9IGFuYWx5c2lzUmVzdWx0LnN0YXR1cyA9PT0gXCJmdWxmaWxsZWRcIiBcbiAgICAgID8gYW5hbHlzaXNSZXN1bHQudmFsdWUgXG4gICAgICA6IHsgXG4gICAgICAgICAgaW50ZW50OiBcIkNIQVRcIiwgXG4gICAgICAgICAgc2VudGltZW50OiBcIlVua25vd25cIiwgXG4gICAgICAgICAgY29tcGxleGl0eTogXCJMT1dcIiwgXG4gICAgICAgICAga2V5d29yZHM6IFtcIkVycm9yXCJdIFxuICAgICAgICB9OyAvLyBGYWxsYmFjayBhbmFseXNpc1xuXG4gICAgaWYgKGFuYWx5c2lzUmVzdWx0LnN0YXR1cyA9PT0gXCJyZWplY3RlZFwiKSB7XG4gICAgICBjb25zb2xlLmVycm9yKFwiU3RhZ2UgMSBGYWlsZWQ6XCIsIGFuYWx5c2lzUmVzdWx0LnJlYXNvbik7XG4gICAgfVxuXG4gICAgLy8gSGFuZGxlIFN0YWdlIDUgUmVzdWx0XG4gICAgY29uc3QgdXNlclByb2ZpbGUgPSBwcm9maWxlUmVzdWx0LnN0YXR1cyA9PT0gXCJmdWxmaWxsZWRcIiBcbiAgICAgID8gcHJvZmlsZVJlc3VsdC52YWx1ZSBcbiAgICAgIDogbnVsbDtcblxuICAgIGlmIChwcm9maWxlUmVzdWx0LnN0YXR1cyA9PT0gXCJyZWplY3RlZFwiKSB7XG4gICAgICBjb25zb2xlLmVycm9yKFwiU3RhZ2UgNSBGYWlsZWQ6XCIsIHByb2ZpbGVSZXN1bHQucmVhc29uKTtcbiAgICB9XG5cbiAgICAvLyA0LiBTdGFnZSAzOiBEZWVwIFRoaW5raW5nIChTdHJhdGVneSlcbiAgICBjb25zdCBzdHJhdGVneSA9IGF3YWl0IHN0YWdlM1RoaW5rKG1lc3NhZ2UsIGFuYWx5c2lzLCBtZW1vcnkpO1xuXG4gICAgLy8gNS4gU3RhZ2UgNDogRXhwcmVzc2lvbiAoRmluYWwgUmVwbHkpXG4gICAgY29uc3QgYWlSZXBseSA9IHN0cmF0ZWd5IFxuICAgICAgPyBhd2FpdCBzdGFnZTRSZXBseShzdHJhdGVneSlcbiAgICAgIDogXCLmirHmrYnvvIzmiJHku4rlpKnnirbmgIHkuI3kvbPvvIzml6Dms5Xov5vooYzmgJ3ogIPjgIJcIjtcblxuICAgIC8vIDYuIENvbnN0cnVjdCBSZXNwb25zZVxuICAgIHRyeSB7XG4gICAgICBzYXZlTWVzc2FnZVRvRGIoY29udmVyc2F0aW9uSWQsIFwiYWlcIiwgYWlSZXBseSk7XG4gICAgfSBjYXRjaCAoZGJFcnJvcikge1xuICAgICAgY29uc29sZS5lcnJvcihcIkRCIFNhdmUgRXJyb3IgKEFJKTpcIiwgZGJFcnJvcik7XG4gICAgfVxuXG4gICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKHtcbiAgICAgIHJlcGx5OiBhaVJlcGx5LFxuICAgICAgZGVidWdfaW5mbzoge1xuICAgICAgICBzdGFnZTE6IGFuYWx5c2lzLFxuICAgICAgICBzdGFnZTJfbWVtb3J5OiBtZW1vcnkgfHwgXCLml6Dljoblj7LorrDlv4ZcIixcbiAgICAgICAgc3RhZ2UzX3N0cmF0ZWd5OiBzdHJhdGVneSB8fCBcIuetlueVpeeUn+aIkOWksei0pVwiLFxuICAgICAgICBzdGFnZTVfcHJvZmlsZTogdXNlclByb2ZpbGUgfHwgXCLnlLvlg4/mm7TmlrDlpLHotKXmiJbml6Dlj5jljJZcIlxuICAgICAgfVxuICAgIH0pO1xuXG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgY29uc29sZS5lcnJvcihcIkFQSSBFcnJvcjpcIiwgZXJyb3IpO1xuICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbihcbiAgICAgIHsgZXJyb3I6IFwiSW50ZXJuYWwgU2VydmVyIEVycm9yXCIgfSxcbiAgICAgIHsgc3RhdHVzOiA1MDAgfVxuICAgICk7XG4gIH1cbn1cbiJdLCJuYW1lcyI6WyJOZXh0UmVzcG9uc2UiLCJzdGFnZTFfYW5hbHl6ZSIsImdldFJlY2VudEhpc3RvcnkiLCJzdGFnZTNUaGluayIsInN0YWdlNFJlcGx5Iiwic3RhZ2U1UHJvZmlsZSIsInNhdmVNZXNzYWdlVG9EYiIsIlBPU1QiLCJyZXF1ZXN0IiwibWVzc2FnZSIsImNvbnZlcnNhdGlvbklkIiwianNvbiIsImVycm9yIiwic3RhdHVzIiwiZGJFcnJvciIsImNvbnNvbGUiLCJtZW1vcnkiLCJhbmFseXNpc1Jlc3VsdCIsInByb2ZpbGVSZXN1bHQiLCJQcm9taXNlIiwiYWxsU2V0dGxlZCIsImFuYWx5c2lzIiwidmFsdWUiLCJpbnRlbnQiLCJzZW50aW1lbnQiLCJjb21wbGV4aXR5Iiwia2V5d29yZHMiLCJyZWFzb24iLCJ1c2VyUHJvZmlsZSIsInN0cmF0ZWd5IiwiYWlSZXBseSIsInJlcGx5IiwiZGVidWdfaW5mbyIsInN0YWdlMSIsInN0YWdlMl9tZW1vcnkiLCJzdGFnZTNfc3RyYXRlZ3kiLCJzdGFnZTVfcHJvZmlsZSJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./app/api/chat/route.ts\n");

/***/ }),

/***/ "(rsc)/./lib/db.ts":
/*!*******************!*\
  !*** ./lib/db.ts ***!
  \*******************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   getDb: () => (/* binding */ getDb),\n/* harmony export */   getMessagesFromDb: () => (/* binding */ getMessagesFromDb),\n/* harmony export */   getUserProfileFromDb: () => (/* binding */ getUserProfileFromDb),\n/* harmony export */   saveMessageToDb: () => (/* binding */ saveMessageToDb),\n/* harmony export */   saveUserProfileToDb: () => (/* binding */ saveUserProfileToDb)\n/* harmony export */ });\n/* harmony import */ var path__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! path */ \"path\");\n/* harmony import */ var path__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(path__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var node_sqlite__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! node:sqlite */ \"node:sqlite\");\n/* harmony import */ var node_sqlite__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(node_sqlite__WEBPACK_IMPORTED_MODULE_1__);\n\n\nconst dbPath = path__WEBPACK_IMPORTED_MODULE_0___default().join(process.cwd(), \"sqlite.db\");\n// Use a global variable to store the database instance in development\n// to prevent multiple connections during hot reloading\nconst globalForDb = global;\nconst getDb = ()=>{\n    if (!globalForDb.dbInstance) {\n        globalForDb.dbInstance = new node_sqlite__WEBPACK_IMPORTED_MODULE_1__.DatabaseSync(dbPath);\n        // Initialize tables only once when connection is established\n        initializeSchema(globalForDb.dbInstance);\n    }\n    return globalForDb.dbInstance;\n};\nconst initializeSchema = (db)=>{\n    db.exec(`CREATE TABLE IF NOT EXISTS conversations (\n       id INTEGER PRIMARY KEY, \n       title TEXT NOT NULL, \n       created_at TEXT NOT NULL\n     )`);\n    db.exec(`CREATE TABLE IF NOT EXISTS messages (\n       id INTEGER PRIMARY KEY AUTOINCREMENT, \n       conversation_id TEXT NOT NULL,\n       role TEXT NOT NULL, \n       content TEXT NOT NULL, \n       created_at TEXT NOT NULL\n     )`);\n    // New Table: User Profiles\n    db.exec(`CREATE TABLE IF NOT EXISTS user_profiles (\n       id INTEGER PRIMARY KEY AUTOINCREMENT,\n       tags TEXT NOT NULL,\n       personality TEXT NOT NULL,\n       leadership_level TEXT NOT NULL,\n       last_updated TEXT NOT NULL\n     )`);\n    // Check if conversation_id column exists in messages table\n    try {\n        const columns = db.prepare(\"PRAGMA table_info(messages)\").all();\n        const hasConversationId = columns.some((col)=>col.name === \"conversation_id\");\n        if (!hasConversationId) {\n            db.exec(\"ALTER TABLE messages ADD COLUMN conversation_id TEXT\");\n        }\n    } catch (e) {\n        console.error(\"Schema migration error:\", e);\n    }\n};\n// Helper to save a message\nconst saveMessageToDb = (conversationId, role, content)=>{\n    const db = getDb();\n    const stmt = db.prepare(\"INSERT INTO messages (conversation_id, role, content, created_at) VALUES (?, ?, ?, ?)\");\n    stmt.run(conversationId, role, content, new Date().toISOString());\n};\n// Helper to get recent messages\nconst getMessagesFromDb = (conversationId, limit = 10)=>{\n    const db = getDb();\n    // Get last N messages for specific conversation, then reverse to chronological order\n    const stmt = db.prepare(`SELECT role, content FROM messages WHERE conversation_id = ? ORDER BY id DESC LIMIT ?`);\n    const rows = stmt.all(conversationId, limit);\n    return rows.reverse();\n};\n// Helper to get user profile (get the latest one)\nconst getUserProfileFromDb = ()=>{\n    const db = getDb();\n    const stmt = db.prepare(\"SELECT * FROM user_profiles ORDER BY id DESC LIMIT 1\");\n    const row = stmt.get();\n    if (!row) return null;\n    let rawTags = {};\n    try {\n        rawTags = JSON.parse(row.tags);\n    } catch (e) {\n        console.error(\"Failed to parse profile tags\", e);\n    }\n    // Runtime Migration: Convert old string tags to new ProfileValue structure\n    const demographics = {};\n    for (const [key, val] of Object.entries(rawTags)){\n        if (typeof val === \"string\") {\n            // Old format: just string value\n            demographics[key] = {\n                value: val,\n                confidence: 50\n            }; // Default low confidence for legacy data\n        } else {\n            // New format: already object\n            demographics[key] = val;\n        }\n    }\n    return {\n        demographics: demographics,\n        personality: row.personality,\n        leadership_level: JSON.parse(row.leadership_level),\n        last_updated: row.last_updated\n    };\n};\n// Helper to save user profile\nconst saveUserProfileToDb = (profile)=>{\n    const db = getDb();\n    const stmt = db.prepare(\"INSERT INTO user_profiles (tags, personality, leadership_level, last_updated) VALUES (?, ?, ?, ?)\");\n    stmt.run(JSON.stringify(profile.demographics), profile.personality, JSON.stringify(profile.leadership_level), new Date().toISOString());\n};\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QztBQUNGLEVBQUU7QUFFRiw4QkFBOEI7QUFDdkIsTUFBTUMsc0JBQXNCLENBQUNDO0lBQ2xDLE1BQU0xQyxLQUFLSDtJQUNYLE1BQU1tQixPQUFPaEIsR0FBR0csT0FBTyxDQUNyQjtJQUVGYSxLQUFLQyxHQUFHLENBQ05XLEtBQUtlLFNBQVMsQ0FBQ0QsUUFBUVgsWUFBWSxHQUNuQ1csUUFBUUosV0FBVyxFQUNuQlYsS0FBS2UsU0FBUyxDQUFDRCxRQUFRSCxnQkFBZ0IsR0FDdkMsSUFBSXJCLE9BQU9DLFdBQVc7QUFFMUIsRUFBRSIsInNvdXJjZXMiOlsid2VicGFjazovL2FpLWNvYWNoLWZyb250ZW5kLy4vbGliL2RiLnRzPzFkZjAiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHBhdGggZnJvbSBcInBhdGhcIjtcbmltcG9ydCB7IERhdGFiYXNlU3luYyB9IGZyb20gXCJub2RlOnNxbGl0ZVwiO1xuaW1wb3J0IHsgVXNlclByb2ZpbGUgfSBmcm9tIFwiLi90eXBlc1wiO1xuXG5jb25zdCBkYlBhdGggPSBwYXRoLmpvaW4ocHJvY2Vzcy5jd2QoKSwgXCJzcWxpdGUuZGJcIik7XG5cbi8vIFVzZSBhIGdsb2JhbCB2YXJpYWJsZSB0byBzdG9yZSB0aGUgZGF0YWJhc2UgaW5zdGFuY2UgaW4gZGV2ZWxvcG1lbnRcbi8vIHRvIHByZXZlbnQgbXVsdGlwbGUgY29ubmVjdGlvbnMgZHVyaW5nIGhvdCByZWxvYWRpbmdcbmNvbnN0IGdsb2JhbEZvckRiID0gZ2xvYmFsIGFzIHVua25vd24gYXMgeyBkYkluc3RhbmNlOiBEYXRhYmFzZVN5bmMgfCB1bmRlZmluZWQgfTtcblxuZXhwb3J0IGNvbnN0IGdldERiID0gKCkgPT4ge1xuICBpZiAoIWdsb2JhbEZvckRiLmRiSW5zdGFuY2UpIHtcbiAgICBnbG9iYWxGb3JEYi5kYkluc3RhbmNlID0gbmV3IERhdGFiYXNlU3luYyhkYlBhdGgpO1xuICAgIFxuICAgIC8vIEluaXRpYWxpemUgdGFibGVzIG9ubHkgb25jZSB3aGVuIGNvbm5lY3Rpb24gaXMgZXN0YWJsaXNoZWRcbiAgICBpbml0aWFsaXplU2NoZW1hKGdsb2JhbEZvckRiLmRiSW5zdGFuY2UpO1xuICB9XG4gIHJldHVybiBnbG9iYWxGb3JEYi5kYkluc3RhbmNlO1xufTtcblxuY29uc3QgaW5pdGlhbGl6ZVNjaGVtYSA9IChkYjogRGF0YWJhc2VTeW5jKSA9PiB7XG4gIGRiLmV4ZWMoXG4gICAgYENSRUFURSBUQUJMRSBJRiBOT1QgRVhJU1RTIGNvbnZlcnNhdGlvbnMgKFxuICAgICAgIGlkIElOVEVHRVIgUFJJTUFSWSBLRVksIFxuICAgICAgIHRpdGxlIFRFWFQgTk9UIE5VTEwsIFxuICAgICAgIGNyZWF0ZWRfYXQgVEVYVCBOT1QgTlVMTFxuICAgICApYFxuICApO1xuICBkYi5leGVjKFxuICAgIGBDUkVBVEUgVEFCTEUgSUYgTk9UIEVYSVNUUyBtZXNzYWdlcyAoXG4gICAgICAgaWQgSU5URUdFUiBQUklNQVJZIEtFWSBBVVRPSU5DUkVNRU5ULCBcbiAgICAgICBjb252ZXJzYXRpb25faWQgVEVYVCBOT1QgTlVMTCxcbiAgICAgICByb2xlIFRFWFQgTk9UIE5VTEwsIFxuICAgICAgIGNvbnRlbnQgVEVYVCBOT1QgTlVMTCwgXG4gICAgICAgY3JlYXRlZF9hdCBURVhUIE5PVCBOVUxMXG4gICAgIClgXG4gICk7XG4gIFxuICAvLyBOZXcgVGFibGU6IFVzZXIgUHJvZmlsZXNcbiAgZGIuZXhlYyhcbiAgICBgQ1JFQVRFIFRBQkxFIElGIE5PVCBFWElTVFMgdXNlcl9wcm9maWxlcyAoXG4gICAgICAgaWQgSU5URUdFUiBQUklNQVJZIEtFWSBBVVRPSU5DUkVNRU5ULFxuICAgICAgIHRhZ3MgVEVYVCBOT1QgTlVMTCxcbiAgICAgICBwZXJzb25hbGl0eSBURVhUIE5PVCBOVUxMLFxuICAgICAgIGxlYWRlcnNoaXBfbGV2ZWwgVEVYVCBOT1QgTlVMTCxcbiAgICAgICBsYXN0X3VwZGF0ZWQgVEVYVCBOT1QgTlVMTFxuICAgICApYFxuICApO1xuICBcbiAgLy8gQ2hlY2sgaWYgY29udmVyc2F0aW9uX2lkIGNvbHVtbiBleGlzdHMgaW4gbWVzc2FnZXMgdGFibGVcbiAgdHJ5IHtcbiAgICBjb25zdCBjb2x1bW5zID0gZGIucHJlcGFyZShcIlBSQUdNQSB0YWJsZV9pbmZvKG1lc3NhZ2VzKVwiKS5hbGwoKSBhcyBhbnlbXTtcbiAgICBjb25zdCBoYXNDb252ZXJzYXRpb25JZCA9IGNvbHVtbnMuc29tZShjb2wgPT4gY29sLm5hbWUgPT09IFwiY29udmVyc2F0aW9uX2lkXCIpO1xuICAgIFxuICAgIGlmICghaGFzQ29udmVyc2F0aW9uSWQpIHtcbiAgICAgICBkYi5leGVjKFwiQUxURVIgVEFCTEUgbWVzc2FnZXMgQUREIENPTFVNTiBjb252ZXJzYXRpb25faWQgVEVYVFwiKTtcbiAgICB9XG4gIH0gY2F0Y2ggKGUpIHtcbiAgICBjb25zb2xlLmVycm9yKFwiU2NoZW1hIG1pZ3JhdGlvbiBlcnJvcjpcIiwgZSk7XG4gIH1cbn07XG5cbi8vIEhlbHBlciB0byBzYXZlIGEgbWVzc2FnZVxuZXhwb3J0IGNvbnN0IHNhdmVNZXNzYWdlVG9EYiA9IChjb252ZXJzYXRpb25JZDogc3RyaW5nLCByb2xlOiBcInVzZXJcIiB8IFwiYWlcIiwgY29udGVudDogc3RyaW5nKSA9PiB7XG4gIGNvbnN0IGRiID0gZ2V0RGIoKTtcbiAgY29uc3Qgc3RtdCA9IGRiLnByZXBhcmUoXCJJTlNFUlQgSU5UTyBtZXNzYWdlcyAoY29udmVyc2F0aW9uX2lkLCByb2xlLCBjb250ZW50LCBjcmVhdGVkX2F0KSBWQUxVRVMgKD8sID8sID8sID8pXCIpO1xuICBzdG10LnJ1bihjb252ZXJzYXRpb25JZCwgcm9sZSwgY29udGVudCwgbmV3IERhdGUoKS50b0lTT1N0cmluZygpKTtcbn07XG5cbi8vIEhlbHBlciB0byBnZXQgcmVjZW50IG1lc3NhZ2VzXG5leHBvcnQgY29uc3QgZ2V0TWVzc2FnZXNGcm9tRGIgPSAoY29udmVyc2F0aW9uSWQ6IHN0cmluZywgbGltaXQ6IG51bWJlciA9IDEwKSA9PiB7XG4gIGNvbnN0IGRiID0gZ2V0RGIoKTtcbiAgLy8gR2V0IGxhc3QgTiBtZXNzYWdlcyBmb3Igc3BlY2lmaWMgY29udmVyc2F0aW9uLCB0aGVuIHJldmVyc2UgdG8gY2hyb25vbG9naWNhbCBvcmRlclxuICBjb25zdCBzdG10ID0gZGIucHJlcGFyZShgU0VMRUNUIHJvbGUsIGNvbnRlbnQgRlJPTSBtZXNzYWdlcyBXSEVSRSBjb252ZXJzYXRpb25faWQgPSA/IE9SREVSIEJZIGlkIERFU0MgTElNSVQgP2ApO1xuICBjb25zdCByb3dzID0gc3RtdC5hbGwoY29udmVyc2F0aW9uSWQsIGxpbWl0KTtcbiAgcmV0dXJuIChyb3dzIGFzIHsgcm9sZTogc3RyaW5nOyBjb250ZW50OiBzdHJpbmcgfVtdKS5yZXZlcnNlKCk7XG59O1xuXG4vLyBIZWxwZXIgdG8gZ2V0IHVzZXIgcHJvZmlsZSAoZ2V0IHRoZSBsYXRlc3Qgb25lKVxuZXhwb3J0IGNvbnN0IGdldFVzZXJQcm9maWxlRnJvbURiID0gKCk6IFVzZXJQcm9maWxlIHwgbnVsbCA9PiB7XG4gIGNvbnN0IGRiID0gZ2V0RGIoKTtcbiAgY29uc3Qgc3RtdCA9IGRiLnByZXBhcmUoXCJTRUxFQ1QgKiBGUk9NIHVzZXJfcHJvZmlsZXMgT1JERVIgQlkgaWQgREVTQyBMSU1JVCAxXCIpO1xuICBjb25zdCByb3cgPSBzdG10LmdldCgpIGFzIGFueTtcbiAgXG4gIGlmICghcm93KSByZXR1cm4gbnVsbDtcbiAgXG4gIGxldCByYXdUYWdzID0ge307XG4gIHRyeSB7XG4gICAgcmF3VGFncyA9IEpTT04ucGFyc2Uocm93LnRhZ3MpO1xuICB9IGNhdGNoIChlKSB7XG4gICAgY29uc29sZS5lcnJvcihcIkZhaWxlZCB0byBwYXJzZSBwcm9maWxlIHRhZ3NcIiwgZSk7XG4gIH1cblxuICAvLyBSdW50aW1lIE1pZ3JhdGlvbjogQ29udmVydCBvbGQgc3RyaW5nIHRhZ3MgdG8gbmV3IFByb2ZpbGVWYWx1ZSBzdHJ1Y3R1cmVcbiAgY29uc3QgZGVtb2dyYXBoaWNzOiBSZWNvcmQ8c3RyaW5nLCBhbnk+ID0ge307XG4gIGZvciAoY29uc3QgW2tleSwgdmFsXSBvZiBPYmplY3QuZW50cmllcyhyYXdUYWdzKSkge1xuICAgIGlmICh0eXBlb2YgdmFsID09PSAnc3RyaW5nJykge1xuICAgICAgLy8gT2xkIGZvcm1hdDoganVzdCBzdHJpbmcgdmFsdWVcbiAgICAgIGRlbW9ncmFwaGljc1trZXldID0geyB2YWx1ZTogdmFsLCBjb25maWRlbmNlOiA1MCB9OyAvLyBEZWZhdWx0IGxvdyBjb25maWRlbmNlIGZvciBsZWdhY3kgZGF0YVxuICAgIH0gZWxzZSB7XG4gICAgICAvLyBOZXcgZm9ybWF0OiBhbHJlYWR5IG9iamVjdFxuICAgICAgZGVtb2dyYXBoaWNzW2tleV0gPSB2YWw7XG4gICAgfVxuICB9XG5cbiAgcmV0dXJuIHtcbiAgICBkZW1vZ3JhcGhpY3M6IGRlbW9ncmFwaGljcyxcbiAgICBwZXJzb25hbGl0eTogcm93LnBlcnNvbmFsaXR5LFxuICAgIGxlYWRlcnNoaXBfbGV2ZWw6IEpTT04ucGFyc2Uocm93LmxlYWRlcnNoaXBfbGV2ZWwpLFxuICAgIGxhc3RfdXBkYXRlZDogcm93Lmxhc3RfdXBkYXRlZFxuICB9O1xufTtcblxuLy8gSGVscGVyIHRvIHNhdmUgdXNlciBwcm9maWxlXG5leHBvcnQgY29uc3Qgc2F2ZVVzZXJQcm9maWxlVG9EYiA9IChwcm9maWxlOiBVc2VyUHJvZmlsZSkgPT4ge1xuICBjb25zdCBkYiA9IGdldERiKCk7XG4gIGNvbnN0IHN0bXQgPSBkYi5wcmVwYXJlKFxuICAgIFwiSU5TRVJUIElOVE8gdXNlcl9wcm9maWxlcyAodGFncywgcGVyc29uYWxpdHksIGxlYWRlcnNoaXBfbGV2ZWwsIGxhc3RfdXBkYXRlZCkgVkFMVUVTICg/LCA/LCA/LCA/KVwiXG4gICk7XG4gIHN0bXQucnVuKFxuICAgIEpTT04uc3RyaW5naWZ5KHByb2ZpbGUuZGVtb2dyYXBoaWNzKSwgXG4gICAgcHJvZmlsZS5wZXJzb25hbGl0eSwgXG4gICAgSlNPTi5zdHJpbmdpZnkocHJvZmlsZS5sZWFkZXJzaGlwX2xldmVsKSwgXG4gICAgbmV3IERhdGUoKS50b0lTT1N0cmluZygpXG4gICk7XG59O1xuIl0sIm5hbWVzIjpbInBhdGgiLCJEYXRhYmFzZVN5bmMiLCJkYlBhdGgiLCJqb2luIiwicHJvY2VzcyIsImN3ZCIsImdsb2JhbEZvckRiIiwiZ2xvYmFsIiwiZ2V0RGIiLCJkYkluc3RhbmNlIiwiaW5pdGlhbGl6ZVNjaGVtYSIsImRiIiwiZXhlYyIsImNvbHVtbnMiLCJwcmVwYXJlIiwiYWxsIiwiaGFzQ29udmVyc2F0aW9uSWQiLCJzb21lIiwiY29sIiwibmFtZSIsImUiLCJjb25zb2xlIiwiZXJyb3IiLCJzYXZlTWVzc2FnZVRvRGIiLCJjb252ZXJzYXRpb25JZCIsInJvbGUiLCJjb250ZW50Iiwic3RtdCIsInJ1biIsIkRhdGUiLCJ0b0lTT1N0cmluZyIsImdldE1lc3NhZ2VzRnJvbURiIiwibGltaXQiLCJyb3dzIiwicmV2ZXJzZSIsImdldFVzZXJQcm9maWxlRnJvbURiIiwicm93IiwiZ2V0IiwicmF3VGFncyIsIkpTT04iLCJwYXJzZSIsInRhZ3MiLCJkZW1vZ3JhcGhpY3MiLCJrZXkiLCJ2YWwiLCJPYmplY3QiLCJlbnRyaWVzIiwidmFsdWUiLCJjb25maWRlbmNlIiwicGVyc29uYWxpdHkiLCJsZWFkZXJzaGlwX2xldmVsIiwibGFzdF91cGRhdGVkIiwic2F2ZVVzZXJQcm9maWxlVG9EYiIsInByb2ZpbGUiLCJzdHJpbmdpZnkiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./lib/db.ts\n");

/***/ }),

/***/ "(rsc)/./lib/pipeline.ts":
/*!*************************!*\
  !*** ./lib/pipeline.ts ***!
  \*************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   getRecentHistory: () => (/* binding */ getRecentHistory),\n/* harmony export */   stage1_analyze: () => (/* binding */ stage1_analyze),\n/* harmony export */   stage3Think: () => (/* binding */ stage3Think),\n/* harmony export */   stage4Reply: () => (/* binding */ stage4Reply),\n/* harmony export */   stage5Profile: () => (/* binding */ stage5Profile)\n/* harmony export */ });\n/* harmony import */ var openai__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! openai */ \"(rsc)/./node_modules/openai/index.mjs\");\n/* harmony import */ var _google_generative_ai__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @google/generative-ai */ \"(rsc)/./node_modules/@google/generative-ai/dist/index.mjs\");\n/* harmony import */ var _stage_settings__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./stage_settings */ \"(rsc)/./lib/stage_settings.ts\");\n/* harmony import */ var _db__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./db */ \"(rsc)/./lib/db.ts\");\n\n\n\n\n// Helper function to call AI models (Gemini or DeepSeek)\nasync function callAIModel(modelType, apiKey, prompt, errorMessage = \"AI Service Error\") {\n    if (!apiKey) throw new Error(`${modelType} API Key is missing`);\n    if (modelType === \"gemini\") {\n        const genAI = new _google_generative_ai__WEBPACK_IMPORTED_MODULE_1__.GoogleGenerativeAI(apiKey);\n        const model = genAI.getGenerativeModel({\n            model: \"gemini-1.5-flash\"\n        });\n        const result = await model.generateContent(prompt);\n        return result.response.text();\n    } else {\n        // DeepSeek or other OpenAI-compatible\n        const openai = new openai__WEBPACK_IMPORTED_MODULE_0__[\"default\"]({\n            baseURL: \"https://api.deepseek.com\",\n            apiKey: apiKey\n        });\n        const completion = await openai.chat.completions.create({\n            messages: [\n                {\n                    role: \"system\",\n                    content: prompt\n                }\n            ],\n            model: \"deepseek-chat\"\n        });\n        return completion.choices[0].message.content || \"\";\n    }\n}\n// Stage 2: Memory Retrieval\nfunction getRecentHistory(conversationId) {\n    try {\n        const messages = (0,_db__WEBPACK_IMPORTED_MODULE_3__.getMessagesFromDb)(conversationId, 5); // Get last 5 messages\n        if (messages.length === 0) return \"\";\n        return messages.map((m)=>`${m.role === \"user\" ? \"User\" : \"AI\"}: ${m.content}`).join(\"\\n\");\n    } catch (error) {\n        console.error(\"Failed to retrieve history:\", error);\n        return \"\";\n    }\n}\n// Stage 3: Strategy Generation\nasync function stage3Think(userInput, analysis, history) {\n    // Logic Fix: Always call model, regardless of complexity.\n    // The prompt handles LOW complexity or CHAT intent by generating specific simple strategies.\n    const prompt = _stage_settings__WEBPACK_IMPORTED_MODULE_2__.STAGE3_PROMPT.replace(\"{user_input}\", userInput).replace(\"{intent_json}\", JSON.stringify(analysis)).replace(\"{history_context}\", history || \"无历史记录\");\n    try {\n        const result = await callAIModel(_stage_settings__WEBPACK_IMPORTED_MODULE_2__.STAGE3_MODEL, _stage_settings__WEBPACK_IMPORTED_MODULE_2__.STAGE3_API_KEY, prompt, \"策略生成失败\");\n        return result || \"策略生成失败\";\n    } catch (error) {\n        console.error(\"Stage 3 Thinking Error:\", error);\n        return \"策略生成出错\";\n    }\n}\n// Stage 4: Reply Generation\nasync function stage4Reply(stage3Strategy) {\n    const prompt = _stage_settings__WEBPACK_IMPORTED_MODULE_2__.STAGE4_PROMPT.replace(\"{stage3_strategy}\", stage3Strategy);\n    try {\n        const result = await callAIModel(_stage_settings__WEBPACK_IMPORTED_MODULE_2__.STAGE4_MODEL, _stage_settings__WEBPACK_IMPORTED_MODULE_2__.STAGE4_API_KEY, prompt, \"回复生成失败\");\n        return result || \"回复生成失败\";\n    } catch (error) {\n        console.error(\"Stage 4 Reply Error:\", error);\n        return \"抱歉，我暂时无法生成回复。\";\n    }\n}\n// Stage 1: Intent Analysis\nasync function stage1_analyze(userInput) {\n    const prompt = _stage_settings__WEBPACK_IMPORTED_MODULE_2__.STAGE1_PROMPT.replace(\"{user_input}\", userInput);\n    try {\n        const result = await callAIModel(_stage_settings__WEBPACK_IMPORTED_MODULE_2__.STAGE1_MODEL, _stage_settings__WEBPACK_IMPORTED_MODULE_2__.STAGE1_API_KEY, prompt, \"Intent Analysis Failed\");\n        return parseJsonResult(result);\n    } catch (error) {\n        console.error(\"Stage 1 Analysis Error:\", error);\n        return {\n            intent: \"CHAT\",\n            sentiment: \"Unknown\",\n            complexity: \"LOW\",\n            keywords: [\n                \"Error\"\n            ]\n        };\n    }\n}\n// Stage 5: User Profiling (Profile Engine)\nasync function stage5Profile(history) {\n    console.log(\"Stage 5 is temporarily disabled by user request.\");\n    return null;\n/* \n  // Original Stage 5 Implementation (Temporarily Disabled)\n  console.log('Stage 5 Input History:', history); // Debug Input\n  let currentProfile: UserProfile | null = null;\n  \n  try {\n    // 1. Get existing profile (Moved inside try-catch)\n    currentProfile = getUserProfileFromDb();\n    const currentProfileStr = currentProfile ? JSON.stringify(currentProfile) : \"无现有画像 (New User)\";\n\n    // 2. Prepare Prompt\n    const prompt = STAGE5_PROMPT\n      .replace(\"{current_profile}\", currentProfileStr)\n      .replace(\"{recent_history}\", history || \"无近期对话\");\n\n    // 3. Call AI\n    const result = await callAIModel(STAGE5_MODEL, STAGE5_API_KEY, prompt, \"Profile Update Failed\");\n    \n    // 4. Parse Result\n    const newProfileData = parseJsonResult(result);\n    \n    // Validate structure a bit (optional but good practice)\n    if (!newProfileData.demographics || !newProfileData.leadership_level) {\n      console.warn(\"Stage 5 returned invalid JSON structure:\", newProfileData);\n      return currentProfile; // Fallback to old profile if new one is invalid\n    }\n\n    const newProfile: UserProfile = {\n      demographics: newProfileData.demographics,\n      personality: newProfileData.personality || \"未知\",\n      leadership_level: newProfileData.leadership_level,\n      analysis_log: newProfileData.analysis_log || \"No analysis log returned\",\n      last_updated: new Date().toISOString()\n    };\n\n    // 5. Save to DB\n    saveUserProfileToDb(newProfile);\n\n    return newProfile;\n  } catch (error) {\n    console.error(\"Stage 5 Profile Error:\", error);\n    return currentProfile; // Return existing profile on error\n  }\n  */ }\nfunction parseJsonResult(text) {\n    try {\n        let jsonStr = text;\n        // 1. Try to extract JSON object from the text using regex\n        // This looks for the first '{' and the last '}' to capture the full object\n        // effectively ignoring any preamble or postscript text.\n        const jsonMatch = text.match(/\\{[\\s\\S]*\\}/);\n        if (jsonMatch) {\n            jsonStr = jsonMatch[0];\n        }\n        // 2. Parse the extracted string\n        return JSON.parse(jsonStr);\n    } catch (e) {\n        console.error(\"Stage 5 JSON Parse Error:\", e);\n        console.log(\"Raw Content:\", text); // Log raw content for debugging\n        // Return empty object instead of crashing, to allow pipeline to continue\n        // but with a special flag/log if needed\n        return {\n            analysis_log: \"JSON Parsing Failed. Check backend logs for Raw Content.\"\n        };\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9saWIvcGlwZWxpbmUudHMiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7O0FBQTRCO0FBQytCO0FBY2pDO0FBQzBEO0FBR3BGLHlEQUF5RDtBQUN6RCxlQUFlWSxZQUNiQyxTQUFpQixFQUNqQkMsTUFBYyxFQUNkQyxNQUFjLEVBQ2RDLGVBQXVCLGtCQUFrQjtJQUV6QyxJQUFJLENBQUNGLFFBQVEsTUFBTSxJQUFJRyxNQUFNLENBQUMsRUFBRUosVUFBVSxtQkFBbUIsQ0FBQztJQUU5RCxJQUFJQSxjQUFjLFVBQVU7UUFDMUIsTUFBTUssUUFBUSxJQUFJakIscUVBQWtCQSxDQUFDYTtRQUNyQyxNQUFNSyxRQUFRRCxNQUFNRSxrQkFBa0IsQ0FBQztZQUFFRCxPQUFPO1FBQW1CO1FBQ25FLE1BQU1FLFNBQVMsTUFBTUYsTUFBTUcsZUFBZSxDQUFDUDtRQUMzQyxPQUFPTSxPQUFPRSxRQUFRLENBQUNDLElBQUk7SUFDN0IsT0FBTztRQUNMLHNDQUFzQztRQUN0QyxNQUFNQyxTQUFTLElBQUl6Qiw4Q0FBTUEsQ0FBQztZQUN4QjBCLFNBQVM7WUFDVFosUUFBUUE7UUFDVjtRQUNBLE1BQU1hLGFBQWEsTUFBTUYsT0FBT0csSUFBSSxDQUFDQyxXQUFXLENBQUNDLE1BQU0sQ0FBQztZQUN0REMsVUFBVTtnQkFBQztvQkFBRUMsTUFBTTtvQkFBVUMsU0FBU2xCO2dCQUFPO2FBQUU7WUFDL0NJLE9BQU87UUFDVDtRQUNBLE9BQU9RLFdBQVdPLE9BQU8sQ0FBQyxFQUFFLENBQUNDLE9BQU8sQ0FBQ0YsT0FBTyxJQUFJO0lBQ2xEO0FBQ0Y7QUFFQSw0QkFBNEI7QUFDckIsU0FBU0csaUJBQWlCQyxjQUFzQjtJQUNyRCxJQUFJO1FBQ0YsTUFBTU4sV0FBV3BCLHNEQUFpQkEsQ0FBQzBCLGdCQUFnQixJQUFJLHNCQUFzQjtRQUM3RSxJQUFJTixTQUFTTyxNQUFNLEtBQUssR0FBRyxPQUFPO1FBRWxDLE9BQU9QLFNBQVNRLEdBQUcsQ0FBQ0MsQ0FBQUEsSUFBSyxDQUFDLEVBQUVBLEVBQUVSLElBQUksS0FBSyxTQUFTLFNBQVMsS0FBSyxFQUFFLEVBQUVRLEVBQUVQLE9BQU8sQ0FBQyxDQUFDLEVBQUVRLElBQUksQ0FBQztJQUN0RixFQUFFLE9BQU9DLE9BQU87UUFDZEMsUUFBUUQsS0FBSyxDQUFDLCtCQUErQkE7UUFDN0MsT0FBTztJQUNUO0FBQ0Y7QUFFQSwrQkFBK0I7QUFDeEIsZUFBZUUsWUFDcEJDLFNBQWlCLEVBQ2pCQyxRQUF3QixFQUN4QkMsT0FBZTtJQUVmLDBEQUEwRDtJQUMxRCw2RkFBNkY7SUFFN0YsTUFBTWhDLFNBQVNSLDBEQUFhQSxDQUN6QnlDLE9BQU8sQ0FBQyxnQkFBZ0JILFdBQ3hCRyxPQUFPLENBQUMsaUJBQWlCQyxLQUFLQyxTQUFTLENBQUNKLFdBQ3hDRSxPQUFPLENBQUMscUJBQXFCRCxXQUFXO0lBRTNDLElBQUk7UUFDRixNQUFNMUIsU0FBUyxNQUFNVCxZQUFZUCx5REFBWUEsRUFBRUMsMkRBQWNBLEVBQUVTLFFBQVE7UUFDdkUsT0FBT00sVUFBVTtJQUNuQixFQUFFLE9BQU9xQixPQUFPO1FBQ2RDLFFBQVFELEtBQUssQ0FBQywyQkFBMkJBO1FBQ3pDLE9BQU87SUFDVDtBQUNGO0FBRUEsNEJBQTRCO0FBQ3JCLGVBQWVTLFlBQ3BCQyxjQUFzQjtJQUV0QixNQUFNckMsU0FBU0wsMERBQWFBLENBQUNzQyxPQUFPLENBQUMscUJBQXFCSTtJQUUxRCxJQUFJO1FBQ0YsTUFBTS9CLFNBQVMsTUFBTVQsWUFBWUoseURBQVlBLEVBQUVDLDJEQUFjQSxFQUFFTSxRQUFRO1FBQ3ZFLE9BQU9NLFVBQVU7SUFDbkIsRUFBRSxPQUFPcUIsT0FBTztRQUNkQyxRQUFRRCxLQUFLLENBQUMsd0JBQXdCQTtRQUN0QyxPQUFPO0lBQ1Q7QUFDRjtBQUVBLDJCQUEyQjtBQUNwQixlQUFlVyxlQUFlUixTQUFpQjtJQUNwRCxNQUFNOUIsU0FBU1gsMERBQWFBLENBQUM0QyxPQUFPLENBQUMsZ0JBQWdCSDtJQUVyRCxJQUFJO1FBQ0YsTUFBTXhCLFNBQVMsTUFBTVQsWUFBWVYseURBQVlBLEVBQUVDLDJEQUFjQSxFQUFFWSxRQUFRO1FBQ3ZFLE9BQU91QyxnQkFBZ0JqQztJQUN6QixFQUFFLE9BQU9xQixPQUFPO1FBQ2RDLFFBQVFELEtBQUssQ0FBQywyQkFBMkJBO1FBQ3pDLE9BQU87WUFDTGEsUUFBUTtZQUNSQyxXQUFXO1lBQ1hDLFlBQVk7WUFDWkMsVUFBVTtnQkFBQzthQUFRO1FBQ3JCO0lBQ0Y7QUFDRjtBQUVBLDJDQUEyQztBQUNwQyxlQUFlQyxjQUNwQlosT0FBZTtJQUVmSixRQUFRaUIsR0FBRyxDQUFDO0lBQ1osT0FBTztBQUVQOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0VBMkNBLEdBQ0Y7QUFFQSxTQUFTTixnQkFBZ0I5QixJQUFZO0lBQ25DLElBQUk7UUFDRixJQUFJcUMsVUFBVXJDO1FBRWQsMERBQTBEO1FBQzFELDJFQUEyRTtRQUMzRSx3REFBd0Q7UUFDeEQsTUFBTXNDLFlBQVl0QyxLQUFLdUMsS0FBSyxDQUFDO1FBQzdCLElBQUlELFdBQVc7WUFDYkQsVUFBVUMsU0FBUyxDQUFDLEVBQUU7UUFDeEI7UUFFQSxnQ0FBZ0M7UUFDaEMsT0FBT2IsS0FBS2UsS0FBSyxDQUFDSDtJQUNwQixFQUFFLE9BQU9JLEdBQUc7UUFDVnRCLFFBQVFELEtBQUssQ0FBQyw2QkFBNkJ1QjtRQUMzQ3RCLFFBQVFpQixHQUFHLENBQUMsZ0JBQWdCcEMsT0FBTyxnQ0FBZ0M7UUFFbkUseUVBQXlFO1FBQ3pFLHdDQUF3QztRQUN4QyxPQUFPO1lBQUUwQyxjQUFjO1FBQTJEO0lBQ3BGO0FBQ0YiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9haS1jb2FjaC1mcm9udGVuZC8uL2xpYi9waXBlbGluZS50cz81MjgwIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBPcGVuQUkgZnJvbSBcIm9wZW5haVwiO1xuaW1wb3J0IHsgR29vZ2xlR2VuZXJhdGl2ZUFJIH0gZnJvbSBcIkBnb29nbGUvZ2VuZXJhdGl2ZS1haVwiO1xuaW1wb3J0IHsgXG4gIFNUQUdFMV9NT0RFTCxcbiAgU1RBR0UxX0FQSV9LRVksXG4gIFNUQUdFMV9QUk9NUFQsXG4gIFNUQUdFM19NT0RFTCxcbiAgU1RBR0UzX0FQSV9LRVksXG4gIFNUQUdFM19QUk9NUFQsXG4gIFNUQUdFNF9NT0RFTCxcbiAgU1RBR0U0X0FQSV9LRVksXG4gIFNUQUdFNF9QUk9NUFQsXG4gIFNUQUdFNV9NT0RFTCxcbiAgU1RBR0U1X0FQSV9LRVksXG4gIFNUQUdFNV9QUk9NUFRcbn0gZnJvbSBcIi4vc3RhZ2Vfc2V0dGluZ3NcIjtcbmltcG9ydCB7IGdldE1lc3NhZ2VzRnJvbURiLCBnZXRVc2VyUHJvZmlsZUZyb21EYiwgc2F2ZVVzZXJQcm9maWxlVG9EYiB9IGZyb20gXCIuL2RiXCI7XG5pbXBvcnQgeyBTdGFnZTFBbmFseXNpcywgVXNlclByb2ZpbGUgfSBmcm9tIFwiLi90eXBlc1wiO1xuXG4vLyBIZWxwZXIgZnVuY3Rpb24gdG8gY2FsbCBBSSBtb2RlbHMgKEdlbWluaSBvciBEZWVwU2VlaylcbmFzeW5jIGZ1bmN0aW9uIGNhbGxBSU1vZGVsKFxuICBtb2RlbFR5cGU6IHN0cmluZywgXG4gIGFwaUtleTogc3RyaW5nLCBcbiAgcHJvbXB0OiBzdHJpbmcsIFxuICBlcnJvck1lc3NhZ2U6IHN0cmluZyA9IFwiQUkgU2VydmljZSBFcnJvclwiXG4pOiBQcm9taXNlPHN0cmluZz4ge1xuICBpZiAoIWFwaUtleSkgdGhyb3cgbmV3IEVycm9yKGAke21vZGVsVHlwZX0gQVBJIEtleSBpcyBtaXNzaW5nYCk7XG5cbiAgaWYgKG1vZGVsVHlwZSA9PT0gXCJnZW1pbmlcIikge1xuICAgIGNvbnN0IGdlbkFJID0gbmV3IEdvb2dsZUdlbmVyYXRpdmVBSShhcGlLZXkpO1xuICAgIGNvbnN0IG1vZGVsID0gZ2VuQUkuZ2V0R2VuZXJhdGl2ZU1vZGVsKHsgbW9kZWw6IFwiZ2VtaW5pLTEuNS1mbGFzaFwiIH0pO1xuICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IG1vZGVsLmdlbmVyYXRlQ29udGVudChwcm9tcHQpO1xuICAgIHJldHVybiByZXN1bHQucmVzcG9uc2UudGV4dCgpO1xuICB9IGVsc2Uge1xuICAgIC8vIERlZXBTZWVrIG9yIG90aGVyIE9wZW5BSS1jb21wYXRpYmxlXG4gICAgY29uc3Qgb3BlbmFpID0gbmV3IE9wZW5BSSh7XG4gICAgICBiYXNlVVJMOiBcImh0dHBzOi8vYXBpLmRlZXBzZWVrLmNvbVwiLFxuICAgICAgYXBpS2V5OiBhcGlLZXksXG4gICAgfSk7XG4gICAgY29uc3QgY29tcGxldGlvbiA9IGF3YWl0IG9wZW5haS5jaGF0LmNvbXBsZXRpb25zLmNyZWF0ZSh7XG4gICAgICBtZXNzYWdlczogW3sgcm9sZTogXCJzeXN0ZW1cIiwgY29udGVudDogcHJvbXB0IH1dLFxuICAgICAgbW9kZWw6IFwiZGVlcHNlZWstY2hhdFwiLFxuICAgIH0pO1xuICAgIHJldHVybiBjb21wbGV0aW9uLmNob2ljZXNbMF0ubWVzc2FnZS5jb250ZW50IHx8IFwiXCI7XG4gIH1cbn1cblxuLy8gU3RhZ2UgMjogTWVtb3J5IFJldHJpZXZhbFxuZXhwb3J0IGZ1bmN0aW9uIGdldFJlY2VudEhpc3RvcnkoY29udmVyc2F0aW9uSWQ6IHN0cmluZyk6IHN0cmluZyB7XG4gIHRyeSB7XG4gICAgY29uc3QgbWVzc2FnZXMgPSBnZXRNZXNzYWdlc0Zyb21EYihjb252ZXJzYXRpb25JZCwgNSk7IC8vIEdldCBsYXN0IDUgbWVzc2FnZXNcbiAgICBpZiAobWVzc2FnZXMubGVuZ3RoID09PSAwKSByZXR1cm4gXCJcIjtcbiAgICBcbiAgICByZXR1cm4gbWVzc2FnZXMubWFwKG0gPT4gYCR7bS5yb2xlID09PSAndXNlcicgPyAnVXNlcicgOiAnQUknfTogJHttLmNvbnRlbnR9YCkuam9pbihcIlxcblwiKTtcbiAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICBjb25zb2xlLmVycm9yKFwiRmFpbGVkIHRvIHJldHJpZXZlIGhpc3Rvcnk6XCIsIGVycm9yKTtcbiAgICByZXR1cm4gXCJcIjtcbiAgfVxufVxuXG4vLyBTdGFnZSAzOiBTdHJhdGVneSBHZW5lcmF0aW9uXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gc3RhZ2UzVGhpbmsoXG4gIHVzZXJJbnB1dDogc3RyaW5nLCBcbiAgYW5hbHlzaXM6IFN0YWdlMUFuYWx5c2lzLCBcbiAgaGlzdG9yeTogc3RyaW5nXG4pOiBQcm9taXNlPHN0cmluZyB8IG51bGw+IHtcbiAgLy8gTG9naWMgRml4OiBBbHdheXMgY2FsbCBtb2RlbCwgcmVnYXJkbGVzcyBvZiBjb21wbGV4aXR5LlxuICAvLyBUaGUgcHJvbXB0IGhhbmRsZXMgTE9XIGNvbXBsZXhpdHkgb3IgQ0hBVCBpbnRlbnQgYnkgZ2VuZXJhdGluZyBzcGVjaWZpYyBzaW1wbGUgc3RyYXRlZ2llcy5cbiAgXG4gIGNvbnN0IHByb21wdCA9IFNUQUdFM19QUk9NUFRcbiAgICAucmVwbGFjZShcInt1c2VyX2lucHV0fVwiLCB1c2VySW5wdXQpXG4gICAgLnJlcGxhY2UoXCJ7aW50ZW50X2pzb259XCIsIEpTT04uc3RyaW5naWZ5KGFuYWx5c2lzKSlcbiAgICAucmVwbGFjZShcIntoaXN0b3J5X2NvbnRleHR9XCIsIGhpc3RvcnkgfHwgXCLml6Dljoblj7LorrDlvZVcIik7XG5cbiAgdHJ5IHtcbiAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBjYWxsQUlNb2RlbChTVEFHRTNfTU9ERUwsIFNUQUdFM19BUElfS0VZLCBwcm9tcHQsIFwi562W55Wl55Sf5oiQ5aSx6LSlXCIpO1xuICAgIHJldHVybiByZXN1bHQgfHwgXCLnrZbnlaXnlJ/miJDlpLHotKVcIjtcbiAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICBjb25zb2xlLmVycm9yKFwiU3RhZ2UgMyBUaGlua2luZyBFcnJvcjpcIiwgZXJyb3IpO1xuICAgIHJldHVybiBcIuetlueVpeeUn+aIkOWHuumUmVwiO1xuICB9XG59XG5cbi8vIFN0YWdlIDQ6IFJlcGx5IEdlbmVyYXRpb25cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBzdGFnZTRSZXBseShcbiAgc3RhZ2UzU3RyYXRlZ3k6IHN0cmluZ1xuKTogUHJvbWlzZTxzdHJpbmc+IHtcbiAgY29uc3QgcHJvbXB0ID0gU1RBR0U0X1BST01QVC5yZXBsYWNlKFwie3N0YWdlM19zdHJhdGVneX1cIiwgc3RhZ2UzU3RyYXRlZ3kpO1xuXG4gIHRyeSB7XG4gICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgY2FsbEFJTW9kZWwoU1RBR0U0X01PREVMLCBTVEFHRTRfQVBJX0tFWSwgcHJvbXB0LCBcIuWbnuWkjeeUn+aIkOWksei0pVwiKTtcbiAgICByZXR1cm4gcmVzdWx0IHx8IFwi5Zue5aSN55Sf5oiQ5aSx6LSlXCI7XG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgY29uc29sZS5lcnJvcihcIlN0YWdlIDQgUmVwbHkgRXJyb3I6XCIsIGVycm9yKTtcbiAgICByZXR1cm4gXCLmirHmrYnvvIzmiJHmmoLml7bml6Dms5XnlJ/miJDlm57lpI3jgIJcIjtcbiAgfVxufVxuXG4vLyBTdGFnZSAxOiBJbnRlbnQgQW5hbHlzaXNcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBzdGFnZTFfYW5hbHl6ZSh1c2VySW5wdXQ6IHN0cmluZyk6IFByb21pc2U8U3RhZ2UxQW5hbHlzaXM+IHtcbiAgY29uc3QgcHJvbXB0ID0gU1RBR0UxX1BST01QVC5yZXBsYWNlKFwie3VzZXJfaW5wdXR9XCIsIHVzZXJJbnB1dCk7XG5cbiAgdHJ5IHtcbiAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBjYWxsQUlNb2RlbChTVEFHRTFfTU9ERUwsIFNUQUdFMV9BUElfS0VZLCBwcm9tcHQsIFwiSW50ZW50IEFuYWx5c2lzIEZhaWxlZFwiKTtcbiAgICByZXR1cm4gcGFyc2VKc29uUmVzdWx0KHJlc3VsdCk7XG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgY29uc29sZS5lcnJvcihcIlN0YWdlIDEgQW5hbHlzaXMgRXJyb3I6XCIsIGVycm9yKTtcbiAgICByZXR1cm4ge1xuICAgICAgaW50ZW50OiBcIkNIQVRcIixcbiAgICAgIHNlbnRpbWVudDogXCJVbmtub3duXCIsXG4gICAgICBjb21wbGV4aXR5OiBcIkxPV1wiLFxuICAgICAga2V5d29yZHM6IFtcIkVycm9yXCJdLFxuICAgIH07XG4gIH1cbn1cblxuLy8gU3RhZ2UgNTogVXNlciBQcm9maWxpbmcgKFByb2ZpbGUgRW5naW5lKVxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHN0YWdlNVByb2ZpbGUoXG4gIGhpc3Rvcnk6IHN0cmluZ1xuKTogUHJvbWlzZTxVc2VyUHJvZmlsZSB8IG51bGw+IHtcbiAgY29uc29sZS5sb2coJ1N0YWdlIDUgaXMgdGVtcG9yYXJpbHkgZGlzYWJsZWQgYnkgdXNlciByZXF1ZXN0LicpO1xuICByZXR1cm4gbnVsbDtcblxuICAvKiBcbiAgLy8gT3JpZ2luYWwgU3RhZ2UgNSBJbXBsZW1lbnRhdGlvbiAoVGVtcG9yYXJpbHkgRGlzYWJsZWQpXG4gIGNvbnNvbGUubG9nKCdTdGFnZSA1IElucHV0IEhpc3Rvcnk6JywgaGlzdG9yeSk7IC8vIERlYnVnIElucHV0XG4gIGxldCBjdXJyZW50UHJvZmlsZTogVXNlclByb2ZpbGUgfCBudWxsID0gbnVsbDtcbiAgXG4gIHRyeSB7XG4gICAgLy8gMS4gR2V0IGV4aXN0aW5nIHByb2ZpbGUgKE1vdmVkIGluc2lkZSB0cnktY2F0Y2gpXG4gICAgY3VycmVudFByb2ZpbGUgPSBnZXRVc2VyUHJvZmlsZUZyb21EYigpO1xuICAgIGNvbnN0IGN1cnJlbnRQcm9maWxlU3RyID0gY3VycmVudFByb2ZpbGUgPyBKU09OLnN0cmluZ2lmeShjdXJyZW50UHJvZmlsZSkgOiBcIuaXoOeOsOacieeUu+WDjyAoTmV3IFVzZXIpXCI7XG5cbiAgICAvLyAyLiBQcmVwYXJlIFByb21wdFxuICAgIGNvbnN0IHByb21wdCA9IFNUQUdFNV9QUk9NUFRcbiAgICAgIC5yZXBsYWNlKFwie2N1cnJlbnRfcHJvZmlsZX1cIiwgY3VycmVudFByb2ZpbGVTdHIpXG4gICAgICAucmVwbGFjZShcIntyZWNlbnRfaGlzdG9yeX1cIiwgaGlzdG9yeSB8fCBcIuaXoOi/keacn+WvueivnVwiKTtcblxuICAgIC8vIDMuIENhbGwgQUlcbiAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBjYWxsQUlNb2RlbChTVEFHRTVfTU9ERUwsIFNUQUdFNV9BUElfS0VZLCBwcm9tcHQsIFwiUHJvZmlsZSBVcGRhdGUgRmFpbGVkXCIpO1xuICAgIFxuICAgIC8vIDQuIFBhcnNlIFJlc3VsdFxuICAgIGNvbnN0IG5ld1Byb2ZpbGVEYXRhID0gcGFyc2VKc29uUmVzdWx0KHJlc3VsdCk7XG4gICAgXG4gICAgLy8gVmFsaWRhdGUgc3RydWN0dXJlIGEgYml0IChvcHRpb25hbCBidXQgZ29vZCBwcmFjdGljZSlcbiAgICBpZiAoIW5ld1Byb2ZpbGVEYXRhLmRlbW9ncmFwaGljcyB8fCAhbmV3UHJvZmlsZURhdGEubGVhZGVyc2hpcF9sZXZlbCkge1xuICAgICAgY29uc29sZS53YXJuKFwiU3RhZ2UgNSByZXR1cm5lZCBpbnZhbGlkIEpTT04gc3RydWN0dXJlOlwiLCBuZXdQcm9maWxlRGF0YSk7XG4gICAgICByZXR1cm4gY3VycmVudFByb2ZpbGU7IC8vIEZhbGxiYWNrIHRvIG9sZCBwcm9maWxlIGlmIG5ldyBvbmUgaXMgaW52YWxpZFxuICAgIH1cblxuICAgIGNvbnN0IG5ld1Byb2ZpbGU6IFVzZXJQcm9maWxlID0ge1xuICAgICAgZGVtb2dyYXBoaWNzOiBuZXdQcm9maWxlRGF0YS5kZW1vZ3JhcGhpY3MsXG4gICAgICBwZXJzb25hbGl0eTogbmV3UHJvZmlsZURhdGEucGVyc29uYWxpdHkgfHwgXCLmnKrnn6VcIixcbiAgICAgIGxlYWRlcnNoaXBfbGV2ZWw6IG5ld1Byb2ZpbGVEYXRhLmxlYWRlcnNoaXBfbGV2ZWwsXG4gICAgICBhbmFseXNpc19sb2c6IG5ld1Byb2ZpbGVEYXRhLmFuYWx5c2lzX2xvZyB8fCBcIk5vIGFuYWx5c2lzIGxvZyByZXR1cm5lZFwiLFxuICAgICAgbGFzdF91cGRhdGVkOiBuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKClcbiAgICB9O1xuXG4gICAgLy8gNS4gU2F2ZSB0byBEQlxuICAgIHNhdmVVc2VyUHJvZmlsZVRvRGIobmV3UHJvZmlsZSk7XG5cbiAgICByZXR1cm4gbmV3UHJvZmlsZTtcbiAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICBjb25zb2xlLmVycm9yKFwiU3RhZ2UgNSBQcm9maWxlIEVycm9yOlwiLCBlcnJvcik7XG4gICAgcmV0dXJuIGN1cnJlbnRQcm9maWxlOyAvLyBSZXR1cm4gZXhpc3RpbmcgcHJvZmlsZSBvbiBlcnJvclxuICB9XG4gICovXG59XG5cbmZ1bmN0aW9uIHBhcnNlSnNvblJlc3VsdCh0ZXh0OiBzdHJpbmcpOiBhbnkge1xuICB0cnkge1xuICAgIGxldCBqc29uU3RyID0gdGV4dDtcblxuICAgIC8vIDEuIFRyeSB0byBleHRyYWN0IEpTT04gb2JqZWN0IGZyb20gdGhlIHRleHQgdXNpbmcgcmVnZXhcbiAgICAvLyBUaGlzIGxvb2tzIGZvciB0aGUgZmlyc3QgJ3snIGFuZCB0aGUgbGFzdCAnfScgdG8gY2FwdHVyZSB0aGUgZnVsbCBvYmplY3RcbiAgICAvLyBlZmZlY3RpdmVseSBpZ25vcmluZyBhbnkgcHJlYW1ibGUgb3IgcG9zdHNjcmlwdCB0ZXh0LlxuICAgIGNvbnN0IGpzb25NYXRjaCA9IHRleHQubWF0Y2goL1xce1tcXHNcXFNdKlxcfS8pO1xuICAgIGlmIChqc29uTWF0Y2gpIHtcbiAgICAgIGpzb25TdHIgPSBqc29uTWF0Y2hbMF07XG4gICAgfVxuICAgIFxuICAgIC8vIDIuIFBhcnNlIHRoZSBleHRyYWN0ZWQgc3RyaW5nXG4gICAgcmV0dXJuIEpTT04ucGFyc2UoanNvblN0cik7XG4gIH0gY2F0Y2ggKGUpIHtcbiAgICBjb25zb2xlLmVycm9yKFwiU3RhZ2UgNSBKU09OIFBhcnNlIEVycm9yOlwiLCBlKTtcbiAgICBjb25zb2xlLmxvZyhcIlJhdyBDb250ZW50OlwiLCB0ZXh0KTsgLy8gTG9nIHJhdyBjb250ZW50IGZvciBkZWJ1Z2dpbmdcbiAgICBcbiAgICAvLyBSZXR1cm4gZW1wdHkgb2JqZWN0IGluc3RlYWQgb2YgY3Jhc2hpbmcsIHRvIGFsbG93IHBpcGVsaW5lIHRvIGNvbnRpbnVlXG4gICAgLy8gYnV0IHdpdGggYSBzcGVjaWFsIGZsYWcvbG9nIGlmIG5lZWRlZFxuICAgIHJldHVybiB7IGFuYWx5c2lzX2xvZzogXCJKU09OIFBhcnNpbmcgRmFpbGVkLiBDaGVjayBiYWNrZW5kIGxvZ3MgZm9yIFJhdyBDb250ZW50LlwiIH07XG4gIH1cbn1cbiJdLCJuYW1lcyI6WyJPcGVuQUkiLCJHb29nbGVHZW5lcmF0aXZlQUkiLCJTVEFHRTFfTU9ERUwiLCJTVEFHRTFfQVBJX0tFWSIsIlNUQUdFMV9QUk9NUFQiLCJTVEFHRTNfTU9ERUwiLCJTVEFHRTNfQVBJX0tFWSIsIlNUQUdFM19QUk9NUFQiLCJTVEFHRTRfTU9ERUwiLCJTVEFHRTRfQVBJX0tFWSIsIlNUQUdFNF9QUk9NUFQiLCJnZXRNZXNzYWdlc0Zyb21EYiIsImNhbGxBSU1vZGVsIiwibW9kZWxUeXBlIiwiYXBpS2V5IiwicHJvbXB0IiwiZXJyb3JNZXNzYWdlIiwiRXJyb3IiLCJnZW5BSSIsIm1vZGVsIiwiZ2V0R2VuZXJhdGl2ZU1vZGVsIiwicmVzdWx0IiwiZ2VuZXJhdGVDb250ZW50IiwicmVzcG9uc2UiLCJ0ZXh0Iiwib3BlbmFpIiwiYmFzZVVSTCIsImNvbXBsZXRpb24iLCJjaGF0IiwiY29tcGxldGlvbnMiLCJjcmVhdGUiLCJtZXNzYWdlcyIsInJvbGUiLCJjb250ZW50IiwiY2hvaWNlcyIsIm1lc3NhZ2UiLCJnZXRSZWNlbnRIaXN0b3J5IiwiY29udmVyc2F0aW9uSWQiLCJsZW5ndGgiLCJtYXAiLCJtIiwiam9pbiIsImVycm9yIiwiY29uc29sZSIsInN0YWdlM1RoaW5rIiwidXNlcklucHV0IiwiYW5hbHlzaXMiLCJoaXN0b3J5IiwicmVwbGFjZSIsIkpTT04iLCJzdHJpbmdpZnkiLCJzdGFnZTRSZXBseSIsInN0YWdlM1N0cmF0ZWd5Iiwic3RhZ2UxX2FuYWx5emUiLCJwYXJzZUpzb25SZXN1bHQiLCJpbnRlbnQiLCJzZW50aW1lbnQiLCJjb21wbGV4aXR5Iiwia2V5d29yZHMiLCJzdGFnZTVQcm9maWxlIiwibG9nIiwianNvblN0ciIsImpzb25NYXRjaCIsIm1hdGNoIiwicGFyc2UiLCJlIiwiYW5hbHlzaXNfbG9nIl0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./lib/pipeline.ts\n");

/***/ }),

/***/ "(rsc)/./lib/stage_settings.ts":
/*!*******************************!*\
  !*** ./lib/stage_settings.ts ***!
  \*******************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   COMMON_DEEPSEEK_KEY: () => (/* binding */ COMMON_DEEPSEEK_KEY),\n/* harmony export */   COMMON_GEMINI_KEY: () => (/* binding */ COMMON_GEMINI_KEY),\n/* harmony export */   STAGE1_API_KEY: () => (/* binding */ STAGE1_API_KEY),\n/* harmony export */   STAGE1_MODEL: () => (/* binding */ STAGE1_MODEL),\n/* harmony export */   STAGE1_PROMPT: () => (/* binding */ STAGE1_PROMPT),\n/* harmony export */   STAGE3_API_KEY: () => (/* binding */ STAGE3_API_KEY),\n/* harmony export */   STAGE3_MODEL: () => (/* binding */ STAGE3_MODEL),\n/* harmony export */   STAGE3_PROMPT: () => (/* binding */ STAGE3_PROMPT),\n/* harmony export */   STAGE4_API_KEY: () => (/* binding */ STAGE4_API_KEY),\n/* harmony export */   STAGE4_MODEL: () => (/* binding */ STAGE4_MODEL),\n/* harmony export */   STAGE4_PROMPT: () => (/* binding */ STAGE4_PROMPT),\n/* harmony export */   STAGE5_API_KEY: () => (/* binding */ STAGE5_API_KEY),\n/* harmony export */   STAGE5_MODEL: () => (/* binding */ STAGE5_MODEL),\n/* harmony export */   STAGE5_PROMPT: () => (/* binding */ STAGE5_PROMPT)\n/* harmony export */ });\n// ==================================================================================\n// AI Coach - Global Configuration & Stage Settings\n// ==================================================================================\n// 此文件集中管理 API 密钥和各个阶段的 Prompt (提示词)。\n// 你可以在这里定义全局的 Key，并在各个 Stage 中选择使用哪一个。\n// ==================================================================================\n// ----------------------------------------------------------------------------------\n// 1. Global API Keys (全局 API 密钥)\n// ----------------------------------------------------------------------------------\n// 在此处填入你的 API Key，供下方各个 Stage 调用。\nconst COMMON_DEEPSEEK_KEY = \"sk-9c559429638842fe854f0c1603eba9a3\";\nconst COMMON_GEMINI_KEY = \"\";\n// ----------------------------------------------------------------------------------\n// 2. Stage Settings (阶段配置)\n// ----------------------------------------------------------------------------------\n// [Stage 1: Intent Analysis - 意图分诊]\n// ----------------------------------------------------------------------------------\n// 提示词 (Prompt)\nconst STAGE1_PROMPT = `\r\n你是一个意图分析专家。\r\n任务：分析用户输入。不要回答问题，仅输出 JSON。\r\n输入：\"{user_input}\"\r\n分析维度：\r\n1. intent (意图): [DECISION] (决策) / [EMOTIONAL] (情绪发泄) / [QUERY] (知识咨询) / [CHAT] (闲聊)\r\n2. sentiment (情绪色谱): 描述用户的情绪 (如: 愤怒、焦虑、冷静、迷茫)\r\n3. complexity (复杂度): [HIGH] (需要深度思考) / [LOW] (简单回复)\r\n4. keywords (关键词): 提取 1-3 个核心词\r\n输出格式(JSON Only):\r\n{\"intent\": \"...\", \"sentiment\": \"...\", \"complexity\": \"...\", \"keywords\": [...]}\r\n`;\n// 模型选择开关 (Model Switch)\n// 可选值: \"deepseek\" 或 \"gemini\"\nconst STAGE1_MODEL = \"deepseek\";\n// 当前阶段使用的 API Key (自动映射)\n// 根据 STAGE1_MODEL 的值自动选择对应的 Key\nconst STAGE1_API_KEY = STAGE1_MODEL === \"gemini\" ? COMMON_GEMINI_KEY : COMMON_DEEPSEEK_KEY;\n// [Stage 3: Deep Thinking Strategy - 深度思考策略]\n// ----------------------------------------------------------------------------------\n// 提示词 (Prompt)\nconst STAGE3_PROMPT = `\r\n你是一个高管教练的幕后军师。\r\n任务：基于用户情况，制定辅导策略。不要直接回复用户，只输出简短的内部策略。\r\n输入：\"{user_input}\"\r\n意图分析：{intent_json}\r\n历史摘要：{history_context}\r\n思考维度：\r\n1. 潜台词：用户表面在问什么？实际担心什么？\r\n2. 策略：此时应该“共情倾听”还是“挑战提问”？\r\n3. 建议方向：给出一个核心建议点。\r\n\r\n[特殊情况处理]\r\n- 如果 Intent 是 [CHAT] 或 Complexity 是 [LOW]：\r\n  不要过度分析。你的策略应该是“建立亲和力 (Rapport Building)”或“快速响应”。\r\n  策略示例：“用户在打招呼。策略：热情回应，并试探性询问是否有什么具体事情需要帮忙。”\r\n- 如果 Intent 是 [EMOTIONAL]：\r\n  策略重点是“共情与看见”。\r\n\r\n输出：一段简短的纯文本策略笔记。\r\n`;\n// 模型选择开关 (Model Switch)\nconst STAGE3_MODEL = \"deepseek\";\n// 当前阶段使用的 API Key\nconst STAGE3_API_KEY = STAGE3_MODEL === \"gemini\" ? COMMON_GEMINI_KEY : COMMON_DEEPSEEK_KEY;\n// [Stage 4: Expression Layer - 表达层]\n// ----------------------------------------------------------------------------------\n// 提示词 (Prompt)\nconst STAGE4_PROMPT = `\r\n你是一位资深的高管教练（Executive Coach）。\r\n你的“大脑”已经制定了如下辅导策略：\r\n{stage3_strategy}\r\n\r\n请根据该策略，回复用户。\r\n要求：\r\n1. 语气：温暖、坚定、平视（不要仰视也不要俯视）。\r\n2. 风格：口语化，杜绝“翻译腔”或“AI味”。\r\n3. 长度：控制在 100-200 字以内，金句频出。\r\n4. 此时不要输出 JSON，直接输出回复内容。\r\n`;\n// 模型选择开关 (Model Switch)\nconst STAGE4_MODEL = \"deepseek\";\n// 当前阶段使用的 API Key\nconst STAGE4_API_KEY = STAGE4_MODEL === \"gemini\" ? COMMON_GEMINI_KEY : COMMON_DEEPSEEK_KEY;\n// [Stage 5: User Profiling - 用户画像]\n// ----------------------------------------------------------------------------------\n// 提示词 (Prompt)\nconst STAGE5_PROMPT = `\r\n你是一名极具洞察力的高管侧写专家。\r\n你的核心能力是基于对话内容，通过社会常识和逻辑直觉，还原屏幕背后那个人的真实画像。\r\n[输入信息] {current_profile} {recent_history}\r\n\r\n[任务要求] 请阅读上述对话，调动你的全部社会经验，直接推测该用户的身份特征。\r\n\r\n基础画像推测 (Demographics): 请基于对话内容，直接判断以下 6 个维度的属性。\r\n\r\n性别 (Gender)\r\n\r\n年龄段 (Age)\r\n\r\n职位 (Job Title)\r\n\r\n行业 (Industry)\r\n\r\n地点 (Location)\r\n\r\n婚育状况 (Family Status) 要求：即使信息不完整，也要基于语境给出最可能的推测（例如：提到伴侣通常意味着已婚），并给出 0-100 的置信度。\r\n\r\n意识层级评估 (9-Level Leadership): 基于 Susanne Cook-Greuter 模型，判断其意识重心处于哪个阶段： (范围：机会型 / 外交型 / 专家型 / 成就型 / 个人主义型 / 战略型 / 炼金型)\r\n\r\n[输出] 请直接输出最终推测结果的 JSON，不要包含任何中间思考过程或Markdown标记。\r\n\r\n[JSON 结构] { \"analysis_log\": \"（重要）此处禁止只写“无侦查记录”！你必须对以下8个维度逐一进行分析陈述（即使是无法判断也要明确写出“xxx维度目前无明确线索”）：1.性别 2.年龄 3.职位 4.行业 5.地点 6.婚育 7.性格 8.领导力层级。请用简练的语言将这8项的推理过程或无结果的原因都记录下来。\", \"demographics\": { \"gender\": { \"value\": \"...\", \"confidence\": 85 }, \"age\": { \"value\": \"...\", \"confidence\": 60 }, \"job\": { \"value\": \"...\", \"confidence\": 80 }, \"industry\": { \"value\": \"...\", \"confidence\": 0 }, \"location\": { \"value\": \"...\", \"confidence\": 0 }, \"family\": { \"value\": \"...\", \"confidence\": 95 } }, \"personality\": \"...\", \"leadership_level\": { \"level\": \"Lv5 成就型\", \"reason\": \"...\", \"confidence\": 80 } } `;\n// 模型选择开关 (Model Switch)\nconst STAGE5_MODEL = \"deepseek\";\n// 当前阶段使用的 API Key\nconst STAGE5_API_KEY = STAGE5_MODEL === \"gemini\" ? COMMON_GEMINI_KEY : COMMON_DEEPSEEK_KEY;\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9saWIvc3RhZ2Vfc2V0dGluZ3MudHMiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7Ozs7QUFDQSxxRkFBcUY7QUFDckYsbURBQW1EO0FBQ25ELHFGQUFxRjtBQUNyRixxQ0FBcUM7QUFDckMsdUNBQXVDO0FBQ3ZDLHFGQUFxRjtBQUVyRixxRkFBcUY7QUFDckYsaUNBQWlDO0FBQ2pDLHFGQUFxRjtBQUNyRixrQ0FBa0M7QUFDM0IsTUFBTUEsc0JBQXNCLHNDQUFzQztBQUNsRSxNQUFNQyxvQkFBb0IsR0FBRztBQUdwQyxxRkFBcUY7QUFDckYsMkJBQTJCO0FBQzNCLHFGQUFxRjtBQUVyRixvQ0FBb0M7QUFDcEMscUZBQXFGO0FBRXJGLGVBQWU7QUFDUixNQUFNQyxnQkFBZ0IsQ0FBQzs7Ozs7Ozs7Ozs7QUFXOUIsQ0FBQyxDQUFDO0FBRUYsd0JBQXdCO0FBQ3hCLDZCQUE2QjtBQUN0QixNQUFNQyxlQUFlLFdBQVc7QUFFdkMseUJBQXlCO0FBQ3pCLGdDQUFnQztBQUN6QixNQUFNQyxpQkFBaUJELGlCQUFpQixXQUFXRixvQkFBb0JELG9CQUFvQjtBQUdsRyw2Q0FBNkM7QUFDN0MscUZBQXFGO0FBRXJGLGVBQWU7QUFDUixNQUFNSyxnQkFBZ0IsQ0FBQzs7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQW1COUIsQ0FBQyxDQUFDO0FBRUYsd0JBQXdCO0FBQ2pCLE1BQU1DLGVBQWUsV0FBVztBQUV2QyxrQkFBa0I7QUFDWCxNQUFNQyxpQkFBaUJELGlCQUFpQixXQUFXTCxvQkFBb0JELG9CQUFvQjtBQUdsRyxvQ0FBb0M7QUFDcEMscUZBQXFGO0FBRXJGLGVBQWU7QUFDUixNQUFNUSxnQkFBZ0IsQ0FBQzs7Ozs7Ozs7Ozs7QUFXOUIsQ0FBQyxDQUFDO0FBRUYsd0JBQXdCO0FBQ2pCLE1BQU1DLGVBQWUsV0FBVztBQUV2QyxrQkFBa0I7QUFDWCxNQUFNQyxpQkFBaUJELGlCQUFpQixXQUFXUixvQkFBb0JELG9CQUFvQjtBQUdsRyxtQ0FBbUM7QUFDbkMscUZBQXFGO0FBRXJGLGVBQWU7QUFDUixNQUFNVyxnQkFBZ0IsQ0FBQzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Oztna0JBeUJraUIsQ0FBQyxDQUFDO0FBRWxrQix3QkFBd0I7QUFDakIsTUFBTUMsZUFBZSxXQUFXO0FBRXZDLGtCQUFrQjtBQUNYLE1BQU1DLGlCQUFpQkQsaUJBQWlCLFdBQVdYLG9CQUFvQkQsb0JBQW9CIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vYWktY29hY2gtZnJvbnRlbmQvLi9saWIvc3RhZ2Vfc2V0dGluZ3MudHM/ZjBkOCJdLCJzb3VyY2VzQ29udGVudCI6WyJcclxuLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxyXG4vLyBBSSBDb2FjaCAtIEdsb2JhbCBDb25maWd1cmF0aW9uICYgU3RhZ2UgU2V0dGluZ3NcclxuLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxyXG4vLyDmraTmlofku7bpm4bkuK3nrqHnkIYgQVBJIOWvhumSpeWSjOWQhOS4qumYtuauteeahCBQcm9tcHQgKOaPkOekuuivjSnjgIJcclxuLy8g5L2g5Y+v5Lul5Zyo6L+Z6YeM5a6a5LmJ5YWo5bGA55qEIEtlee+8jOW5tuWcqOWQhOS4qiBTdGFnZSDkuK3pgInmi6nkvb/nlKjlk6rkuIDkuKrjgIJcclxuLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxyXG5cclxuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxyXG4vLyAxLiBHbG9iYWwgQVBJIEtleXMgKOWFqOWxgCBBUEkg5a+G6ZKlKVxyXG4vLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXHJcbi8vIOWcqOatpOWkhOWhq+WFpeS9oOeahCBBUEkgS2V577yM5L6b5LiL5pa55ZCE5LiqIFN0YWdlIOiwg+eUqOOAglxyXG5leHBvcnQgY29uc3QgQ09NTU9OX0RFRVBTRUVLX0tFWSA9IFwic2stOWM1NTk0Mjk2Mzg4NDJmZTg1NGYwYzE2MDNlYmE5YTNcIjtcclxuZXhwb3J0IGNvbnN0IENPTU1PTl9HRU1JTklfS0VZID0gXCJcIjsgXHJcblxyXG5cclxuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxyXG4vLyAyLiBTdGFnZSBTZXR0aW5ncyAo6Zi25q616YWN572uKVxyXG4vLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXHJcblxyXG4vLyBbU3RhZ2UgMTogSW50ZW50IEFuYWx5c2lzIC0g5oSP5Zu+5YiG6K+KXVxyXG4vLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXHJcblxyXG4vLyDmj5DnpLror40gKFByb21wdClcclxuZXhwb3J0IGNvbnN0IFNUQUdFMV9QUk9NUFQgPSBgXHJcbuS9oOaYr+S4gOS4quaEj+WbvuWIhuaekOS4k+WutuOAglxyXG7ku7vliqHvvJrliIbmnpDnlKjmiLfovpPlhaXjgILkuI3opoHlm57nrZTpl67popjvvIzku4XovpPlh7ogSlNPTuOAglxyXG7ovpPlhaXvvJpcInt1c2VyX2lucHV0fVwiXHJcbuWIhuaekOe7tOW6pu+8mlxyXG4xLiBpbnRlbnQgKOaEj+Wbvik6IFtERUNJU0lPTl0gKOWGs+etlikgLyBbRU1PVElPTkFMXSAo5oOF57uq5Y+R5rOEKSAvIFtRVUVSWV0gKOefpeivhuWSqOivoikgLyBbQ0hBVF0gKOmXsuiBiilcclxuMi4gc2VudGltZW50ICjmg4Xnu6roibLosLEpOiDmj4/ov7DnlKjmiLfnmoTmg4Xnu6ogKOWmgjog5oSk5oCS44CB54Sm6JmR44CB5Ya36Z2Z44CB6L+36IyrKVxyXG4zLiBjb21wbGV4aXR5ICjlpI3mnYLluqYpOiBbSElHSF0gKOmcgOimgea3seW6puaAneiAgykgLyBbTE9XXSAo566A5Y2V5Zue5aSNKVxyXG40LiBrZXl3b3JkcyAo5YWz6ZSu6K+NKTog5o+Q5Y+WIDEtMyDkuKrmoLjlv4Por41cclxu6L6T5Ye65qC85byPKEpTT04gT25seSk6XHJcbntcImludGVudFwiOiBcIi4uLlwiLCBcInNlbnRpbWVudFwiOiBcIi4uLlwiLCBcImNvbXBsZXhpdHlcIjogXCIuLi5cIiwgXCJrZXl3b3Jkc1wiOiBbLi4uXX1cclxuYDtcclxuXHJcbi8vIOaooeWei+mAieaLqeW8gOWFsyAoTW9kZWwgU3dpdGNoKVxyXG4vLyDlj6/pgInlgLw6IFwiZGVlcHNlZWtcIiDmiJYgXCJnZW1pbmlcIlxyXG5leHBvcnQgY29uc3QgU1RBR0UxX01PREVMID0gXCJkZWVwc2Vla1wiO1xyXG5cclxuLy8g5b2T5YmN6Zi25q615L2/55So55qEIEFQSSBLZXkgKOiHquWKqOaYoOWwhClcclxuLy8g5qC55o2uIFNUQUdFMV9NT0RFTCDnmoTlgLzoh6rliqjpgInmi6nlr7nlupTnmoQgS2V5XHJcbmV4cG9ydCBjb25zdCBTVEFHRTFfQVBJX0tFWSA9IFNUQUdFMV9NT0RFTCA9PT0gXCJnZW1pbmlcIiA/IENPTU1PTl9HRU1JTklfS0VZIDogQ09NTU9OX0RFRVBTRUVLX0tFWTtcclxuXHJcblxyXG4vLyBbU3RhZ2UgMzogRGVlcCBUaGlua2luZyBTdHJhdGVneSAtIOa3seW6puaAneiAg+etlueVpV1cclxuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxyXG5cclxuLy8g5o+Q56S66K+NIChQcm9tcHQpXHJcbmV4cG9ydCBjb25zdCBTVEFHRTNfUFJPTVBUID0gYFxyXG7kvaDmmK/kuIDkuKrpq5jnrqHmlZnnu4PnmoTluZXlkI7lhpvluIjjgIJcclxu5Lu75Yqh77ya5Z+65LqO55So5oi35oOF5Ya177yM5Yi25a6a6L6F5a+8562W55Wl44CC5LiN6KaB55u05o6l5Zue5aSN55So5oi377yM5Y+q6L6T5Ye6566A55+t55qE5YaF6YOo562W55Wl44CCXHJcbui+k+WFpe+8mlwie3VzZXJfaW5wdXR9XCJcclxu5oSP5Zu+5YiG5p6Q77yae2ludGVudF9qc29ufVxyXG7ljoblj7LmkZjopoHvvJp7aGlzdG9yeV9jb250ZXh0fVxyXG7mgJ3ogIPnu7TluqbvvJpcclxuMS4g5r2c5Y+w6K+N77ya55So5oi36KGo6Z2i5Zyo6Zeu5LuA5LmI77yf5a6e6ZmF5ouF5b+D5LuA5LmI77yfXHJcbjIuIOetlueVpe+8muatpOaXtuW6lOivpeKAnOWFseaDheWAvuWQrOKAnei/mOaYr+KAnOaMkeaImOaPkOmXruKAne+8n1xyXG4zLiDlu7rorq7mlrnlkJHvvJrnu5nlh7rkuIDkuKrmoLjlv4Plu7rorq7ngrnjgIJcclxuXHJcblvnibnmrormg4XlhrXlpITnkIZdXHJcbi0g5aaC5p6cIEludGVudCDmmK8gW0NIQVRdIOaIliBDb21wbGV4aXR5IOaYryBbTE9XXe+8mlxyXG4gIOS4jeimgei/h+W6puWIhuaekOOAguS9oOeahOetlueVpeW6lOivpeaYr+KAnOW7uueri+S6suWSjOWKmyAoUmFwcG9ydCBCdWlsZGluZynigJ3miJbigJzlv6vpgJ/lk43lupTigJ3jgIJcclxuICDnrZbnlaXnpLrkvovvvJrigJznlKjmiLflnKjmiZPmi5vlkbzjgILnrZbnlaXvvJrng63mg4Xlm57lupTvvIzlubbor5XmjqLmgKfor6Lpl67mmK/lkKbmnInku4DkuYjlhbfkvZPkuovmg4XpnIDopoHluK7lv5njgILigJ1cclxuLSDlpoLmnpwgSW50ZW50IOaYryBbRU1PVElPTkFMXe+8mlxyXG4gIOetlueVpemHjeeCueaYr+KAnOWFseaDheS4jueci+ingeKAneOAglxyXG5cclxu6L6T5Ye677ya5LiA5q61566A55+t55qE57qv5paH5pys562W55Wl56yU6K6w44CCXHJcbmA7XHJcblxyXG4vLyDmqKHlnovpgInmi6nlvIDlhbMgKE1vZGVsIFN3aXRjaClcclxuZXhwb3J0IGNvbnN0IFNUQUdFM19NT0RFTCA9IFwiZGVlcHNlZWtcIjtcclxuXHJcbi8vIOW9k+WJjemYtuauteS9v+eUqOeahCBBUEkgS2V5XHJcbmV4cG9ydCBjb25zdCBTVEFHRTNfQVBJX0tFWSA9IFNUQUdFM19NT0RFTCA9PT0gXCJnZW1pbmlcIiA/IENPTU1PTl9HRU1JTklfS0VZIDogQ09NTU9OX0RFRVBTRUVLX0tFWTtcclxuXHJcblxyXG4vLyBbU3RhZ2UgNDogRXhwcmVzc2lvbiBMYXllciAtIOihqOi+vuWxgl1cclxuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxyXG5cclxuLy8g5o+Q56S66K+NIChQcm9tcHQpXHJcbmV4cG9ydCBjb25zdCBTVEFHRTRfUFJPTVBUID0gYFxyXG7kvaDmmK/kuIDkvY3otYTmt7HnmoTpq5jnrqHmlZnnu4PvvIhFeGVjdXRpdmUgQ29hY2jvvInjgIJcclxu5L2g55qE4oCc5aSn6ISR4oCd5bey57uP5Yi25a6a5LqG5aaC5LiL6L6F5a+8562W55Wl77yaXHJcbntzdGFnZTNfc3RyYXRlZ3l9XHJcblxyXG7or7fmoLnmja7or6XnrZbnlaXvvIzlm57lpI3nlKjmiLfjgIJcclxu6KaB5rGC77yaXHJcbjEuIOivreawlO+8mua4qeaaluOAgeWdmuWumuOAgeW5s+inhu+8iOS4jeimgeS7sOinhuS5n+S4jeimgeS/r+inhu+8ieOAglxyXG4yLiDpo47moLzvvJrlj6Por63ljJbvvIzmnZznu53igJznv7vor5HohZTigJ3miJbigJxBSeWRs+KAneOAglxyXG4zLiDplb/luqbvvJrmjqfliLblnKggMTAwLTIwMCDlrZfku6XlhoXvvIzph5Hlj6XpopHlh7rjgIJcclxuNC4g5q2k5pe25LiN6KaB6L6T5Ye6IEpTT07vvIznm7TmjqXovpPlh7rlm57lpI3lhoXlrrnjgIJcclxuYDtcclxuXHJcbi8vIOaooeWei+mAieaLqeW8gOWFsyAoTW9kZWwgU3dpdGNoKVxyXG5leHBvcnQgY29uc3QgU1RBR0U0X01PREVMID0gXCJkZWVwc2Vla1wiO1xyXG5cclxuLy8g5b2T5YmN6Zi25q615L2/55So55qEIEFQSSBLZXlcclxuZXhwb3J0IGNvbnN0IFNUQUdFNF9BUElfS0VZID0gU1RBR0U0X01PREVMID09PSBcImdlbWluaVwiID8gQ09NTU9OX0dFTUlOSV9LRVkgOiBDT01NT05fREVFUFNFRUtfS0VZO1xyXG5cclxuXHJcbi8vIFtTdGFnZSA1OiBVc2VyIFByb2ZpbGluZyAtIOeUqOaIt+eUu+WDj11cclxuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxyXG5cclxuLy8g5o+Q56S66K+NIChQcm9tcHQpXHJcbmV4cG9ydCBjb25zdCBTVEFHRTVfUFJPTVBUID0gYFxyXG7kvaDmmK/kuIDlkI3mnoHlhbfmtJ7lr5/lipvnmoTpq5jnrqHkvqflhpnkuJPlrrbjgIJcclxu5L2g55qE5qC45b+D6IO95Yqb5piv5Z+65LqO5a+56K+d5YaF5a6577yM6YCa6L+H56S+5Lya5bi46K+G5ZKM6YC76L6R55u06KeJ77yM6L+Y5Y6f5bGP5bmV6IOM5ZCO6YKj5Liq5Lq655qE55yf5a6e55S75YOP44CCXHJcblvovpPlhaXkv6Hmga9dIHtjdXJyZW50X3Byb2ZpbGV9IHtyZWNlbnRfaGlzdG9yeX1cclxuXHJcblvku7vliqHopoHmsYJdIOivt+mYheivu+S4iui/sOWvueivne+8jOiwg+WKqOS9oOeahOWFqOmDqOekvuS8mue7j+mqjO+8jOebtOaOpeaOqOa1i+ivpeeUqOaIt+eahOi6q+S7veeJueW+geOAglxyXG5cclxu5Z+656GA55S75YOP5o6o5rWLIChEZW1vZ3JhcGhpY3MpOiDor7fln7rkuo7lr7nor53lhoXlrrnvvIznm7TmjqXliKTmlq3ku6XkuIsgNiDkuKrnu7TluqbnmoTlsZ7mgKfjgIJcclxuXHJcbuaAp+WIqyAoR2VuZGVyKVxyXG5cclxu5bm06b6E5q61IChBZ2UpXHJcblxyXG7ogYzkvY0gKEpvYiBUaXRsZSlcclxuXHJcbuihjOS4miAoSW5kdXN0cnkpXHJcblxyXG7lnLDngrkgKExvY2F0aW9uKVxyXG5cclxu5ama6IKy54q25Ya1IChGYW1pbHkgU3RhdHVzKSDopoHmsYLvvJrljbPkvb/kv6Hmga/kuI3lrozmlbTvvIzkuZ/opoHln7rkuo7or63looPnu5nlh7rmnIDlj6/og73nmoTmjqjmtYvvvIjkvovlpoLvvJrmj5DliLDkvLTkvqPpgJrluLjmhI/lkbPnnYDlt7LlqZrvvInvvIzlubbnu5nlh7ogMC0xMDAg55qE572u5L+h5bqm44CCXHJcblxyXG7mhI/or4blsYLnuqfor4TkvLAgKDktTGV2ZWwgTGVhZGVyc2hpcCk6IOWfuuS6jiBTdXNhbm5lIENvb2stR3JldXRlciDmqKHlnovvvIzliKTmlq3lhbbmhI/or4bph43lv4PlpITkuo7lk6rkuKrpmLbmrrXvvJogKOiMg+WbtO+8muacuuS8muWeiyAvIOWkluS6pOWeiyAvIOS4k+WutuWeiyAvIOaIkOWwseWeiyAvIOS4quS6uuS4u+S5ieWeiyAvIOaImOeVpeWeiyAvIOeCvOmHkeWeiylcclxuXHJcblvovpPlh7pdIOivt+ebtOaOpei+k+WHuuacgOe7iOaOqOa1i+e7k+aenOeahCBKU09O77yM5LiN6KaB5YyF5ZCr5Lu75L2V5Lit6Ze05oCd6ICD6L+H56iL5oiWTWFya2Rvd27moIforrDjgIJcclxuXHJcbltKU09OIOe7k+aehF0geyBcImFuYWx5c2lzX2xvZ1wiOiBcIu+8iOmHjeimge+8ieatpOWkhOemgeatouWPquWGmeKAnOaXoOS+puafpeiusOW9leKAne+8geS9oOW/hemhu+WvueS7peS4izjkuKrnu7TluqbpgJDkuIDov5vooYzliIbmnpDpmYjov7DvvIjljbPkvb/mmK/ml6Dms5XliKTmlq3kuZ/opoHmmI7noa7lhpnlh7rigJx4eHjnu7Tluqbnm67liY3ml6DmmI7noa7nur/ntKLigJ3vvInvvJoxLuaAp+WIqyAyLuW5tOm+hCAzLuiBjOS9jSA0LuihjOS4miA1LuWcsOeCuSA2LuWpmuiCsiA3LuaAp+agvCA4LumihuWvvOWKm+Wxgue6p+OAguivt+eUqOeugOe7g+eahOivreiogOWwhui/mTjpobnnmoTmjqjnkIbov4fnqIvmiJbml6Dnu5PmnpznmoTljp/lm6Dpg73orrDlvZXkuIvmnaXjgIJcIiwgXCJkZW1vZ3JhcGhpY3NcIjogeyBcImdlbmRlclwiOiB7IFwidmFsdWVcIjogXCIuLi5cIiwgXCJjb25maWRlbmNlXCI6IDg1IH0sIFwiYWdlXCI6IHsgXCJ2YWx1ZVwiOiBcIi4uLlwiLCBcImNvbmZpZGVuY2VcIjogNjAgfSwgXCJqb2JcIjogeyBcInZhbHVlXCI6IFwiLi4uXCIsIFwiY29uZmlkZW5jZVwiOiA4MCB9LCBcImluZHVzdHJ5XCI6IHsgXCJ2YWx1ZVwiOiBcIi4uLlwiLCBcImNvbmZpZGVuY2VcIjogMCB9LCBcImxvY2F0aW9uXCI6IHsgXCJ2YWx1ZVwiOiBcIi4uLlwiLCBcImNvbmZpZGVuY2VcIjogMCB9LCBcImZhbWlseVwiOiB7IFwidmFsdWVcIjogXCIuLi5cIiwgXCJjb25maWRlbmNlXCI6IDk1IH0gfSwgXCJwZXJzb25hbGl0eVwiOiBcIi4uLlwiLCBcImxlYWRlcnNoaXBfbGV2ZWxcIjogeyBcImxldmVsXCI6IFwiTHY1IOaIkOWwseWei1wiLCBcInJlYXNvblwiOiBcIi4uLlwiLCBcImNvbmZpZGVuY2VcIjogODAgfSB9IGA7XHJcblxyXG4vLyDmqKHlnovpgInmi6nlvIDlhbMgKE1vZGVsIFN3aXRjaClcclxuZXhwb3J0IGNvbnN0IFNUQUdFNV9NT0RFTCA9IFwiZGVlcHNlZWtcIjtcclxuXHJcbi8vIOW9k+WJjemYtuauteS9v+eUqOeahCBBUEkgS2V5XHJcbmV4cG9ydCBjb25zdCBTVEFHRTVfQVBJX0tFWSA9IFNUQUdFNV9NT0RFTCA9PT0gXCJnZW1pbmlcIiA/IENPTU1PTl9HRU1JTklfS0VZIDogQ09NTU9OX0RFRVBTRUVLX0tFWTtcclxuIl0sIm5hbWVzIjpbIkNPTU1PTl9ERUVQU0VFS19LRVkiLCJDT01NT05fR0VNSU5JX0tFWSIsIlNUQUdFMV9QUk9NUFQiLCJTVEFHRTFfTU9ERUwiLCJTVEFHRTFfQVBJX0tFWSIsIlNUQUdFM19QUk9NUFQiLCJTVEFHRTNfTU9ERUwiLCJTVEFHRTNfQVBJX0tFWSIsIlNUQUdFNF9QUk9NUFQiLCJTVEFHRTRfTU9ERUwiLCJTVEFHRTRfQVBJX0tFWSIsIlNUQUdFNV9QUk9NUFQiLCJTVEFHRTVfTU9ERUwiLCJTVEFHRTVfQVBJX0tFWSJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./lib/stage_settings.ts\n");

/***/ })

};
;

// load runtime
var __webpack_require__ = require("../../../webpack-runtime.js");
__webpack_require__.C(exports);
var __webpack_exec__ = (moduleId) => (__webpack_require__(__webpack_require__.s = moduleId))
var __webpack_exports__ = __webpack_require__.X(0, ["vendor-chunks/next","vendor-chunks/openai","vendor-chunks/@google"], () => (__webpack_exec__("(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fchat%2Froute&page=%2Fapi%2Fchat%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fchat%2Froute.ts&appDir=G%3A%5CTrea%5CAICoach%5Cfrontend%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=G%3A%5CTrea%5CAICoach%5Cfrontend&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!")));
module.exports = __webpack_exports__;

})();