"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(() => {
var exports = {};
exports.id = "app/api/chat/route";
exports.ids = ["app/api/chat/route"];
exports.modules = {

/***/ "next/dist/compiled/next-server/app-route.runtime.dev.js":
/*!**************************************************************************!*\
  !*** external "next/dist/compiled/next-server/app-route.runtime.dev.js" ***!
  \**************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/app-route.runtime.dev.js");

/***/ }),

/***/ "node:sqlite":
/*!******************************!*\
  !*** external "node:sqlite" ***!
  \******************************/
/***/ ((module) => {

module.exports = require("node:sqlite");

/***/ }),

/***/ "path":
/*!***********************!*\
  !*** external "path" ***!
  \***********************/
/***/ ((module) => {

module.exports = require("path");

/***/ }),

/***/ "(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fchat%2Froute&page=%2Fapi%2Fchat%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fchat%2Froute.ts&appDir=G%3A%5CTrea%5CAICoach%5Cfrontend%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=G%3A%5CTrea%5CAICoach%5Cfrontend&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!":
/*!********************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fchat%2Froute&page=%2Fapi%2Fchat%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fchat%2Froute.ts&appDir=G%3A%5CTrea%5CAICoach%5Cfrontend%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=G%3A%5CTrea%5CAICoach%5Cfrontend&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D! ***!
  \********************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   headerHooks: () => (/* binding */ headerHooks),\n/* harmony export */   originalPathname: () => (/* binding */ originalPathname),\n/* harmony export */   patchFetch: () => (/* binding */ patchFetch),\n/* harmony export */   requestAsyncStorage: () => (/* binding */ requestAsyncStorage),\n/* harmony export */   routeModule: () => (/* binding */ routeModule),\n/* harmony export */   serverHooks: () => (/* binding */ serverHooks),\n/* harmony export */   staticGenerationAsyncStorage: () => (/* binding */ staticGenerationAsyncStorage),\n/* harmony export */   staticGenerationBailout: () => (/* binding */ staticGenerationBailout)\n/* harmony export */ });\n/* harmony import */ var next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/dist/server/future/route-modules/app-route/module.compiled */ \"(rsc)/./node_modules/next/dist/server/future/route-modules/app-route/module.compiled.js\");\n/* harmony import */ var next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! next/dist/server/future/route-kind */ \"(rsc)/./node_modules/next/dist/server/future/route-kind.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! next/dist/server/lib/patch-fetch */ \"(rsc)/./node_modules/next/dist/server/lib/patch-fetch.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var G_Trea_AICoach_frontend_app_api_chat_route_ts__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./app/api/chat/route.ts */ \"(rsc)/./app/api/chat/route.ts\");\n\n\n\n\n// We inject the nextConfigOutput here so that we can use them in the route\n// module.\nconst nextConfigOutput = \"\"\nconst routeModule = new next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__.AppRouteRouteModule({\n    definition: {\n        kind: next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__.RouteKind.APP_ROUTE,\n        page: \"/api/chat/route\",\n        pathname: \"/api/chat\",\n        filename: \"route\",\n        bundlePath: \"app/api/chat/route\"\n    },\n    resolvedPagePath: \"G:\\\\Trea\\\\AICoach\\\\frontend\\\\app\\\\api\\\\chat\\\\route.ts\",\n    nextConfigOutput,\n    userland: G_Trea_AICoach_frontend_app_api_chat_route_ts__WEBPACK_IMPORTED_MODULE_3__\n});\n// Pull out the exports that we need to expose from the module. This should\n// be eliminated when we've moved the other routes to the new format. These\n// are used to hook into the route.\nconst { requestAsyncStorage, staticGenerationAsyncStorage, serverHooks, headerHooks, staticGenerationBailout } = routeModule;\nconst originalPathname = \"/api/chat/route\";\nfunction patchFetch() {\n    return (0,next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__.patchFetch)({\n        serverHooks,\n        staticGenerationAsyncStorage\n    });\n}\n\n\n//# sourceMappingURL=app-route.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvbmV4dC9kaXN0L2J1aWxkL3dlYnBhY2svbG9hZGVycy9uZXh0LWFwcC1sb2FkZXIuanM/bmFtZT1hcHAlMkZhcGklMkZjaGF0JTJGcm91dGUmcGFnZT0lMkZhcGklMkZjaGF0JTJGcm91dGUmYXBwUGF0aHM9JnBhZ2VQYXRoPXByaXZhdGUtbmV4dC1hcHAtZGlyJTJGYXBpJTJGY2hhdCUyRnJvdXRlLnRzJmFwcERpcj1HJTNBJTVDVHJlYSU1Q0FJQ29hY2glNUNmcm9udGVuZCU1Q2FwcCZwYWdlRXh0ZW5zaW9ucz10c3gmcGFnZUV4dGVuc2lvbnM9dHMmcGFnZUV4dGVuc2lvbnM9anN4JnBhZ2VFeHRlbnNpb25zPWpzJnJvb3REaXI9RyUzQSU1Q1RyZWElNUNBSUNvYWNoJTVDZnJvbnRlbmQmaXNEZXY9dHJ1ZSZ0c2NvbmZpZ1BhdGg9dHNjb25maWcuanNvbiZiYXNlUGF0aD0mYXNzZXRQcmVmaXg9Jm5leHRDb25maWdPdXRwdXQ9JnByZWZlcnJlZFJlZ2lvbj0mbWlkZGxld2FyZUNvbmZpZz1lMzAlM0QhIiwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7Ozs7O0FBQXNHO0FBQ3ZDO0FBQ2M7QUFDSztBQUNsRjtBQUNBO0FBQ0E7QUFDQSx3QkFBd0IsZ0hBQW1CO0FBQzNDO0FBQ0EsY0FBYyx5RUFBUztBQUN2QjtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0EsWUFBWTtBQUNaLENBQUM7QUFDRDtBQUNBO0FBQ0E7QUFDQSxRQUFRLHVHQUF1RztBQUMvRztBQUNBO0FBQ0EsV0FBVyw0RUFBVztBQUN0QjtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQzZKOztBQUU3SiIsInNvdXJjZXMiOlsid2VicGFjazovL2FpLWNvYWNoLWZyb250ZW5kLz8wYzU1Il0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IEFwcFJvdXRlUm91dGVNb2R1bGUgfSBmcm9tIFwibmV4dC9kaXN0L3NlcnZlci9mdXR1cmUvcm91dGUtbW9kdWxlcy9hcHAtcm91dGUvbW9kdWxlLmNvbXBpbGVkXCI7XG5pbXBvcnQgeyBSb3V0ZUtpbmQgfSBmcm9tIFwibmV4dC9kaXN0L3NlcnZlci9mdXR1cmUvcm91dGUta2luZFwiO1xuaW1wb3J0IHsgcGF0Y2hGZXRjaCBhcyBfcGF0Y2hGZXRjaCB9IGZyb20gXCJuZXh0L2Rpc3Qvc2VydmVyL2xpYi9wYXRjaC1mZXRjaFwiO1xuaW1wb3J0ICogYXMgdXNlcmxhbmQgZnJvbSBcIkc6XFxcXFRyZWFcXFxcQUlDb2FjaFxcXFxmcm9udGVuZFxcXFxhcHBcXFxcYXBpXFxcXGNoYXRcXFxccm91dGUudHNcIjtcbi8vIFdlIGluamVjdCB0aGUgbmV4dENvbmZpZ091dHB1dCBoZXJlIHNvIHRoYXQgd2UgY2FuIHVzZSB0aGVtIGluIHRoZSByb3V0ZVxuLy8gbW9kdWxlLlxuY29uc3QgbmV4dENvbmZpZ091dHB1dCA9IFwiXCJcbmNvbnN0IHJvdXRlTW9kdWxlID0gbmV3IEFwcFJvdXRlUm91dGVNb2R1bGUoe1xuICAgIGRlZmluaXRpb246IHtcbiAgICAgICAga2luZDogUm91dGVLaW5kLkFQUF9ST1VURSxcbiAgICAgICAgcGFnZTogXCIvYXBpL2NoYXQvcm91dGVcIixcbiAgICAgICAgcGF0aG5hbWU6IFwiL2FwaS9jaGF0XCIsXG4gICAgICAgIGZpbGVuYW1lOiBcInJvdXRlXCIsXG4gICAgICAgIGJ1bmRsZVBhdGg6IFwiYXBwL2FwaS9jaGF0L3JvdXRlXCJcbiAgICB9LFxuICAgIHJlc29sdmVkUGFnZVBhdGg6IFwiRzpcXFxcVHJlYVxcXFxBSUNvYWNoXFxcXGZyb250ZW5kXFxcXGFwcFxcXFxhcGlcXFxcY2hhdFxcXFxyb3V0ZS50c1wiLFxuICAgIG5leHRDb25maWdPdXRwdXQsXG4gICAgdXNlcmxhbmRcbn0pO1xuLy8gUHVsbCBvdXQgdGhlIGV4cG9ydHMgdGhhdCB3ZSBuZWVkIHRvIGV4cG9zZSBmcm9tIHRoZSBtb2R1bGUuIFRoaXMgc2hvdWxkXG4vLyBiZSBlbGltaW5hdGVkIHdoZW4gd2UndmUgbW92ZWQgdGhlIG90aGVyIHJvdXRlcyB0byB0aGUgbmV3IGZvcm1hdC4gVGhlc2Vcbi8vIGFyZSB1c2VkIHRvIGhvb2sgaW50byB0aGUgcm91dGUuXG5jb25zdCB7IHJlcXVlc3RBc3luY1N0b3JhZ2UsIHN0YXRpY0dlbmVyYXRpb25Bc3luY1N0b3JhZ2UsIHNlcnZlckhvb2tzLCBoZWFkZXJIb29rcywgc3RhdGljR2VuZXJhdGlvbkJhaWxvdXQgfSA9IHJvdXRlTW9kdWxlO1xuY29uc3Qgb3JpZ2luYWxQYXRobmFtZSA9IFwiL2FwaS9jaGF0L3JvdXRlXCI7XG5mdW5jdGlvbiBwYXRjaEZldGNoKCkge1xuICAgIHJldHVybiBfcGF0Y2hGZXRjaCh7XG4gICAgICAgIHNlcnZlckhvb2tzLFxuICAgICAgICBzdGF0aWNHZW5lcmF0aW9uQXN5bmNTdG9yYWdlXG4gICAgfSk7XG59XG5leHBvcnQgeyByb3V0ZU1vZHVsZSwgcmVxdWVzdEFzeW5jU3RvcmFnZSwgc3RhdGljR2VuZXJhdGlvbkFzeW5jU3RvcmFnZSwgc2VydmVySG9va3MsIGhlYWRlckhvb2tzLCBzdGF0aWNHZW5lcmF0aW9uQmFpbG91dCwgb3JpZ2luYWxQYXRobmFtZSwgcGF0Y2hGZXRjaCwgIH07XG5cbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWFwcC1yb3V0ZS5qcy5tYXAiXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fchat%2Froute&page=%2Fapi%2Fchat%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fchat%2Froute.ts&appDir=G%3A%5CTrea%5CAICoach%5Cfrontend%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=G%3A%5CTrea%5CAICoach%5Cfrontend&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!\n");

/***/ }),

/***/ "(rsc)/./app/api/chat/route.ts":
/*!*******************************!*\
  !*** ./app/api/chat/route.ts ***!
  \*******************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   POST: () => (/* binding */ POST)\n/* harmony export */ });\n/* harmony import */ var next_dist_server_web_exports_next_response__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/dist/server/web/exports/next-response */ \"(rsc)/./node_modules/next/dist/server/web/exports/next-response.js\");\n/* harmony import */ var _lib_pipeline__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @/lib/pipeline */ \"(rsc)/./lib/pipeline.ts\");\n/* harmony import */ var _lib_db__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @/lib/db */ \"(rsc)/./lib/db.ts\");\n/* harmony import */ var _lib_executive_tools__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @/lib/executive_tools */ \"(rsc)/./lib/executive_tools.ts\");\n\n\n\n\nconst growTemplate = `<!DOCTYPE html>\n<html lang=\"zh-CN\">\n<head>\n    <meta charset=\"UTF-8\">\n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n    <title>GROW Model - Executive Partner</title>\n    <script src=\"https://cdnjs.cloudflare.com/ajax/libs/dom-to-image-more/3.3.0/dom-to-image-more.min.js\"></script>\n    <style>\n        :root {\n            --primary-bg: #191b4d; \n            --accent-color: #fccb2f;\n            --page-bg: #fbf7ef;\n            --text-main: #2d3748;\n            --card-shadow: rgba(0,0,0,0.1);\n            --font-family: \"PingFang SC\", \"Microsoft YaHei\", sans-serif;\n            --body-font-size: 0.88rem;\n            --line-height: 1.6;\n            --body-font-weight: 400;\n        }\n\n        .theme-emerald {\n            --primary-bg: #064e3b;\n            --page-bg: #f0fdf4;\n            --accent-color: #fbbf24;\n        }\n\n        .theme-slate {\n            --primary-bg: #1e293b;\n            --page-bg: #f8fafc;\n            --accent-color: #94a3b8;\n        }\n\n        .theme-red {\n            --primary-bg: #bd1e2d;\n            --page-bg: #ffffff;\n            --accent-color: #4a5568; \n            --text-main: #1a202c;\n        }\n\n        .font-song {\n            --font-family: \"SimSun\", \"STSong\", serif;\n            --body-font-weight: 500;\n        }\n\n        .font-hei {\n            --font-family: \"PingFang SC\", \"Microsoft YaHei\", sans-serif;\n        }\n\n        * {\n            box-sizing: border-box;\n            margin: 0;\n            padding: 0;\n            -webkit-tap-highlight-color: transparent;\n        }\n\n        body {\n            font-family: var(--font-family);\n            font-weight: var(--body-font-weight);\n            background-color: #e2e8f0;\n            display: flex;\n            flex-direction: column;\n            align-items: center;\n            min-height: 100vh;\n            padding: 0;\n        }\n\n        body.exporting .header h1::after,\n        body.exporting .footer {\n            background: none !important;\n        }\n\n        body.exporting * {\n            background-image: none !important;\n        }\n\n        .toolbar {\n            width: 100%;\n            max-width: 414px;\n            background: rgba(255, 255, 255, 0.95);\n            backdrop-filter: blur(5px);\n            padding: 12px;\n            display: flex;\n            flex-wrap: wrap;\n            gap: 10px;\n            justify-content: center;\n            position: sticky;\n            top: 0;\n            z-index: 100;\n            box-shadow: 0 2px 10px rgba(0,0,0,0.05);\n            border-bottom: 1px solid #cbd5e0;\n        }\n\n        .tool-group {\n            display: flex;\n            align-items: center;\n            gap: 5px;\n            font-size: 0.7rem;\n            color: #4a5568;\n        }\n\n        .toolbar button, .toolbar select, .toolbar input[type=\"range\"] {\n            padding: 6px 8px;\n            font-size: 0.7rem;\n            cursor: pointer;\n            border: 1px solid #cbd5e0;\n            background: #fff;\n            border-radius: 4px;\n            color: #4a5568;\n            outline: none;\n        }\n\n        .toolbar input[type=\"range\"] {\n            width: 80px;\n            padding: 0;\n            cursor: ew-resize;\n        }\n\n        .toolbar .btn-save {\n            background: #2d3748;\n            color: white;\n            border: none;\n            padding: 6px 12px;\n        }\n\n        .card-wrapper {\n            padding: 15px 0 30px;\n            width: 100%;\n            display: flex;\n            justify-content: center;\n        }\n\n        .card {\n            background-color: var(--page-bg);\n            width: 100%;\n            max-width: 414px;\n            display: flex;\n            flex-direction: column;\n            box-shadow: 0 10px 40px var(--card-shadow);\n            position: relative;\n            transition: all 0.4s cubic-bezier(0.165, 0.84, 0.44, 1);\n        }\n\n        .header {\n            background-color: var(--primary-bg);\n            padding: 25px 20px 15px;\n            color: #ffffff;\n            position: relative;\n            display: flex;\n            flex-direction: column;\n            justify-content: flex-end;\n            transition: background-color 0.4s;\n        }\n\n        .ep-tag {\n            position: absolute;\n            top: 20px;\n            right: 20px;\n            font-size: 0.6rem;\n            letter-spacing: 2px;\n            text-transform: uppercase;\n            color: var(--accent-color);\n            opacity: 0.9;\n        }\n\n        .header h1 {\n            font-size: 1.3rem;\n            font-weight: 700;\n            letter-spacing: 1px;\n            display: flex;\n            align-items: center;\n            gap: 12px;\n        }\n\n        .header h1::after {\n            content: \"\";\n            flex: 1;\n            min-width: 24px;\n            height: 1px;\n            background: linear-gradient(to right, var(--accent-color), transparent);\n            opacity: 0.4;\n        }\n\n        .container {\n            padding: 20px 15px 5px;\n        }\n\n        .step-block {\n            margin-bottom: 16px;\n            display: flex;\n            gap: 12px;\n        }\n\n        .step-aside {\n            flex-shrink: 0;\n            width: 36px;\n            text-align: center;\n        }\n\n        .step-letter {\n            font-family: \"Georgia\", serif;\n            font-size: 1.8rem;\n            font-weight: 900;\n            color: var(--primary-bg);\n            line-height: 1;\n            transition: color 0.4s;\n        }\n\n        .step-main {\n            flex-grow: 1;\n        }\n\n        .step-title {\n            font-size: 0.9rem;\n            font-weight: 700;\n            color: var(--primary-bg);\n            margin-bottom: 5px;\n            text-transform: uppercase;\n            transition: color 0.4s;\n        }\n\n        .step-content {\n            background: white;\n            padding: 12px 14px;\n            border-radius: 2px;\n            font-size: var(--body-font-size);\n            line-height: var(--line-height);\n            color: var(--text-main);\n            border-left: 3px solid var(--primary-bg);\n            box-shadow: 0 2px 8px rgba(0,0,0,0.03);\n            outline: none;\n            transition: border-color 0.4s, line-height 0.2s;\n        }\n\n        .step-content:focus {\n            background: #fffdf9;\n            border-left-color: var(--accent-color);\n        }\n\n        .list-item {\n            margin-bottom: 4px;\n            padding-left: 12px;\n            position: relative;\n        }\n\n        .list-item::before {\n            content: \"\";\n            position: absolute;\n            left: 0;\n            top: calc(0.5em * var(--line-height));\n            width: 4px;\n            height: 1px;\n            background-color: var(--accent-color);\n        }\n\n        .highlight-text {\n            color: var(--primary-bg);\n            font-weight: 600;\n        }\n\n        .footer {\n            padding: 20px;\n            text-align: center;\n            background: linear-gradient(to bottom, transparent, rgba(0,0,0,0.01));\n        }\n\n        .slogan-cn {\n            font-size: 0.85rem;\n            color: var(--primary-bg);\n            font-weight: 600;\n            letter-spacing: 3px;\n            margin-bottom: 4px;\n            outline: none;\n            transition: color 0.4s;\n        }\n\n        .footer-sub {\n            font-size: 0.55rem;\n            color: var(--text-muted);\n            letter-spacing: 1px;\n            text-transform: uppercase;\n            outline: none;\n        }\n\n        #export-loading {\n            display: none;\n            position: fixed;\n            top: 0; left: 0; width: 100%; height: 100%;\n            background: rgba(255,255,255,0.9);\n            z-index: 1000;\n            justify-content: center;\n            align-items: center;\n            font-weight: 500;\n            color: var(--primary-bg);\n        }\n    </style>\n</head>\n<body class=\"font-hei\">\n\n    <div id=\"export-loading\">正在准备高清卡片...</div>\n\n    <div class=\"toolbar\" id=\"control-panel\">\n        <select id=\"font-select\" onchange=\"changeFont(this.value)\">\n            <option value=\"hei\">现代黑体</option>\n            <option value=\"song\">经典宋体</option>\n        </select>\n        \n        <div class=\"tool-group\">\n            <span>字号</span>\n            <button onclick=\"changeFontSize(1)\">+</button>\n            <button onclick=\"changeFontSize(-1)\">-</button>\n        </div>\n\n        <div class=\"tool-group\">\n            <span>间距</span>\n            <input type=\"range\" id=\"lh-range\" min=\"1.2\" max=\"2.2\" step=\"0.1\" value=\"1.6\" oninput=\"changeLineHeight(this.value)\">\n        </div>\n\n        <button onclick=\"nextTheme()\">切换配色</button>\n        <button class=\"btn-save\" onclick=\"saveAsImage()\">存为图片</button>\n    </div>\n\n    <div class=\"card-wrapper\" id=\"capture-area\">\n        <div class=\"card\" id=\"main-card\">\n            <header class=\"header\">\n                <span class=\"ep-tag\" contenteditable=\"true\">Executive Partner</span>\n                <h1 contenteditable=\"true\">GROW COACHING</h1>\n            </header>\n\n            <main class=\"container\">\n                <section class=\"step-block\">\n                    <div class=\"step-aside\">\n                        <div class=\"step-letter\">G</div>\n                    </div>\n                    <div class=\"step-main\">\n                        <h2 class=\"step-title\" contenteditable=\"true\">Goal / 目标确立</h2>\n                        <div class=\"step-content\" contenteditable=\"true\">\n                            {{GOAL}}\n                        </div>\n                    </div>\n                </section>\n\n                <section class=\"step-block\">\n                    <div class=\"step-aside\">\n                        <div class=\"step-letter\" style=\"margin-left: -2px;\">R</div>\n                    </div>\n                    <div class=\"step-main\">\n                        <h2 class=\"step-title\" contenteditable=\"true\">Reality / 现状分析</h2>\n                        <div class=\"step-content\" contenteditable=\"true\">\n                            {{REALITY_LIST}}\n                        </div>\n                    </div>\n                </section>\n\n                <section class=\"step-block\">\n                    <div class=\"step-aside\">\n                        <div class=\"step-letter\">O</div>\n                    </div>\n                    <div class=\"step-main\">\n                        <h2 class=\"step-title\" contenteditable=\"true\">Options / 方案选择</h2>\n                        <div class=\"step-content\" contenteditable=\"true\">\n                            {{OPTIONS_LIST}}\n                        </div>\n                    </div>\n                </section>\n\n                <section class=\"step-block\">\n                    <div class=\"step-aside\">\n                        <div class=\"step-letter\" style=\"margin-left: -2px;\">W</div>\n                    </div>\n                    <div class=\"step-main\">\n                        <h2 class=\"step-title\" contenteditable=\"true\">Will / 意愿行动</h2>\n                        <div class=\"step-content\" contenteditable=\"true\">\n                            {{WILL_LIST}}\n                        </div>\n                    </div>\n                </section>\n            </main>\n\n            <footer class=\"footer\">\n                <div class=\"slogan-cn\" contenteditable=\"true\">{{SLOGAN_CN}}</div>\n                <div class=\"footer-sub\" contenteditable=\"true\">{{FOOTER_SUB}}</div>\n            </footer>\n        </div>\n    </div>\n\n    <script>\n        function changeFont(val) {\n            document.body.className = val === 'song' ? 'font-song' : 'font-hei';\n        }\n\n        let currentSize = 0.88;\n        function changeFontSize(delta) {\n            currentSize = Math.max(0.7, Math.min(1.2, currentSize + delta * 0.05));\n            document.documentElement.style.setProperty('--body-font-size', currentSize + 'rem');\n        }\n\n        function changeLineHeight(val) {\n            document.documentElement.style.setProperty('--line-height', val);\n        }\n\n        const themes = ['', 'theme-emerald', 'theme-slate', 'theme-red'];\n        let currentThemeIndex = 0;\n        function nextTheme() {\n            const card = document.getElementById('main-card');\n            card.classList.remove(...themes.filter(t => t !== ''));\n            currentThemeIndex = (currentThemeIndex + 1) % themes.length;\n            if (themes[currentThemeIndex]) {\n                card.classList.add(themes[currentThemeIndex]);\n            }\n        }\n\n            // 最终方案：使用 dom-to-image-more (基于 SVG foreignObject)\n            // 彻底避开 html2canvas 的 createPattern 布局塌陷问题\n            const saveAsImage = async () => {\n                const loading = document.getElementById('export-loading');\n                const card = document.getElementById('main-card');\n                // @ts-ignore\n                if (!card || !window.domtoimage) {\n                    console.error(\"组件未加载或库缺失\");\n                    return;\n                }\n\n                loading.style.display = 'flex';\n                \n                // 1. 临时锁定尺寸以保证导出清晰度 (2x)\n                const scale = 2;\n                const originalWidth = card.style.width;\n                const originalHeight = card.style.height;\n                const originalTransform = card.style.transform;\n                \n                // 强制设置一个固定宽度进行渲染，防止移动端布局差异\n                // 414px 是标准移动端宽度，导出时放大2倍\n                card.style.width = '414px';\n                card.style.height = 'auto'; // 让高度自适应\n                card.style.transform = 'none';\n                card.style.margin = '0'; // 移除可能的外边距影响\n                \n                // 移除阴影，防止导出时包含半透明阴影区域，导致用户觉得有\"透明背景\"\n                const originalBoxShadow = card.style.boxShadow;\n                card.style.boxShadow = 'none';\n\n                try {\n                    // 2. 稍微延迟等待 DOM 重排\n                    await new Promise(resolve => setTimeout(resolve, 100));\n\n                    // @ts-ignore\n                    const dataUrl = await window.domtoimage.toPng(card, {\n                        width: 414 * scale,\n                        height: card.offsetHeight * scale,\n                        style: {\n                            transform: 'scale(' + scale + ')',\n                            transformOrigin: 'top left',\n                            width: '414px',\n                            height: 'auto',\n                            'background-color': '#fbf7ef', // 强制设置背景色，防止出现透明格子\n                            'box-shadow': 'none', // 确保导出图像无阴影\n                            'margin': '0'\n                        },\n                        bgcolor: '#fbf7ef' // dom-to-image 顶层配置，兜底填充背景色\n                    });\n\n                    const link = document.createElement('a');\n                    link.download = 'Executive_GROW_Card.png';\n                    link.href = dataUrl;\n                    link.click();\n                } catch (err) {\n                    console.error(\"dom-to-image 导出失败:\", err);\n                    alert(\"导出失败，请重试\");\n                } finally {\n                    // 3. 恢复原始样式\n                    card.style.width = originalWidth;\n                    card.style.height = originalHeight;\n                    card.style.transform = originalTransform;\n                    card.style.margin = '';\n                    card.style.boxShadow = originalBoxShadow;\n                    loading.style.display = 'none';\n                }\n            };\n    </script>\n\n</body>\n</html>`;\nconst cleanJsonBlock = (text)=>{\n    const jsonFence = text.match(/```json\\s*([\\s\\S]*?)```/i);\n    if (jsonFence) return jsonFence[1].trim();\n    const genericFence = text.match(/```([\\s\\S]*?)```/);\n    if (genericFence) return genericFence[1].trim();\n    return text.trim();\n};\nconst buildList = (items)=>items.map((item)=>`<div class=\"list-item\">${item}</div>`).join(\"\\n\");\nconst buildGrowCardHtml = (payload)=>{\n    const goal = payload.goal || \"在未来三个月内，明确目标并建立可执行路径。\";\n    const realityList = buildList(payload.reality?.slice(0, 3) || []);\n    const optionsList = buildList(payload.options?.slice(0, 3) || []);\n    const willList = buildList(payload.will?.slice(0, 3) || []);\n    const sloganCn = payload.sloganCn || \"见微知著，引领战略全局\";\n    const footerSub = payload.footerSub || \"STRATEGIC LEADERSHIP • EXECUTIVE COACHING CARD\";\n    return growTemplate.replace(\"{{GOAL}}\", goal).replace(\"{{REALITY_LIST}}\", realityList).replace(\"{{OPTIONS_LIST}}\", optionsList).replace(\"{{WILL_LIST}}\", willList).replace(\"{{SLOGAN_CN}}\", sloganCn).replace(\"{{FOOTER_SUB}}\", footerSub);\n};\nasync function POST(request) {\n    try {\n        const { message, conversationId, toolId, toolTitle } = await request.json();\n        if (!message || !conversationId) {\n            return next_dist_server_web_exports_next_response__WEBPACK_IMPORTED_MODULE_0__[\"default\"].json({\n                error: \"Message and conversationId are required\"\n            }, {\n                status: 400\n            });\n        }\n        // 1. Save User Message to DB\n        try {\n            (0,_lib_db__WEBPACK_IMPORTED_MODULE_2__.saveMessageToDb)(conversationId, \"user\", message);\n            if (toolId && toolTitle) {\n                const existing = (0,_lib_db__WEBPACK_IMPORTED_MODULE_2__.getMessagesFromDb)(conversationId, 5);\n                if (existing.length === 1 && existing[0].role === \"user\") {\n                    (0,_lib_db__WEBPACK_IMPORTED_MODULE_2__.updateConversationTitle)(conversationId, toolTitle);\n                    (0,_lib_db__WEBPACK_IMPORTED_MODULE_2__.updateConversationTool)(conversationId, toolId);\n                }\n            }\n        } catch (dbError) {\n            console.error(\"DB Save Error (User):\", dbError);\n        // Continue execution even if DB save fails, to provide reply\n        }\n        // 2. Stage 2: Retrieve Memory\n        const memory = (0,_lib_pipeline__WEBPACK_IMPORTED_MODULE_1__.getRecentHistory)(conversationId);\n        // Parallel Execution: Stage 1 (Analysis) & Stage 5 (Profile)\n        // Use Promise.allSettled to ensure one failure doesn't stop the other\n        const [analysisResult, profileResult] = await Promise.allSettled([\n            (0,_lib_pipeline__WEBPACK_IMPORTED_MODULE_1__.stage1_analyze)(message),\n            (0,_lib_pipeline__WEBPACK_IMPORTED_MODULE_1__.stage5Profile)(memory)\n        ]);\n        // Handle Stage 1 Result\n        const analysis = analysisResult.status === \"fulfilled\" ? analysisResult.value : {\n            intent: \"CHAT\",\n            sentiment: \"Unknown\",\n            complexity: \"LOW\",\n            keywords: [\n                \"Error\"\n            ]\n        };\n        if (analysisResult.status === \"rejected\") {\n            console.error(\"Stage 1 Failed:\", analysisResult.reason);\n        }\n        // Handle Stage 5 Result\n        const userProfile = profileResult.status === \"fulfilled\" ? profileResult.value : null;\n        if (profileResult.status === \"rejected\") {\n            console.error(\"Stage 5 Failed:\", profileResult.reason);\n        }\n        const tool = toolId ? _lib_executive_tools__WEBPACK_IMPORTED_MODULE_3__.executiveTools.find((item)=>item.id === toolId) : null;\n        const shouldGenerateGrowSample = toolId === \"grow\" && /样本|示例|模板|卡片|样例|demo|看看/i.test(message);\n        const shouldGenerateGrowCard = toolId === \"grow\" && /生成|输出|制作|给我|整理|卡片|总结/i.test(message);\n        // 4. Stage 3: Deep Thinking (Strategy)\n        const strategy = await (0,_lib_pipeline__WEBPACK_IMPORTED_MODULE_1__.stage3Think)(message, analysis, memory);\n        // 5. Stage 4: Expression (Final Reply)\n        let aiReply = strategy ? await (0,_lib_pipeline__WEBPACK_IMPORTED_MODULE_1__.stage4Reply)(strategy) : \"抱歉，我今天状态不佳，无法进行思考。\";\n        if ((shouldGenerateGrowSample || shouldGenerateGrowCard) && tool?.prompt) {\n            const sampleCase = `\n案例背景：\n- 角色：某 B 端 SaaS 产品负责人\n- 目标：三个月内将交付周期从 22 天缩短至 15 天\n- 现状：需求变更频繁、跨部门协作慢、测试环境手动部署\n- 资源：已具备基础看板与数据追踪能力\n`.trim();\n            const dataPrompt = `\n${tool.prompt}\n\n${shouldGenerateGrowSample ? `请基于以下具体案例生成卡片内容，不要提及“样本/模板/示例”等字样。\\n${sampleCase}` : `当前用户请求：${message}`}\n\n请只输出 JSON，不要输出其它文字或 Markdown。\nJSON 格式：\n{\n  \"goal\": \"一句话目标，可包含 <span class=\\\\\"highlight-text\\\\\">关键数字</span>\",\n  \"reality\": [\"现状1\", \"现状2\", \"现状3\"],\n  \"options\": [\"方案1\", \"方案2\", \"方案3\"],\n  \"will\": [\"<strong>即刻：</strong> ...\", \"<strong>本周：</strong> ...\", \"<strong>机制：</strong> ...\"],\n  \"sloganCn\": \"中文标语\",\n  \"footerSub\": \"英文副标题\"\n}\n`.trim();\n            const jsonText = await (0,_lib_pipeline__WEBPACK_IMPORTED_MODULE_1__.stage4Reply)(strategy || \"生成卡片数据\", dataPrompt);\n            let payload = null;\n            try {\n                payload = JSON.parse(cleanJsonBlock(jsonText));\n            } catch (error) {\n                payload = null;\n            }\n            const fallbackPayload = {\n                goal: '未来三个月内，将交付周期从 <span class=\"highlight-text\">22天</span> 缩短至 <span class=\"highlight-text\">15天</span>。',\n                reality: [\n                    \"需求变更频繁，约 30% 重复开发。\",\n                    \"跨部门协作平均耗时 4.5 天。\",\n                    \"测试环境手动部署，缺少流水线。\"\n                ],\n                options: [\n                    \"推行看板管理，严格需求准入。\",\n                    \"引入 CI/CD 流水线，降低人为风险。\",\n                    \"下放日常决策权，简化审批路径。\"\n                ],\n                will: [\n                    \"<strong>即刻：</strong> 启动全流程瓶颈审计。\",\n                    \"<strong>本周：</strong> 确定改造负责人和节点。\",\n                    \"<strong>机制：</strong> 建立每周效能复盘闭环。\"\n                ],\n                sloganCn: \"见微知著，引领战略全局\",\n                footerSub: \"STRATEGIC LEADERSHIP • EXECUTIVE COACHING CARD\"\n            };\n            const html = buildGrowCardHtml(payload || fallbackPayload);\n            aiReply = `\\`\\`\\`html\\n${html}\\n\\`\\`\\``;\n        }\n        // 6. Construct Response\n        const debugInfo = {\n            stage1: analysis,\n            stage2_memory: memory || \"无历史记忆\",\n            stage3_strategy: strategy || \"策略生成失败\",\n            stage5_profile: userProfile || \"画像更新失败或无变化\"\n        };\n        try {\n            // Save AI Reply (Text)\n            (0,_lib_db__WEBPACK_IMPORTED_MODULE_2__.saveMessageToDb)(conversationId, \"ai\", aiReply, \"text\");\n            // Save Analysis Process (Analysis)\n            // We save this as a separate message with kind=\"analysis\" so it persists in history\n            (0,_lib_db__WEBPACK_IMPORTED_MODULE_2__.saveMessageToDb)(conversationId, \"ai\", \"Full-Link Debug\", \"analysis\", JSON.stringify(debugInfo));\n            // Async Title Generation Optimization\n            // Only generate if it's the first exchange (message count <= 2)\n            // We can check DB or just assume if we want to update titles periodically.\n            // For efficiency, let's just do it for short conversations or explicitly when it's new.\n            // Since we don't know if it's new easily without querying, let's query quickly.\n            const msgs = (0,_lib_db__WEBPACK_IMPORTED_MODULE_2__.getMessagesFromDb)(conversationId, 10);\n            if (msgs.length <= 2 && !toolTitle) {\n                // Fire and forget - don't await\n                (0,_lib_pipeline__WEBPACK_IMPORTED_MODULE_1__.generateTitle)(message, aiReply).then((newTitle)=>{\n                    if (newTitle) {\n                        console.log(`Updating title for ${conversationId} to: ${newTitle}`);\n                        (0,_lib_db__WEBPACK_IMPORTED_MODULE_2__.updateConversationTitle)(conversationId, newTitle);\n                    }\n                }).catch((err)=>console.error(\"Async Title Gen Error:\", err));\n            }\n        } catch (dbError) {\n            console.error(\"DB Save Error (AI):\", dbError);\n        }\n        return next_dist_server_web_exports_next_response__WEBPACK_IMPORTED_MODULE_0__[\"default\"].json({\n            reply: aiReply,\n            debug_info: debugInfo\n        });\n    } catch (error) {\n        console.error(\"API Error:\", error);\n        return next_dist_server_web_exports_next_response__WEBPACK_IMPORTED_MODULE_0__[\"default\"].json({\n            error: \"Internal Server Error\"\n        }, {\n            status: 500\n        });\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9hcHAvYXBpL2NoYXQvcm91dGUudHMiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7QUFBMkM7QUFDK0U7QUFDWDtBQUN4RDtBQUd2RCxNQUFNWSxlQUFlLENBQUM7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7T0FpZWYsQ0FBQztBQVdSLE1BQU1DLGlCQUFpQixDQUFDQztJQUN0QixNQUFNQyxZQUFZRCxLQUFLRSxLQUFLLENBQUM7SUFDN0IsSUFBSUQsV0FBVyxPQUFPQSxTQUFTLENBQUMsRUFBRSxDQUFDRSxJQUFJO0lBQ3ZDLE1BQU1DLGVBQWVKLEtBQUtFLEtBQUssQ0FBQztJQUNoQyxJQUFJRSxjQUFjLE9BQU9BLFlBQVksQ0FBQyxFQUFFLENBQUNELElBQUk7SUFDN0MsT0FBT0gsS0FBS0csSUFBSTtBQUNsQjtBQUVBLE1BQU1FLFlBQVksQ0FBQ0MsUUFDakJBLE1BQU1DLEdBQUcsQ0FBQyxDQUFDQyxPQUFTLENBQUMsdUJBQXVCLEVBQUVB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LWNvYWNoLWZyb250ZW5kLy4vYXBwL2FwaS9jaGF0L3JvdXRlLnRzP2RlNDYiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgTmV4dFJlc3BvbnNlIH0gZnJvbSBcIm5leHQvc2VydmVyXCI7XG5pbXBvcnQgeyBzdGFnZTFfYW5hbHl6ZSwgZ2V0UmVjZW50SGlzdG9yeSwgc3RhZ2UzVGhpbmssIHN0YWdlNFJlcGx5LCBzdGFnZTVQcm9maWxlLCBnZW5lcmF0ZVRpdGxlIH0gZnJvbSBcIkAvbGliL3BpcGVsaW5lXCI7XG5pbXBvcnQgeyBzYXZlTWVzc2FnZVRvRGIsIHVwZGF0ZUNvbnZlcnNhdGlvblRpdGxlLCB1cGRhdGVDb252ZXJzYXRpb25Ub29sLCBnZXRNZXNzYWdlc0Zyb21EYiB9IGZyb20gXCJAL2xpYi9kYlwiO1xuaW1wb3J0IHsgZXhlY3V0aXZlVG9vbHMgfSBmcm9tIFwiQC9saWIvZXhlY3V0aXZlX3Rvb2xzXCI7XG5pbXBvcnQgeyBTdGFnZTFBbmFseXNpcyB9IGZyb20gXCJAL2xpYi90eXBlc1wiO1xuXG5jb25zdCBncm93VGVtcGxhdGUgPSBgPCFET0NUWVBFIGh0bWw+XG48aHRtbCBsYW5nPVwiemgtQ05cIj5cbjxoZWFkPlxuICAgIDxtZXRhIGNoYXJzZXQ9XCJVVEYtOFwiPlxuICAgIDxtZXRhIG5hbWU9XCJ2aWV3cG9ydFwiIGNvbnRlbnQ9XCJ3aWR0aD1kZXZpY2Utd2lkdGgsIGluaXRpYWwtc2NhbGU9MS4wXCI+XG4gICAgPHRpdGxlPkdST1cgTW9kZWwgLSBFeGVjdXRpdmUgUGFydG5lcjwvdGl0bGU+XG4gICAgPHNjcmlwdCBzcmM9XCJodHRwczovL2NkbmpzLmNsb3VkZmxhcmUuY29tL2FqYXgvbGlicy9kb20tdG8taW1hZ2UtbW9yZS8zLjMuMC9kb20tdG8taW1hZ2UtbW9yZS5taW4uanNcIj48L3NjcmlwdD5cbiAgICA8c3R5bGU+XG4gICAgICAgIDpyb290IHtcbiAgICAgICAgICAgIC0tcHJpbWFyeS1iZzogIzE5MWI0ZDsgXG4gICAgICAgICAgICAtLWFjY2VudC1jb2xvcjogI2ZjY2IyZjtcbiAgICAgICAgICAgIC0tcGFnZS1iZzogI2ZiZjdlZjtcbiAgICAgICAgICAgIC0tdGV4dC1tYWluOiAjMmQzNzQ4O1xuICAgICAgICAgICAgLS1jYXJkLXNoYWRvdzogcmdiYSgwLDAsMCwwLjEpO1xuICAgICAgICAgICAgLS1mb250LWZhbWlseTogXCJQaW5nRmFuZyBTQ1wiLCBcIk1pY3Jvc29mdCBZYUhlaVwiLCBzYW5zLXNlcmlmO1xuICAgICAgICAgICAgLS1ib2R5LWZvbnQtc2l6ZTogMC44OHJlbTtcbiAgICAgICAgICAgIC0tbGluZS1oZWlnaHQ6IDEuNjtcbiAgICAgICAgICAgIC0tYm9keS1mb250LXdlaWdodDogNDAwO1xuICAgICAgICB9XG5cbiAgICAgICAgLnRoZW1lLWVtZXJhbGQge1xuICAgICAgICAgICAgLS1wcmltYXJ5LWJnOiAjMDY0ZTNiO1xuICAgICAgICAgICAgLS1wYWdlLWJnOiAjZjBmZGY0O1xuICAgICAgICAgICAgLS1hY2NlbnQtY29sb3I6ICNmYmJmMjQ7XG4gICAgICAgIH1cblxuICAgICAgICAudGhlbWUtc2xhdGUge1xuICAgICAgICAgICAgLS1wcmltYXJ5LWJnOiAjMWUyOTNiO1xuICAgICAgICAgICAgLS1wYWdlLWJnOiAjZjhmYWZjO1xuICAgICAgICAgICAgLS1hY2NlbnQtY29sb3I6ICM5NGEzYjg7XG4gICAgICAgIH1cblxuICAgICAgICAudGhlbWUtcmVkIHtcbiAgICAgICAgICAgIC0tcHJpbWFyeS1iZzogI2JkMWUyZDtcbiAgICAgICAgICAgIC0tcGFnZS1iZzogI2ZmZmZmZjtcbiAgICAgICAgICAgIC0tYWNjZW50LWNvbG9yOiAjNGE1NTY4OyBcbiAgICAgICAgICAgIC0tdGV4dC1tYWluOiAjMWEyMDJjO1xuICAgICAgICB9XG5cbiAgICAgICAgLmZvbnQtc29uZyB7XG4gICAgICAgICAgICAtLWZvbnQtZmFtaWx5OiBcIlNpbVN1blwiLCBcIlNUU29uZ1wiLCBzZXJpZjtcbiAgICAgICAgICAgIC0tYm9keS1mb250LXdlaWdodDogNTAwO1xuICAgICAgICB9XG5cbiAgICAgICAgLmZvbnQtaGVpIHtcbiAgICAgICAgICAgIC0tZm9udC1mYW1pbHk6IFwiUGluZ0ZhbmcgU0NcIiwgXCJNaWNyb3NvZnQgWWFIZWlcIiwgc2Fucy1zZXJpZjtcbiAgICAgICAgfVxuXG4gICAgICAgICoge1xuICAgICAgICAgICAgYm94LXNpemluZzogYm9yZGVyLWJveDtcbiAgICAgICAgICAgIG1hcmdpbjogMDtcbiAgICAgICAgICAgIHBhZGRpbmc6IDA7XG4gICAgICAgICAgICAtd2Via2l0LXRhcC1oaWdobGlnaHQtY29sb3I6IHRyYW5zcGFyZW50O1xuICAgICAgICB9XG5cbiAgICAgICAgYm9keSB7XG4gICAgICAgICAgICBmb250LWZhbWlseTogdmFyKC0tZm9udC1mYW1pbHkpO1xuICAgICAgICAgICAgZm9udC13ZWlnaHQ6IHZhcigtLWJvZHktZm9udC13ZWlnaHQpO1xuICAgICAgICAgICAgYmFja2dyb3VuZC1jb2xvcjogI2UyZThmMDtcbiAgICAgICAgICAgIGRpc3BsYXk6IGZsZXg7XG4gICAgICAgICAgICBmbGV4LWRpcmVjdGlvbjogY29sdW1uO1xuICAgICAgICAgICAgYWxpZ24taXRlbXM6IGNlbnRlcjtcbiAgICAgICAgICAgIG1pbi1oZWlnaHQ6IDEwMHZoO1xuICAgICAgICAgICAgcGFkZGluZzogMDtcbiAgICAgICAgfVxuXG4gICAgICAgIGJvZHkuZXhwb3J0aW5nIC5oZWFkZXIgaDE6OmFmdGVyLFxuICAgICAgICBib2R5LmV4cG9ydGluZyAuZm9vdGVyIHtcbiAgICAgICAgICAgIGJhY2tncm91bmQ6IG5vbmUgIWltcG9ydGFudDtcbiAgICAgICAgfVxuXG4gICAgICAgIGJvZHkuZXhwb3J0aW5nICoge1xuICAgICAgICAgICAgYmFja2dyb3VuZC1pbWFnZTogbm9uZSAhaW1wb3J0YW50O1xuICAgICAgICB9XG5cbiAgICAgICAgLnRvb2xiYXIge1xuICAgICAgICAgICAgd2lkdGg6IDEwMCU7XG4gICAgICAgICAgICBtYXgtd2lkdGg6IDQxNHB4O1xuICAgICAgICAgICAgYmFja2dyb3VuZDogcmdiYSgyNTUsIDI1NSwgMjU1LCAwLjk1KTtcbiAgICAgICAgICAgIGJhY2tkcm9wLWZpbHRlcjogYmx1cig1cHgpO1xuICAgICAgICAgICAgcGFkZGluZzogMTJweDtcbiAgICAgICAgICAgIGRpc3BsYXk6IGZsZXg7XG4gICAgICAgICAgICBmbGV4LXdyYXA6IHdyYXA7XG4gICAgICAgICAgICBnYXA6IDEwcHg7XG4gICAgICAgICAgICBqdXN0aWZ5LWNvbnRlbnQ6IGNlbnRlcjtcbiAgICAgICAgICAgIHBvc2l0aW9uOiBzdGlja3k7XG4gICAgICAgICAgICB0b3A6IDA7XG4gICAgICAgICAgICB6LWluZGV4OiAxMDA7XG4gICAgICAgICAgICBib3gtc2hhZG93OiAwIDJweCAxMHB4IHJnYmEoMCwwLDAsMC4wNSk7XG4gICAgICAgICAgICBib3JkZXItYm90dG9tOiAxcHggc29saWQgI2NiZDVlMDtcbiAgICAgICAgfVxuXG4gICAgICAgIC50b29sLWdyb3VwIHtcbiAgICAgICAgICAgIGRpc3BsYXk6IGZsZXg7XG4gICAgICAgICAgICBhbGlnbi1pdGVtczogY2VudGVyO1xuICAgICAgICAgICAgZ2FwOiA1cHg7XG4gICAgICAgICAgICBmb250LXNpemU6IDAuN3JlbTtcbiAgICAgICAgICAgIGNvbG9yOiAjNGE1NTY4O1xuICAgICAgICB9XG5cbiAgICAgICAgLnRvb2xiYXIgYnV0dG9uLCAudG9vbGJhciBzZWxlY3QsIC50b29sYmFyIGlucHV0W3R5cGU9XCJyYW5nZVwiXSB7XG4gICAgICAgICAgICBwYWRkaW5nOiA2cHggOHB4O1xuICAgICAgICAgICAgZm9udC1zaXplOiAwLjdyZW07XG4gICAgICAgICAgICBjdXJzb3I6IHBvaW50ZXI7XG4gICAgICAgICAgICBib3JkZXI6IDFweCBzb2xpZCAjY2JkNWUwO1xuICAgICAgICAgICAgYmFja2dyb3VuZDogI2ZmZjtcbiAgICAgICAgICAgIGJvcmRlci1yYWRpdXM6IDRweDtcbiAgICAgICAgICAgIGNvbG9yOiAjNGE1NTY4O1xuICAgICAgICAgICAgb3V0bGluZTogbm9uZTtcbiAgICAgICAgfVxuXG4gICAgICAgIC50b29sYmFyIGlucHV0W3R5cGU9XCJyYW5nZVwiXSB7XG4gICAgICAgICAgICB3aWR0aDogODBweDtcbiAgICAgICAgICAgIHBhZGRpbmc6IDA7XG4gICAgICAgICAgICBjdXJzb3I6IGV3LXJlc2l6ZTtcbiAgICAgICAgfVxuXG4gICAgICAgIC50b29sYmFyIC5idG4tc2F2ZSB7XG4gICAgICAgICAgICBiYWNrZ3JvdW5kOiAjMmQzNzQ4O1xuICAgICAgICAgICAgY29sb3I6IHdoaXRlO1xuICAgICAgICAgICAgYm9yZGVyOiBub25lO1xuICAgICAgICAgICAgcGFkZGluZzogNnB4IDEycHg7XG4gICAgICAgIH1cblxuICAgICAgICAuY2FyZC13cmFwcGVyIHtcbiAgICAgICAgICAgIHBhZGRpbmc6IDE1cHggMCAzMHB4O1xuICAgICAgICAgICAgd2lkdGg6IDEwMCU7XG4gICAgICAgICAgICBkaXNwbGF5OiBmbGV4O1xuICAgICAgICAgICAganVzdGlmeS1jb250ZW50OiBjZW50ZXI7XG4gICAgICAgIH1cblxuICAgICAgICAuY2FyZCB7XG4gICAgICAgICAgICBiYWNrZ3JvdW5kLWNvbG9yOiB2YXIoLS1wYWdlLWJnKTtcbiAgICAgICAgICAgIHdpZHRoOiAxMDAlO1xuICAgICAgICAgICAgbWF4LXdpZHRoOiA0MTRweDtcbiAgICAgICAgICAgIGRpc3BsYXk6IGZsZXg7XG4gICAgICAgICAgICBmbGV4LWRpcmVjdGlvbjogY29sdW1uO1xuICAgICAgICAgICAgYm94LXNoYWRvdzogMCAxMHB4IDQwcHggdmFyKC0tY2FyZC1zaGFkb3cpO1xuICAgICAgICAgICAgcG9zaXRpb246IHJlbGF0aXZlO1xuICAgICAgICAgICAgdHJhbnNpdGlvbjogYWxsIDAuNHMgY3ViaWMtYmV6aWVyKDAuMTY1LCAwLjg0LCAwLjQ0LCAxKTtcbiAgICAgICAgfVxuXG4gICAgICAgIC5oZWFkZXIge1xuICAgICAgICAgICAgYmFja2dyb3VuZC1jb2xvcjogdmFyKC0tcHJpbWFyeS1iZyk7XG4gICAgICAgICAgICBwYWRkaW5nOiAyNXB4IDIwcHggMTVweDtcbiAgICAgICAgICAgIGNvbG9yOiAjZmZmZmZmO1xuICAgICAgICAgICAgcG9zaXRpb246IHJlbGF0aXZlO1xuICAgICAgICAgICAgZGlzcGxheTogZmxleDtcbiAgICAgICAgICAgIGZsZXgtZGlyZWN0aW9uOiBjb2x1bW47XG4gICAgICAgICAgICBqdXN0aWZ5LWNvbnRlbnQ6IGZsZXgtZW5kO1xuICAgICAgICAgICAgdHJhbnNpdGlvbjogYmFja2dyb3VuZC1jb2xvciAwLjRzO1xuICAgICAgICB9XG5cbiAgICAgICAgLmVwLXRhZyB7XG4gICAgICAgICAgICBwb3NpdGlvbjogYWJzb2x1dGU7XG4gICAgICAgICAgICB0b3A6IDIwcHg7XG4gICAgICAgICAgICByaWdodDogMjBweDtcbiAgICAgICAgICAgIGZvbnQtc2l6ZTogMC42cmVtO1xuICAgICAgICAgICAgbGV0dGVyLXNwYWNpbmc6IDJweDtcbiAgICAgICAgICAgIHRleHQtdHJhbnNmb3JtOiB1cHBlcmNhc2U7XG4gICAgICAgICAgICBjb2xvcjogdmFyKC0tYWNjZW50LWNvbG9yKTtcbiAgICAgICAgICAgIG9wYWNpdHk6IDAuOTtcbiAgICAgICAgfVxuXG4gICAgICAgIC5oZWFkZXIgaDEge1xuICAgICAgICAgICAgZm9udC1zaXplOiAxLjNyZW07XG4gICAgICAgICAgICBmb250LXdlaWdodDogNzAwO1xuICAgICAgICAgICAgbGV0dGVyLXNwYWNpbmc6IDFweDtcbiAgICAgICAgICAgIGRpc3BsYXk6IGZsZXg7XG4gICAgICAgICAgICBhbGlnbi1pdGVtczogY2VudGVyO1xuICAgICAgICAgICAgZ2FwOiAxMnB4O1xuICAgICAgICB9XG5cbiAgICAgICAgLmhlYWRlciBoMTo6YWZ0ZXIge1xuICAgICAgICAgICAgY29udGVudDogXCJcIjtcbiAgICAgICAgICAgIGZsZXg6IDE7XG4gICAgICAgICAgICBtaW4td2lkdGg6IDI0cHg7XG4gICAgICAgICAgICBoZWlnaHQ6IDFweDtcbiAgICAgICAgICAgIGJhY2tncm91bmQ6IGxpbmVhci1ncmFkaWVudCh0byByaWdodCwgdmFyKC0tYWNjZW50LWNvbG9yKSwgdHJhbnNwYXJlbnQpO1xuICAgICAgICAgICAgb3BhY2l0eTogMC40O1xuICAgICAgICB9XG5cbiAgICAgICAgLmNvbnRhaW5lciB7XG4gICAgICAgICAgICBwYWRkaW5nOiAyMHB4IDE1cHggNXB4O1xuICAgICAgICB9XG5cbiAgICAgICAgLnN0ZXAtYmxvY2sge1xuICAgICAgICAgICAgbWFyZ2luLWJvdHRvbTogMTZweDtcbiAgICAgICAgICAgIGRpc3BsYXk6IGZsZXg7XG4gICAgICAgICAgICBnYXA6IDEycHg7XG4gICAgICAgIH1cblxuICAgICAgICAuc3RlcC1hc2lkZSB7XG4gICAgICAgICAgICBmbGV4LXNocmluazogMDtcbiAgICAgICAgICAgIHdpZHRoOiAzNnB4O1xuICAgICAgICAgICAgdGV4dC1hbGlnbjogY2VudGVyO1xuICAgICAgICB9XG5cbiAgICAgICAgLnN0ZXAtbGV0dGVyIHtcbiAgICAgICAgICAgIGZvbnQtZmFtaWx5OiBcIkdlb3JnaWFcIiwgc2VyaWY7XG4gICAgICAgICAgICBmb250LXNpemU6IDEuOHJlbTtcbiAgICAgICAgICAgIGZvbnQtd2VpZ2h0OiA5MDA7XG4gICAgICAgICAgICBjb2xvcjogdmFyKC0tcHJpbWFyeS1iZyk7XG4gICAgICAgICAgICBsaW5lLWhlaWdodDogMTtcbiAgICAgICAgICAgIHRyYW5zaXRpb246IGNvbG9yIDAuNHM7XG4gICAgICAgIH1cblxuICAgICAgICAuc3RlcC1tYWluIHtcbiAgICAgICAgICAgIGZsZXgtZ3JvdzogMTtcbiAgICAgICAgfVxuXG4gICAgICAgIC5zdGVwLXRpdGxlIHtcbiAgICAgICAgICAgIGZvbnQtc2l6ZTogMC45cmVtO1xuICAgICAgICAgICAgZm9udC13ZWlnaHQ6IDcwMDtcbiAgICAgICAgICAgIGNvbG9yOiB2YXIoLS1wcmltYXJ5LWJnKTtcbiAgICAgICAgICAgIG1hcmdpbi1ib3R0b206IDVweDtcbiAgICAgICAgICAgIHRleHQtdHJhbnNmb3JtOiB1cHBlcmNhc2U7XG4gICAgICAgICAgICB0cmFuc2l0aW9uOiBjb2xvciAwLjRzO1xuICAgICAgICB9XG5cbiAgICAgICAgLnN0ZXAtY29udGVudCB7XG4gICAgICAgICAgICBiYWNrZ3JvdW5kOiB3aGl0ZTtcbiAgICAgICAgICAgIHBhZGRpbmc6IDEycHggMTRweDtcbiAgICAgICAgICAgIGJvcmRlci1yYWRpdXM6IDJweDtcbiAgICAgICAgICAgIGZvbnQtc2l6ZTogdmFyKC0tYm9keS1mb250LXNpemUpO1xuICAgICAgICAgICAgbGluZS1oZWlnaHQ6IHZhcigtLWxpbmUtaGVpZ2h0KTtcbiAgICAgICAgICAgIGNvbG9yOiB2YXIoLS10ZXh0LW1haW4pO1xuICAgICAgICAgICAgYm9yZGVyLWxlZnQ6IDNweCBzb2xpZCB2YXIoLS1wcmltYXJ5LWJnKTtcbiAgICAgICAgICAgIGJveC1zaGFkb3c6IDAgMnB4IDhweCByZ2JhKDAsMCwwLDAuMDMpO1xuICAgICAgICAgICAgb3V0bGluZTogbm9uZTtcbiAgICAgICAgICAgIHRyYW5zaXRpb246IGJvcmRlci1jb2xvciAwLjRzLCBsaW5lLWhlaWdodCAwLjJzO1xuICAgICAgICB9XG5cbiAgICAgICAgLnN0ZXAtY29udGVudDpmb2N1cyB7XG4gICAgICAgICAgICBiYWNrZ3JvdW5kOiAjZmZmZGY5O1xuICAgICAgICAgICAgYm9yZGVyLWxlZnQtY29sb3I6IHZhcigtLWFjY2VudC1jb2xvcik7XG4gICAgICAgIH1cblxuICAgICAgICAubGlzdC1pdGVtIHtcbiAgICAgICAgICAgIG1hcmdpbi1ib3R0b206IDRweDtcbiAgICAgICAgICAgIHBhZGRpbmctbGVmdDogMTJweDtcbiAgICAgICAgICAgIHBvc2l0aW9uOiByZWxhdGl2ZTtcbiAgICAgICAgfVxuXG4gICAgICAgIC5saXN0LWl0ZW06OmJlZm9yZSB7XG4gICAgICAgICAgICBjb250ZW50OiBcIlwiO1xuICAgICAgICAgICAgcG9zaXRpb246IGFic29sdXRlO1xuICAgICAgICAgICAgbGVmdDogMDtcbiAgICAgICAgICAgIHRvcDogY2FsYygwLjVlbSAqIHZhcigtLWxpbmUtaGVpZ2h0KSk7XG4gICAgICAgICAgICB3aWR0aDogNHB4O1xuICAgICAgICAgICAgaGVpZ2h0OiAxcHg7XG4gICAgICAgICAgICBiYWNrZ3JvdW5kLWNvbG9yOiB2YXIoLS1hY2NlbnQtY29sb3IpO1xuICAgICAgICB9XG5cbiAgICAgICAgLmhpZ2hsaWdodC10ZXh0IHtcbiAgICAgICAgICAgIGNvbG9yOiB2YXIoLS1wcmltYXJ5LWJnKTtcbiAgICAgICAgICAgIGZvbnQtd2VpZ2h0OiA2MDA7XG4gICAgICAgIH1cblxuICAgICAgICAuZm9vdGVyIHtcbiAgICAgICAgICAgIHBhZGRpbmc6IDIwcHg7XG4gICAgICAgICAgICB0ZXh0LWFsaWduOiBjZW50ZXI7XG4gICAgICAgICAgICBiYWNrZ3JvdW5kOiBsaW5lYXItZ3JhZGllbnQodG8gYm90dG9tLCB0cmFuc3BhcmVudCwgcmdiYSgwLDAsMCwwLjAxKSk7XG4gICAgICAgIH1cblxuICAgICAgICAuc2xvZ2FuLWNuIHtcbiAgICAgICAgICAgIGZvbnQtc2l6ZTogMC44NXJlbTtcbiAgICAgICAgICAgIGNvbG9yOiB2YXIoLS1wcmltYXJ5LWJnKTtcbiAgICAgICAgICAgIGZvbnQtd2VpZ2h0OiA2MDA7XG4gICAgICAgICAgICBsZXR0ZXItc3BhY2luZzogM3B4O1xuICAgICAgICAgICAgbWFyZ2luLWJvdHRvbTogNHB4O1xuICAgICAgICAgICAgb3V0bGluZTogbm9uZTtcbiAgICAgICAgICAgIHRyYW5zaXRpb246IGNvbG9yIDAuNHM7XG4gICAgICAgIH1cblxuICAgICAgICAuZm9vdGVyLXN1YiB7XG4gICAgICAgICAgICBmb250LXNpemU6IDAuNTVyZW07XG4gICAgICAgICAgICBjb2xvcjogdmFyKC0tdGV4dC1tdXRlZCk7XG4gICAgICAgICAgICBsZXR0ZXItc3BhY2luZzogMXB4O1xuICAgICAgICAgICAgdGV4dC10cmFuc2Zvcm06IHVwcGVyY2FzZTtcbiAgICAgICAgICAgIG91dGxpbmU6IG5vbmU7XG4gICAgICAgIH1cblxuICAgICAgICAjZXhwb3J0LWxvYWRpbmcge1xuICAgICAgICAgICAgZGlzcGxheTogbm9uZTtcbiAgICAgICAgICAgIHBvc2l0aW9uOiBmaXhlZDtcbiAgICAgICAgICAgIHRvcDogMDsgbGVmdDogMDsgd2lkdGg6IDEwMCU7IGhlaWdodDogMTAwJTtcbiAgICAgICAgICAgIGJhY2tncm91bmQ6IHJnYmEoMjU1LDI1NSwyNTUsMC45KTtcbiAgICAgICAgICAgIHotaW5kZXg6IDEwMDA7XG4gICAgICAgICAgICBqdXN0aWZ5LWNvbnRlbnQ6IGNlbnRlcjtcbiAgICAgICAgICAgIGFsaWduLWl0ZW1zOiBjZW50ZXI7XG4gICAgICAgICAgICBmb250LXdlaWdodDogNTAwO1xuICAgICAgICAgICAgY29sb3I6IHZhcigtLXByaW1hcnktYmcpO1xuICAgICAgICB9XG4gICAgPC9zdHlsZT5cbjwvaGVhZD5cbjxib2R5IGNsYXNzPVwiZm9udC1oZWlcIj5cblxuICAgIDxkaXYgaWQ9XCJleHBvcnQtbG9hZGluZ1wiPuato+WcqOWHhuWkh+mrmOa4heWNoeeJhy4uLjwvZGl2PlxuXG4gICAgPGRpdiBjbGFzcz1cInRvb2xiYXJcIiBpZD1cImNvbnRyb2wtcGFuZWxcIj5cbiAgICAgICAgPHNlbGVjdCBpZD1cImZvbnQtc2VsZWN0XCIgb25jaGFuZ2U9XCJjaGFuZ2VGb250KHRoaXMudmFsdWUpXCI+XG4gICAgICAgICAgICA8b3B0aW9uIHZhbHVlPVwiaGVpXCI+546w5Luj6buR5L2TPC9vcHRpb24+XG4gICAgICAgICAgICA8b3B0aW9uIHZhbHVlPVwic29uZ1wiPue7j+WFuOWui+S9kzwvb3B0aW9uPlxuICAgICAgICA8L3NlbGVjdD5cbiAgICAgICAgXG4gICAgICAgIDxkaXYgY2xhc3M9XCJ0b29sLWdyb3VwXCI+XG4gICAgICAgICAgICA8c3Bhbj7lrZflj7c8L3NwYW4+XG4gICAgICAgICAgICA8YnV0dG9uIG9uY2xpY2s9XCJjaGFuZ2VGb250U2l6ZSgxKVwiPis8L2J1dHRvbj5cbiAgICAgICAgICAgIDxidXR0b24gb25jbGljaz1cImNoYW5nZUZvbnRTaXplKC0xKVwiPi08L2J1dHRvbj5cbiAgICAgICAgPC9kaXY+XG5cbiAgICAgICAgPGRpdiBjbGFzcz1cInRvb2wtZ3JvdXBcIj5cbiAgICAgICAgICAgIDxzcGFuPumXtOi3nTwvc3Bhbj5cbiAgICAgICAgICAgIDxpbnB1dCB0eXBlPVwicmFuZ2VcIiBpZD1cImxoLXJhbmdlXCIgbWluPVwiMS4yXCIgbWF4PVwiMi4yXCIgc3RlcD1cIjAuMVwiIHZhbHVlPVwiMS42XCIgb25pbnB1dD1cImNoYW5nZUxpbmVIZWlnaHQodGhpcy52YWx1ZSlcIj5cbiAgICAgICAgPC9kaXY+XG5cbiAgICAgICAgPGJ1dHRvbiBvbmNsaWNrPVwibmV4dFRoZW1lKClcIj7liIfmjaLphY3oibI8L2J1dHRvbj5cbiAgICAgICAgPGJ1dHRvbiBjbGFzcz1cImJ0bi1zYXZlXCIgb25jbGljaz1cInNhdmVBc0ltYWdlKClcIj7lrZjkuLrlm77niYc8L2J1dHRvbj5cbiAgICA8L2Rpdj5cblxuICAgIDxkaXYgY2xhc3M9XCJjYXJkLXdyYXBwZXJcIiBpZD1cImNhcHR1cmUtYXJlYVwiPlxuICAgICAgICA8ZGl2IGNsYXNzPVwiY2FyZFwiIGlkPVwibWFpbi1jYXJkXCI+XG4gICAgICAgICAgICA8aGVhZGVyIGNsYXNzPVwiaGVhZGVyXCI+XG4gICAgICAgICAgICAgICAgPHNwYW4gY2xhc3M9XCJlcC10YWdcIiBjb250ZW50ZWRpdGFibGU9XCJ0cnVlXCI+RXhlY3V0aXZlIFBhcnRuZXI8L3NwYW4+XG4gICAgICAgICAgICAgICAgPGgxIGNvbnRlbnRlZGl0YWJsZT1cInRydWVcIj5HUk9XIENPQUNISU5HPC9oMT5cbiAgICAgICAgICAgIDwvaGVhZGVyPlxuXG4gICAgICAgICAgICA8bWFpbiBjbGFzcz1cImNvbnRhaW5lclwiPlxuICAgICAgICAgICAgICAgIDxzZWN0aW9uIGNsYXNzPVwic3RlcC1ibG9ja1wiPlxuICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPVwic3RlcC1hc2lkZVwiPlxuICAgICAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzcz1cInN0ZXAtbGV0dGVyXCI+RzwvZGl2PlxuICAgICAgICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzcz1cInN0ZXAtbWFpblwiPlxuICAgICAgICAgICAgICAgICAgICAgICAgPGgyIGNsYXNzPVwic3RlcC10aXRsZVwiIGNvbnRlbnRlZGl0YWJsZT1cInRydWVcIj5Hb2FsIC8g55uu5qCH56Gu56uLPC9oMj5cbiAgICAgICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9XCJzdGVwLWNvbnRlbnRcIiBjb250ZW50ZWRpdGFibGU9XCJ0cnVlXCI+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAge3tHT0FMfX1cbiAgICAgICAgICAgICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgICAgICA8L3NlY3Rpb24+XG5cbiAgICAgICAgICAgICAgICA8c2VjdGlvbiBjbGFzcz1cInN0ZXAtYmxvY2tcIj5cbiAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzcz1cInN0ZXAtYXNpZGVcIj5cbiAgICAgICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9XCJzdGVwLWxldHRlclwiIHN0eWxlPVwibWFyZ2luLWxlZnQ6IC0ycHg7XCI+UjwvZGl2PlxuICAgICAgICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzcz1cInN0ZXAtbWFpblwiPlxuICAgICAgICAgICAgICAgICAgICAgICAgPGgyIGNsYXNzPVwic3RlcC10aXRsZVwiIGNvbnRlbnRlZGl0YWJsZT1cInRydWVcIj5SZWFsaXR5IC8g546w54q25YiG5p6QPC9oMj5cbiAgICAgICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9XCJzdGVwLWNvbnRlbnRcIiBjb250ZW50ZWRpdGFibGU9XCJ0cnVlXCI+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAge3tSRUFMSVRZX0xJU1R9fVxuICAgICAgICAgICAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgICAgIDwvc2VjdGlvbj5cblxuICAgICAgICAgICAgICAgIDxzZWN0aW9uIGNsYXNzPVwic3RlcC1ibG9ja1wiPlxuICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPVwic3RlcC1hc2lkZVwiPlxuICAgICAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzcz1cInN0ZXAtbGV0dGVyXCI+TzwvZGl2PlxuICAgICAgICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzcz1cInN0ZXAtbWFpblwiPlxuICAgICAgICAgICAgICAgICAgICAgICAgPGgyIGNsYXNzPVwic3RlcC10aXRsZVwiIGNvbnRlbnRlZGl0YWJsZT1cInRydWVcIj5PcHRpb25zIC8g5pa55qGI6YCJ5oupPC9oMj5cbiAgICAgICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9XCJzdGVwLWNvbnRlbnRcIiBjb250ZW50ZWRpdGFibGU9XCJ0cnVlXCI+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAge3tPUFRJT05TX0xJU1R9fVxuICAgICAgICAgICAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgICAgIDwvc2VjdGlvbj5cblxuICAgICAgICAgICAgICAgIDxzZWN0aW9uIGNsYXNzPVwic3RlcC1ibG9ja1wiPlxuICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPVwic3RlcC1hc2lkZVwiPlxuICAgICAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzcz1cInN0ZXAtbGV0dGVyXCIgc3R5bGU9XCJtYXJnaW4tbGVmdDogLTJweDtcIj5XPC9kaXY+XG4gICAgICAgICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPVwic3RlcC1tYWluXCI+XG4gICAgICAgICAgICAgICAgICAgICAgICA8aDIgY2xhc3M9XCJzdGVwLXRpdGxlXCIgY29udGVudGVkaXRhYmxlPVwidHJ1ZVwiPldpbGwgLyDmhI/mhL/ooYzliqg8L2gyPlxuICAgICAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzcz1cInN0ZXAtY29udGVudFwiIGNvbnRlbnRlZGl0YWJsZT1cInRydWVcIj5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB7e1dJTExfTElTVH19XG4gICAgICAgICAgICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICAgICAgPC9zZWN0aW9uPlxuICAgICAgICAgICAgPC9tYWluPlxuXG4gICAgICAgICAgICA8Zm9vdGVyIGNsYXNzPVwiZm9vdGVyXCI+XG4gICAgICAgICAgICAgICAgPGRpdiBjbGFzcz1cInNsb2dhbi1jblwiIGNvbnRlbnRlZGl0YWJsZT1cInRydWVcIj57e1NMT0dBTl9DTn19PC9kaXY+XG4gICAgICAgICAgICAgICAgPGRpdiBjbGFzcz1cImZvb3Rlci1zdWJcIiBjb250ZW50ZWRpdGFibGU9XCJ0cnVlXCI+e3tGT09URVJfU1VCfX08L2Rpdj5cbiAgICAgICAgICAgIDwvZm9vdGVyPlxuICAgICAgICA8L2Rpdj5cbiAgICA8L2Rpdj5cblxuICAgIDxzY3JpcHQ+XG4gICAgICAgIGZ1bmN0aW9uIGNoYW5nZUZvbnQodmFsKSB7XG4gICAgICAgICAgICBkb2N1bWVudC5ib2R5LmNsYXNzTmFtZSA9IHZhbCA9PT0gJ3NvbmcnID8gJ2ZvbnQtc29uZycgOiAnZm9udC1oZWknO1xuICAgICAgICB9XG5cbiAgICAgICAgbGV0IGN1cnJlbnRTaXplID0gMC44ODtcbiAgICAgICAgZnVuY3Rpb24gY2hhbmdlRm9udFNpemUoZGVsdGEpIHtcbiAgICAgICAgICAgIGN1cnJlbnRTaXplID0gTWF0aC5tYXgoMC43LCBNYXRoLm1pbigxLjIsIGN1cnJlbnRTaXplICsgZGVsdGEgKiAwLjA1KSk7XG4gICAgICAgICAgICBkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQuc3R5bGUuc2V0UHJvcGVydHkoJy0tYm9keS1mb250LXNpemUnLCBjdXJyZW50U2l6ZSArICdyZW0nKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGZ1bmN0aW9uIGNoYW5nZUxpbmVIZWlnaHQodmFsKSB7XG4gICAgICAgICAgICBkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQuc3R5bGUuc2V0UHJvcGVydHkoJy0tbGluZS1oZWlnaHQnLCB2YWwpO1xuICAgICAgICB9XG5cbiAgICAgICAgY29uc3QgdGhlbWVzID0gWycnLCAndGhlbWUtZW1lcmFsZCcsICd0aGVtZS1zbGF0ZScsICd0aGVtZS1yZWQnXTtcbiAgICAgICAgbGV0IGN1cnJlbnRUaGVtZUluZGV4ID0gMDtcbiAgICAgICAgZnVuY3Rpb24gbmV4dFRoZW1lKCkge1xuICAgICAgICAgICAgY29uc3QgY2FyZCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdtYWluLWNhcmQnKTtcbiAgICAgICAgICAgIGNhcmQuY2xhc3NMaXN0LnJlbW92ZSguLi50aGVtZXMuZmlsdGVyKHQgPT4gdCAhPT0gJycpKTtcbiAgICAgICAgICAgIGN1cnJlbnRUaGVtZUluZGV4ID0gKGN1cnJlbnRUaGVtZUluZGV4ICsgMSkgJSB0aGVtZXMubGVuZ3RoO1xuICAgICAgICAgICAgaWYgKHRoZW1lc1tjdXJyZW50VGhlbWVJbmRleF0pIHtcbiAgICAgICAgICAgICAgICBjYXJkLmNsYXNzTGlzdC5hZGQodGhlbWVzW2N1cnJlbnRUaGVtZUluZGV4XSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICAgICAgLy8g5pyA57uI5pa55qGI77ya5L2/55SoIGRvbS10by1pbWFnZS1tb3JlICjln7rkuo4gU1ZHIGZvcmVpZ25PYmplY3QpXG4gICAgICAgICAgICAvLyDlvbvlupXpgb/lvIAgaHRtbDJjYW52YXMg55qEIGNyZWF0ZVBhdHRlcm4g5biD5bGA5aGM6Zm36Zeu6aKYXG4gICAgICAgICAgICBjb25zdCBzYXZlQXNJbWFnZSA9IGFzeW5jICgpID0+IHtcbiAgICAgICAgICAgICAgICBjb25zdCBsb2FkaW5nID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2V4cG9ydC1sb2FkaW5nJyk7XG4gICAgICAgICAgICAgICAgY29uc3QgY2FyZCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdtYWluLWNhcmQnKTtcbiAgICAgICAgICAgICAgICAvLyBAdHMtaWdub3JlXG4gICAgICAgICAgICAgICAgaWYgKCFjYXJkIHx8ICF3aW5kb3cuZG9tdG9pbWFnZSkge1xuICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmVycm9yKFwi57uE5Lu25pyq5Yqg6L295oiW5bqT57y65aSxXCIpO1xuICAgICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgbG9hZGluZy5zdHlsZS5kaXNwbGF5ID0gJ2ZsZXgnO1xuICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgIC8vIDEuIOS4tOaXtumUgeWumuWwuuWvuOS7peS/neivgeWvvOWHuua4heaZsOW6piAoMngpXG4gICAgICAgICAgICAgICAgY29uc3Qgc2NhbGUgPSAyO1xuICAgICAgICAgICAgICAgIGNvbnN0IG9yaWdpbmFsV2lkdGggPSBjYXJkLnN0eWxlLndpZHRoO1xuICAgICAgICAgICAgICAgIGNvbnN0IG9yaWdpbmFsSGVpZ2h0ID0gY2FyZC5zdHlsZS5oZWlnaHQ7XG4gICAgICAgICAgICAgICAgY29uc3Qgb3JpZ2luYWxUcmFuc2Zvcm0gPSBjYXJkLnN0eWxlLnRyYW5zZm9ybTtcbiAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAvLyDlvLrliLborr7nva7kuIDkuKrlm7rlrprlrr3luqbov5vooYzmuLLmn5PvvIzpmLLmraLnp7vliqjnq6/luIPlsYDlt67lvIJcbiAgICAgICAgICAgICAgICAvLyA0MTRweCDmmK/moIflh4bnp7vliqjnq6/lrr3luqbvvIzlr7zlh7rml7bmlL7lpKcy5YCNXG4gICAgICAgICAgICAgICAgY2FyZC5zdHlsZS53aWR0aCA9ICc0MTRweCc7XG4gICAgICAgICAgICAgICAgY2FyZC5zdHlsZS5oZWlnaHQgPSAnYXV0byc7IC8vIOiuqemrmOW6puiHqumAguW6lFxuICAgICAgICAgICAgICAgIGNhcmQuc3R5bGUudHJhbnNmb3JtID0gJ25vbmUnO1xuICAgICAgICAgICAgICAgIGNhcmQuc3R5bGUubWFyZ2luID0gJzAnOyAvLyDnp7vpmaTlj6/og73nmoTlpJbovrnot53lvbHlk41cbiAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAvLyDnp7vpmaTpmLTlvbHvvIzpmLLmraLlr7zlh7rml7bljIXlkKvljYrpgI/mmI7pmLTlvbHljLrln5/vvIzlr7zoh7TnlKjmiLfop4nlvpfmnIlcIumAj+aYjuiDjOaZr1wiXG4gICAgICAgICAgICAgICAgY29uc3Qgb3JpZ2luYWxCb3hTaGFkb3cgPSBjYXJkLnN0eWxlLmJveFNoYWRvdztcbiAgICAgICAgICAgICAgICBjYXJkLnN0eWxlLmJveFNoYWRvdyA9ICdub25lJztcblxuICAgICAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgICAgIC8vIDIuIOeojeW+ruW7tui/n+etieW+hSBET00g6YeN5o6SXG4gICAgICAgICAgICAgICAgICAgIGF3YWl0IG5ldyBQcm9taXNlKHJlc29sdmUgPT4gc2V0VGltZW91dChyZXNvbHZlLCAxMDApKTtcblxuICAgICAgICAgICAgICAgICAgICAvLyBAdHMtaWdub3JlXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGRhdGFVcmwgPSBhd2FpdCB3aW5kb3cuZG9tdG9pbWFnZS50b1BuZyhjYXJkLCB7XG4gICAgICAgICAgICAgICAgICAgICAgICB3aWR0aDogNDE0ICogc2NhbGUsXG4gICAgICAgICAgICAgICAgICAgICAgICBoZWlnaHQ6IGNhcmQub2Zmc2V0SGVpZ2h0ICogc2NhbGUsXG4gICAgICAgICAgICAgICAgICAgICAgICBzdHlsZToge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRyYW5zZm9ybTogJ3NjYWxlKCcgKyBzY2FsZSArICcpJyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0cmFuc2Zvcm1PcmlnaW46ICd0b3AgbGVmdCcsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgd2lkdGg6ICc0MTRweCcsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaGVpZ2h0OiAnYXV0bycsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJ2JhY2tncm91bmQtY29sb3InOiAnI2ZiZjdlZicsIC8vIOW8uuWItuiuvue9ruiDjOaZr+iJsu+8jOmYsuatouWHuueOsOmAj+aYjuagvOWtkFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICdib3gtc2hhZG93JzogJ25vbmUnLCAvLyDnoa7kv53lr7zlh7rlm77lg4/ml6DpmLTlvbFcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAnbWFyZ2luJzogJzAnXG4gICAgICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgYmdjb2xvcjogJyNmYmY3ZWYnIC8vIGRvbS10by1pbWFnZSDpobblsYLphY3nva7vvIzlhZzlupXloavlhYXog4zmma/oibJcbiAgICAgICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICAgICAgY29uc3QgbGluayA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2EnKTtcbiAgICAgICAgICAgICAgICAgICAgbGluay5kb3dubG9hZCA9ICdFeGVjdXRpdmVfR1JPV19DYXJkLnBuZyc7XG4gICAgICAgICAgICAgICAgICAgIGxpbmsuaHJlZiA9IGRhdGFVcmw7XG4gICAgICAgICAgICAgICAgICAgIGxpbmsuY2xpY2soKTtcbiAgICAgICAgICAgICAgICB9IGNhdGNoIChlcnIpIHtcbiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5lcnJvcihcImRvbS10by1pbWFnZSDlr7zlh7rlpLHotKU6XCIsIGVycik7XG4gICAgICAgICAgICAgICAgICAgIGFsZXJ0KFwi5a+85Ye65aSx6LSl77yM6K+36YeN6K+VXCIpO1xuICAgICAgICAgICAgICAgIH0gZmluYWxseSB7XG4gICAgICAgICAgICAgICAgICAgIC8vIDMuIOaBouWkjeWOn+Wni+agt+W8j1xuICAgICAgICAgICAgICAgICAgICBjYXJkLnN0eWxlLndpZHRoID0gb3JpZ2luYWxXaWR0aDtcbiAgICAgICAgICAgICAgICAgICAgY2FyZC5zdHlsZS5oZWlnaHQgPSBvcmlnaW5hbEhlaWdodDtcbiAgICAgICAgICAgICAgICAgICAgY2FyZC5zdHlsZS50cmFuc2Zvcm0gPSBvcmlnaW5hbFRyYW5zZm9ybTtcbiAgICAgICAgICAgICAgICAgICAgY2FyZC5zdHlsZS5tYXJnaW4gPSAnJztcbiAgICAgICAgICAgICAgICAgICAgY2FyZC5zdHlsZS5ib3hTaGFkb3cgPSBvcmlnaW5hbEJveFNoYWRvdztcbiAgICAgICAgICAgICAgICAgICAgbG9hZGluZy5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH07XG4gICAgPC9zY3JpcHQ+XG5cbjwvYm9keT5cbjwvaHRtbD5gO1xuXG50eXBlIEdyb3dDYXJkUGF5bG9hZCA9IHtcbiAgZ29hbDogc3RyaW5nO1xuICByZWFsaXR5OiBzdHJpbmdbXTtcbiAgb3B0aW9uczogc3RyaW5nW107XG4gIHdpbGw6IHN0cmluZ1tdO1xuICBzbG9nYW5Dbjogc3RyaW5nO1xuICBmb290ZXJTdWI6IHN0cmluZztcbn07XG5cbmNvbnN0IGNsZWFuSnNvbkJsb2NrID0gKHRleHQ6IHN0cmluZykgPT4ge1xuICBjb25zdCBqc29uRmVuY2UgPSB0ZXh0Lm1hdGNoKC9gYGBqc29uXFxzKihbXFxzXFxTXSo/KWBgYC9pKTtcbiAgaWYgKGpzb25GZW5jZSkgcmV0dXJuIGpzb25GZW5jZVsxXS50cmltKCk7XG4gIGNvbnN0IGdlbmVyaWNGZW5jZSA9IHRleHQubWF0Y2goL2BgYChbXFxzXFxTXSo/KWBgYC8pO1xuICBpZiAoZ2VuZXJpY0ZlbmNlKSByZXR1cm4gZ2VuZXJpY0ZlbmNlWzFdLnRyaW0oKTtcbiAgcmV0dXJuIHRleHQudHJpbSgpO1xufTtcblxuY29uc3QgYnVpbGRMaXN0ID0gKGl0ZW1zOiBzdHJpbmdbXSkgPT5cbiAgaXRlbXMubWFwKChpdGVtKSA9PiBgPGRpdiBjbGFzcz1cImxpc3QtaXRlbVwiPiR7aXRlbX08L2Rpdj5gKS5qb2luKFwiXFxuXCIpO1xuXG5jb25zdCBidWlsZEdyb3dDYXJkSHRtbCA9IChwYXlsb2FkOiBHcm93Q2FyZFBheWxvYWQpID0+IHtcbiAgY29uc3QgZ29hbCA9IHBheWxvYWQuZ29hbCB8fCBcIuWcqOacquadpeS4ieS4quaciOWGhe+8jOaYjuehruebruagh+W5tuW7uueri+WPr+aJp+ihjOi3r+W+hOOAglwiO1xuICBjb25zdCByZWFsaXR5TGlzdCA9IGJ1aWxkTGlzdChwYXlsb2FkLnJlYWxpdHk/LnNsaWNlKDAsIDMpIHx8IFtdKTtcbiAgY29uc3Qgb3B0aW9uc0xpc3QgPSBidWlsZExpc3QocGF5bG9hZC5vcHRpb25zPy5zbGljZSgwLCAzKSB8fCBbXSk7XG4gIGNvbnN0IHdpbGxMaXN0ID0gYnVpbGRMaXN0KHBheWxvYWQud2lsbD8uc2xpY2UoMCwgMykgfHwgW10pO1xuICBjb25zdCBzbG9nYW5DbiA9IHBheWxvYWQuc2xvZ2FuQ24gfHwgXCLop4Hlvq7nn6XokZfvvIzlvJXpoobmiJjnlaXlhajlsYBcIjtcbiAgY29uc3QgZm9vdGVyU3ViID0gcGF5bG9hZC5mb290ZXJTdWIgfHwgXCJTVFJBVEVHSUMgTEVBREVSU0hJUCDigKIgRVhFQ1VUSVZFIENPQUNISU5HIENBUkRcIjtcbiAgcmV0dXJuIGdyb3dUZW1wbGF0ZVxuICAgIC5yZXBsYWNlKFwie3tHT0FMfX1cIiwgZ29hbClcbiAgICAucmVwbGFjZShcInt7UkVBTElUWV9MSVNUfX1cIiwgcmVhbGl0eUxpc3QpXG4gICAgLnJlcGxhY2UoXCJ7e09QVElPTlNfTElTVH19XCIsIG9wdGlvbnNMaXN0KVxuICAgIC5yZXBsYWNlKFwie3tXSUxMX0xJU1R9fVwiLCB3aWxsTGlzdClcbiAgICAucmVwbGFjZShcInt7U0xPR0FOX0NOfX1cIiwgc2xvZ2FuQ24pXG4gICAgLnJlcGxhY2UoXCJ7e0ZPT1RFUl9TVUJ9fVwiLCBmb290ZXJTdWIpO1xufTtcblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIFBPU1QocmVxdWVzdDogUmVxdWVzdCkge1xuICB0cnkge1xuICAgIGNvbnN0IHsgbWVzc2FnZSwgY29udmVyc2F0aW9uSWQsIHRvb2xJZCwgdG9vbFRpdGxlIH0gPSBhd2FpdCByZXF1ZXN0Lmpzb24oKTtcblxuICAgIGlmICghbWVzc2FnZSB8fCAhY29udmVyc2F0aW9uSWQpIHtcbiAgICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbihcbiAgICAgICAgeyBlcnJvcjogXCJNZXNzYWdlIGFuZCBjb252ZXJzYXRpb25JZCBhcmUgcmVxdWlyZWRcIiB9LFxuICAgICAgICB7IHN0YXR1czogNDAwIH1cbiAgICAgICk7XG4gICAgfVxuXG4gICAgLy8gMS4gU2F2ZSBVc2VyIE1lc3NhZ2UgdG8gREJcbiAgICB0cnkge1xuICAgICAgc2F2ZU1lc3NhZ2VUb0RiKGNvbnZlcnNhdGlvbklkLCBcInVzZXJcIiwgbWVzc2FnZSk7XG4gICAgICBpZiAodG9vbElkICYmIHRvb2xUaXRsZSkge1xuICAgICAgICBjb25zdCBleGlzdGluZyA9IGdldE1lc3NhZ2VzRnJvbURiKGNvbnZlcnNhdGlvbklkLCA1KTtcbiAgICAgICAgaWYgKGV4aXN0aW5nLmxlbmd0aCA9PT0gMSAmJiBleGlzdGluZ1swXS5yb2xlID09PSBcInVzZXJcIikge1xuICAgICAgICAgIHVwZGF0ZUNvbnZlcnNhdGlvblRpdGxlKGNvbnZlcnNhdGlvbklkLCB0b29sVGl0bGUpO1xuICAgICAgICAgIHVwZGF0ZUNvbnZlcnNhdGlvblRvb2woY29udmVyc2F0aW9uSWQsIHRvb2xJZCk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9IGNhdGNoIChkYkVycm9yKSB7XG4gICAgICBjb25zb2xlLmVycm9yKFwiREIgU2F2ZSBFcnJvciAoVXNlcik6XCIsIGRiRXJyb3IpO1xuICAgICAgLy8gQ29udGludWUgZXhlY3V0aW9uIGV2ZW4gaWYgREIgc2F2ZSBmYWlscywgdG8gcHJvdmlkZSByZXBseVxuICAgIH1cblxuICAgIC8vIDIuIFN0YWdlIDI6IFJldHJpZXZlIE1lbW9yeVxuICAgIGNvbnN0IG1lbW9yeSA9IGdldFJlY2VudEhpc3RvcnkoY29udmVyc2F0aW9uSWQpO1xuXG4gICAgLy8gUGFyYWxsZWwgRXhlY3V0aW9uOiBTdGFnZSAxIChBbmFseXNpcykgJiBTdGFnZSA1IChQcm9maWxlKVxuICAgIC8vIFVzZSBQcm9taXNlLmFsbFNldHRsZWQgdG8gZW5zdXJlIG9uZSBmYWlsdXJlIGRvZXNuJ3Qgc3RvcCB0aGUgb3RoZXJcbiAgICBjb25zdCBbYW5hbHlzaXNSZXN1bHQsIHByb2ZpbGVSZXN1bHRdID0gYXdhaXQgUHJvbWlzZS5hbGxTZXR0bGVkKFtcbiAgICAgIHN0YWdlMV9hbmFseXplKG1lc3NhZ2UpLFxuICAgICAgc3RhZ2U1UHJvZmlsZShtZW1vcnkpXG4gICAgXSk7XG5cbiAgICAvLyBIYW5kbGUgU3RhZ2UgMSBSZXN1bHRcbiAgICBjb25zdCBhbmFseXNpczogU3RhZ2UxQW5hbHlzaXMgPSBhbmFseXNpc1Jlc3VsdC5zdGF0dXMgPT09IFwiZnVsZmlsbGVkXCIgXG4gICAgICA/IGFuYWx5c2lzUmVzdWx0LnZhbHVlIFxuICAgICAgOiB7IFxuICAgICAgICAgIGludGVudDogXCJDSEFUXCIsIFxuICAgICAgICAgIHNlbnRpbWVudDogXCJVbmtub3duXCIsIFxuICAgICAgICAgIGNvbXBsZXhpdHk6IFwiTE9XXCIsIFxuICAgICAgICAgIGtleXdvcmRzOiBbXCJFcnJvclwiXSBcbiAgICAgICAgfTtcblxuICAgIGlmIChhbmFseXNpc1Jlc3VsdC5zdGF0dXMgPT09IFwicmVqZWN0ZWRcIikge1xuICAgICAgY29uc29sZS5lcnJvcihcIlN0YWdlIDEgRmFpbGVkOlwiLCBhbmFseXNpc1Jlc3VsdC5yZWFzb24pO1xuICAgIH1cblxuICAgIC8vIEhhbmRsZSBTdGFnZSA1IFJlc3VsdFxuICAgIGNvbnN0IHVzZXJQcm9maWxlID0gcHJvZmlsZVJlc3VsdC5zdGF0dXMgPT09IFwiZnVsZmlsbGVkXCIgXG4gICAgICA/IHByb2ZpbGVSZXN1bHQudmFsdWUgXG4gICAgICA6IG51bGw7XG5cbiAgICBpZiAocHJvZmlsZVJlc3VsdC5zdGF0dXMgPT09IFwicmVqZWN0ZWRcIikge1xuICAgICAgY29uc29sZS5lcnJvcihcIlN0YWdlIDUgRmFpbGVkOlwiLCBwcm9maWxlUmVzdWx0LnJlYXNvbik7XG4gICAgfVxuXG4gICAgY29uc3QgdG9vbCA9IHRvb2xJZCA/IGV4ZWN1dGl2ZVRvb2xzLmZpbmQoKGl0ZW0pID0+IGl0ZW0uaWQgPT09IHRvb2xJZCkgOiBudWxsO1xuICAgIGNvbnN0IHNob3VsZEdlbmVyYXRlR3Jvd1NhbXBsZSA9XG4gICAgICB0b29sSWQgPT09IFwiZ3Jvd1wiICYmIC/moLfmnKx856S65L6LfOaooeadv3zljaHniYd85qC35L6LfGRlbW9855yL55yLL2kudGVzdChtZXNzYWdlKTtcbiAgICBjb25zdCBzaG91bGRHZW5lcmF0ZUdyb3dDYXJkID1cbiAgICAgIHRvb2xJZCA9PT0gXCJncm93XCIgJiYgL+eUn+aIkHzovpPlh7p85Yi25L2cfOe7meaIkXzmlbTnkIZ85Y2h54mHfOaAu+e7ky9pLnRlc3QobWVzc2FnZSk7XG5cbiAgICAvLyA0LiBTdGFnZSAzOiBEZWVwIFRoaW5raW5nIChTdHJhdGVneSlcbiAgICBjb25zdCBzdHJhdGVneSA9IGF3YWl0IHN0YWdlM1RoaW5rKG1lc3NhZ2UsIGFuYWx5c2lzLCBtZW1vcnkpO1xuXG4gICAgLy8gNS4gU3RhZ2UgNDogRXhwcmVzc2lvbiAoRmluYWwgUmVwbHkpXG4gICAgbGV0IGFpUmVwbHkgPSBzdHJhdGVneSBcbiAgICAgID8gYXdhaXQgc3RhZ2U0UmVwbHkoc3RyYXRlZ3kpXG4gICAgICA6IFwi5oqx5q2J77yM5oiR5LuK5aSp54q25oCB5LiN5L2z77yM5peg5rOV6L+b6KGM5oCd6ICD44CCXCI7XG5cbiAgICBpZiAoKHNob3VsZEdlbmVyYXRlR3Jvd1NhbXBsZSB8fCBzaG91bGRHZW5lcmF0ZUdyb3dDYXJkKSAmJiB0b29sPy5wcm9tcHQpIHtcbiAgICAgIGNvbnN0IHNhbXBsZUNhc2UgPSBgXG7moYjkvovog4zmma/vvJpcbi0g6KeS6Imy77ya5p+QIEIg56uvIFNhYVMg5Lqn5ZOB6LSf6LSj5Lq6XG4tIOebruagh++8muS4ieS4quaciOWGheWwhuS6pOS7mOWRqOacn+S7jiAyMiDlpKnnvKnnn63oh7MgMTUg5aSpXG4tIOeOsOeKtu+8mumcgOaxguWPmOabtOmikee5geOAgei3qOmDqOmXqOWNj+S9nOaFouOAgea1i+ivleeOr+Wig+aJi+WKqOmDqOe9slxuLSDotYTmupDvvJrlt7LlhbflpIfln7rnoYDnnIvmnb/kuI7mlbDmja7ov73ouKrog73liptcbmAudHJpbSgpO1xuICAgICAgY29uc3QgZGF0YVByb21wdCA9IGBcbiR7dG9vbC5wcm9tcHR9XG5cbiR7c2hvdWxkR2VuZXJhdGVHcm93U2FtcGxlID8gYOivt+WfuuS6juS7peS4i+WFt+S9k+ahiOS+i+eUn+aIkOWNoeeJh+WGheWuue+8jOS4jeimgeaPkOWPiuKAnOagt+acrC/mqKHmnb8v56S65L6L4oCd562J5a2X5qC344CCXFxuJHtzYW1wbGVDYXNlfWAgOiBg5b2T5YmN55So5oi36K+35rGC77yaJHttZXNzYWdlfWB9XG5cbuivt+WPqui+k+WHuiBKU09O77yM5LiN6KaB6L6T5Ye65YW25a6D5paH5a2X5oiWIE1hcmtkb3du44CCXG5KU09OIOagvOW8j++8mlxue1xuICBcImdvYWxcIjogXCLkuIDlj6Xor53nm67moIfvvIzlj6/ljIXlkKsgPHNwYW4gY2xhc3M9XFxcXFwiaGlnaGxpZ2h0LXRleHRcXFxcXCI+5YWz6ZSu5pWw5a2XPC9zcGFuPlwiLFxuICBcInJlYWxpdHlcIjogW1wi546w54q2MVwiLCBcIueOsOeKtjJcIiwgXCLnjrDnirYzXCJdLFxuICBcIm9wdGlvbnNcIjogW1wi5pa55qGIMVwiLCBcIuaWueahiDJcIiwgXCLmlrnmoYgzXCJdLFxuICBcIndpbGxcIjogW1wiPHN0cm9uZz7ljbPliLvvvJo8L3N0cm9uZz4gLi4uXCIsIFwiPHN0cm9uZz7mnKzlkajvvJo8L3N0cm9uZz4gLi4uXCIsIFwiPHN0cm9uZz7mnLrliLbvvJo8L3N0cm9uZz4gLi4uXCJdLFxuICBcInNsb2dhbkNuXCI6IFwi5Lit5paH5qCH6K+tXCIsXG4gIFwiZm9vdGVyU3ViXCI6IFwi6Iux5paH5Ymv5qCH6aKYXCJcbn1cbmAudHJpbSgpO1xuICAgICAgY29uc3QganNvblRleHQgPSBhd2FpdCBzdGFnZTRSZXBseShzdHJhdGVneSB8fCBcIueUn+aIkOWNoeeJh+aVsOaNrlwiLCBkYXRhUHJvbXB0KTtcbiAgICAgIGxldCBwYXlsb2FkOiBHcm93Q2FyZFBheWxvYWQgfCBudWxsID0gbnVsbDtcbiAgICAgIHRyeSB7XG4gICAgICAgIHBheWxvYWQgPSBKU09OLnBhcnNlKGNsZWFuSnNvbkJsb2NrKGpzb25UZXh0KSk7XG4gICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICBwYXlsb2FkID0gbnVsbDtcbiAgICAgIH1cbiAgICAgIGNvbnN0IGZhbGxiYWNrUGF5bG9hZDogR3Jvd0NhcmRQYXlsb2FkID0ge1xuICAgICAgICBnb2FsOiBcIuacquadpeS4ieS4quaciOWGhe+8jOWwhuS6pOS7mOWRqOacn+S7jiA8c3BhbiBjbGFzcz1cXFwiaGlnaGxpZ2h0LXRleHRcXFwiPjIy5aSpPC9zcGFuPiDnvKnnn63oh7MgPHNwYW4gY2xhc3M9XFxcImhpZ2hsaWdodC10ZXh0XFxcIj4xNeWkqTwvc3Bhbj7jgIJcIixcbiAgICAgICAgcmVhbGl0eTogW1wi6ZyA5rGC5Y+Y5pu06aKR57mB77yM57qmIDMwJSDph43lpI3lvIDlj5HjgIJcIiwgXCLot6jpg6jpl6jljY/kvZzlubPlnYfogJfml7YgNC41IOWkqeOAglwiLCBcIua1i+ivleeOr+Wig+aJi+WKqOmDqOe9su+8jOe8uuWwkea1geawtOe6v+OAglwiXSxcbiAgICAgICAgb3B0aW9uczogW1wi5o6o6KGM55yL5p2/566h55CG77yM5Lil5qC86ZyA5rGC5YeG5YWl44CCXCIsIFwi5byV5YWlIENJL0NEIOa1geawtOe6v++8jOmZjeS9juS6uuS4uumjjumZqeOAglwiLCBcIuS4i+aUvuaXpeW4uOWGs+etluadg++8jOeugOWMluWuoeaJuei3r+W+hOOAglwiXSxcbiAgICAgICAgd2lsbDogW1wiPHN0cm9uZz7ljbPliLvvvJo8L3N0cm9uZz4g5ZCv5Yqo5YWo5rWB56iL55O26aKI5a6h6K6h44CCXCIsIFwiPHN0cm9uZz7mnKzlkajvvJo8L3N0cm9uZz4g56Gu5a6a5pS56YCg6LSf6LSj5Lq65ZKM6IqC54K544CCXCIsIFwiPHN0cm9uZz7mnLrliLbvvJo8L3N0cm9uZz4g5bu656uL5q+P5ZGo5pWI6IO95aSN55uY6Zet546v44CCXCJdLFxuICAgICAgICBzbG9nYW5DbjogXCLop4Hlvq7nn6XokZfvvIzlvJXpoobmiJjnlaXlhajlsYBcIixcbiAgICAgICAgZm9vdGVyU3ViOiBcIlNUUkFURUdJQyBMRUFERVJTSElQIOKAoiBFWEVDVVRJVkUgQ09BQ0hJTkcgQ0FSRFwiXG4gICAgICB9O1xuICAgICAgY29uc3QgaHRtbCA9IGJ1aWxkR3Jvd0NhcmRIdG1sKHBheWxvYWQgfHwgZmFsbGJhY2tQYXlsb2FkKTtcbiAgICAgIGFpUmVwbHkgPSBgXFxgXFxgXFxgaHRtbFxcbiR7aHRtbH1cXG5cXGBcXGBcXGBgO1xuICAgIH1cblxuICAgIC8vIDYuIENvbnN0cnVjdCBSZXNwb25zZVxuICAgIGNvbnN0IGRlYnVnSW5mbyA9IHtcbiAgICAgICAgc3RhZ2UxOiBhbmFseXNpcyxcbiAgICAgICAgc3RhZ2UyX21lbW9yeTogbWVtb3J5IHx8IFwi5peg5Y6G5Y+y6K6w5b+GXCIsXG4gICAgICAgIHN0YWdlM19zdHJhdGVneTogc3RyYXRlZ3kgfHwgXCLnrZbnlaXnlJ/miJDlpLHotKVcIixcbiAgICAgICAgc3RhZ2U1X3Byb2ZpbGU6IHVzZXJQcm9maWxlIHx8IFwi55S75YOP5pu05paw5aSx6LSl5oiW5peg5Y+Y5YyWXCJcbiAgICB9O1xuXG4gICAgdHJ5IHtcbiAgICAgIC8vIFNhdmUgQUkgUmVwbHkgKFRleHQpXG4gICAgICBzYXZlTWVzc2FnZVRvRGIoY29udmVyc2F0aW9uSWQsIFwiYWlcIiwgYWlSZXBseSwgXCJ0ZXh0XCIpO1xuICAgICAgXG4gICAgICAvLyBTYXZlIEFuYWx5c2lzIFByb2Nlc3MgKEFuYWx5c2lzKVxuICAgICAgLy8gV2Ugc2F2ZSB0aGlzIGFzIGEgc2VwYXJhdGUgbWVzc2FnZSB3aXRoIGtpbmQ9XCJhbmFseXNpc1wiIHNvIGl0IHBlcnNpc3RzIGluIGhpc3RvcnlcbiAgICAgIHNhdmVNZXNzYWdlVG9EYihcbiAgICAgICAgY29udmVyc2F0aW9uSWQsIFxuICAgICAgICBcImFpXCIsIFxuICAgICAgICBcIkZ1bGwtTGluayBEZWJ1Z1wiLCBcbiAgICAgICAgXCJhbmFseXNpc1wiLCBcbiAgICAgICAgSlNPTi5zdHJpbmdpZnkoZGVidWdJbmZvKVxuICAgICAgKTtcblxuICAgICAgLy8gQXN5bmMgVGl0bGUgR2VuZXJhdGlvbiBPcHRpbWl6YXRpb25cbiAgICAgIC8vIE9ubHkgZ2VuZXJhdGUgaWYgaXQncyB0aGUgZmlyc3QgZXhjaGFuZ2UgKG1lc3NhZ2UgY291bnQgPD0gMilcbiAgICAgIC8vIFdlIGNhbiBjaGVjayBEQiBvciBqdXN0IGFzc3VtZSBpZiB3ZSB3YW50IHRvIHVwZGF0ZSB0aXRsZXMgcGVyaW9kaWNhbGx5LlxuICAgICAgLy8gRm9yIGVmZmljaWVuY3ksIGxldCdzIGp1c3QgZG8gaXQgZm9yIHNob3J0IGNvbnZlcnNhdGlvbnMgb3IgZXhwbGljaXRseSB3aGVuIGl0J3MgbmV3LlxuICAgICAgLy8gU2luY2Ugd2UgZG9uJ3Qga25vdyBpZiBpdCdzIG5ldyBlYXNpbHkgd2l0aG91dCBxdWVyeWluZywgbGV0J3MgcXVlcnkgcXVpY2tseS5cbiAgICAgIGNvbnN0IG1zZ3MgPSBnZXRNZXNzYWdlc0Zyb21EYihjb252ZXJzYXRpb25JZCwgMTApO1xuICAgICAgaWYgKG1zZ3MubGVuZ3RoIDw9IDIgJiYgIXRvb2xUaXRsZSkge1xuICAgICAgICAgLy8gRmlyZSBhbmQgZm9yZ2V0IC0gZG9uJ3QgYXdhaXRcbiAgICAgICAgIGdlbmVyYXRlVGl0bGUobWVzc2FnZSwgYWlSZXBseSkudGhlbihuZXdUaXRsZSA9PiB7XG4gICAgICAgICAgICBpZiAobmV3VGl0bGUpIHtcbiAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKGBVcGRhdGluZyB0aXRsZSBmb3IgJHtjb252ZXJzYXRpb25JZH0gdG86ICR7bmV3VGl0bGV9YCk7XG4gICAgICAgICAgICAgICB1cGRhdGVDb252ZXJzYXRpb25UaXRsZShjb252ZXJzYXRpb25JZCwgbmV3VGl0bGUpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgfSkuY2F0Y2goZXJyID0+IGNvbnNvbGUuZXJyb3IoXCJBc3luYyBUaXRsZSBHZW4gRXJyb3I6XCIsIGVycikpO1xuICAgICAgfVxuXG4gICAgfSBjYXRjaCAoZGJFcnJvcikge1xuICAgICAgY29uc29sZS5lcnJvcihcIkRCIFNhdmUgRXJyb3IgKEFJKTpcIiwgZGJFcnJvcik7XG4gICAgfVxuXG4gICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKHtcbiAgICAgIHJlcGx5OiBhaVJlcGx5LFxuICAgICAgZGVidWdfaW5mbzogZGVidWdJbmZvXG4gICAgfSk7XG5cbiAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICBjb25zb2xlLmVycm9yKFwiQVBJIEVycm9yOlwiLCBlcnJvcik7XG4gICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKFxuICAgICAgeyBlcnJvcjogXCJJbnRlcm5hbCBTZXJ2ZXIgRXJyb3JcIiB9LFxuICAgICAgeyBzdGF0dXM6IDUwMCB9XG4gICAgKTtcbiAgfVxufVxuIl0sIm5hbWVzIjpbIk5leHRSZXNwb25zZSIsInN0YWdlMV9hbmFseXplIiwiZ2V0UmVjZW50SGlzdG9yeSIsInN0YWdlM1RoaW5rIiwic3RhZ2U0UmVwbHkiLCJzdGFnZTVQcm9maWxlIiwiZ2VuZXJhdGVUaXRsZSIsInNhdmVNZXNzYWdlVG9EYiIsInVwZGF0ZUNvbnZlcnNhdGlvblRpdGxlIiwidXBkYXRlQ29udmVyc2F0aW9uVG9vbCIsImdldE1lc3NhZ2VzRnJvbURiIiwiZXhlY3V0aXZlVG9vbHMiLCJncm93VGVtcGxhdGUiLCJjbGVhbkpzb25CbG9jayIsInRleHQiLCJqc29uRmVuY2UiLCJtYXRjaCIsInRyaW0iLCJnZW5lcmljRmVuY2UiLCJidWlsZExpc3QiLCJpdGVtcyIsIm1hcCIsIml0ZW0iLCJqb2luIiwiYnVpbGRHcm93Q2FyZEh0bWwiLCJwYXlsb2FkIiwiZ29hbCIsInJlYWxpdHlMaXN0IiwicmVhbGl0eSIsInNsaWNlIiwib3B0aW9uc0xpc3QiLCJvcHRpb25zIiwid2lsbExpc3QiLCJ3aWxsIiwic2xvZ2FuQ24iLCJmb290ZXJTdWIiLCJyZXBsYWNlIiwiUE9TVCIsInJlcXVlc3QiLCJtZXNzYWdlIiwiY29udmVyc2F0aW9uSWQiLCJ0b29sSWQiLCJ0b29sVGl0bGUiLCJqc29uIiwiZXJyb3IiLCJzdGF0dXMiLCJleGlzdGluZyIsImxlbmd0aCIsInJvbGUiLCJkYkVycm9yIiwiY29uc29sZSIsIm1lbW9yeSIsImFuYWx5c2lzUmVzdWx0IiwicHJvZmlsZVJlc3VsdCIsIlByb21pc2UiLCJhbGxTZXR0bGVkIiwiYW5hbHlzaXMiLCJ2YWx1ZSIsImludGVudCIsInNlbnRpbWVudCIsImNvbXBsZXhpdHkiLCJrZXl3b3JkcyIsInJlYXNvbiIsInVzZXJQcm9maWxlIiwidG9vbCIsImZpbmQiLCJpZCIsInNob3VsZEdlbmVyYXRlR3Jvd1NhbXBsZSIsInRlc3QiLCJzaG91bGRHZW5lcmF0ZUdyb3dDYXJkIiwic3RyYXRlZ3kiLCJhaVJlcGx5IiwicHJvbXB0Iiwic2FtcGxlQ2FzZSIsImRhdGFQcm9tcHQiLCJqc29uVGV4dCIsIkpTT04iLCJwYXJzZSIsImZhbGxiYWNrUGF5bG9hZCIsImh0bWwiLCJkZWJ1Z0luZm8iLCJzdGFnZTEiLCJzdGFnZTJfbWVtb3J5Iiwic3RhZ2UzX3N0cmF0ZWd5Iiwic3RhZ2U1X3Byb2ZpbGUiLCJzdHJpbmdpZnkiLCJtc2dzIiwidGhlbiIsIm5ld1RpdGxlIiwibG9nIiwiY2F0Y2giLCJlcnIiLCJyZXBseSIsImRlYnVnX2luZm8iXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./app/api/chat/route.ts\n");

/***/ }),

/***/ "(rsc)/./lib/db.ts":
/*!*******************!*\
  !*** ./lib/db.ts ***!
  \*******************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   createConversation: () => (/* binding */ createConversation),\n/* harmony export */   deleteConversation: () => (/* binding */ deleteConversation),\n/* harmony export */   getConversationsFromDb: () => (/* binding */ getConversationsFromDb),\n/* harmony export */   getDb: () => (/* binding */ getDb),\n/* harmony export */   getMessagesFromDb: () => (/* binding */ getMessagesFromDb),\n/* harmony export */   getUserProfileFromDb: () => (/* binding */ getUserProfileFromDb),\n/* harmony export */   saveMessageToDb: () => (/* binding */ saveMessageToDb),\n/* harmony export */   saveUserProfileToDb: () => (/* binding */ saveUserProfileToDb),\n/* harmony export */   updateConversationTitle: () => (/* binding */ updateConversationTitle),\n/* harmony export */   updateConversationTool: () => (/* binding */ updateConversationTool)\n/* harmony export */ });\n/* harmony import */ var path__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! path */ \"path\");\n/* harmony import */ var path__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(path__WEBPACK_IMPORTED_MODULE_0__);\n\nconst { DatabaseSync } = __webpack_require__(/*! node:sqlite */ \"node:sqlite\");\nconst dbPath = path__WEBPACK_IMPORTED_MODULE_0___default().join(process.cwd(), \"sqlite.db\");\n// Use a global variable to store the database instance in development\n// to prevent multiple connections during hot reloading\nconst globalForDb = global;\nconst getDb = ()=>{\n    if (!globalForDb.dbInstance) {\n        globalForDb.dbInstance = new DatabaseSync(dbPath);\n        // Initialize tables only once when connection is established\n        initializeSchema(globalForDb.dbInstance);\n    }\n    return globalForDb.dbInstance;\n};\nconst initializeSchema = (db)=>{\n    db.exec(`CREATE TABLE IF NOT EXISTS conversations (\n       id TEXT PRIMARY KEY, \n       title TEXT NOT NULL, \n       created_at TEXT NOT NULL,\n       updated_at TEXT NOT NULL,\n       tool_id TEXT\n     )`);\n    db.exec(`CREATE TABLE IF NOT EXISTS messages (\n       id INTEGER PRIMARY KEY AUTOINCREMENT, \n       conversation_id TEXT NOT NULL,\n       role TEXT NOT NULL, \n       content TEXT NOT NULL, \n       created_at TEXT NOT NULL\n     )`);\n    // New Table: User Profiles\n    db.exec(`CREATE TABLE IF NOT EXISTS user_profiles (\n       id INTEGER PRIMARY KEY AUTOINCREMENT,\n       tags TEXT NOT NULL,\n       personality TEXT NOT NULL,\n       leadership_level TEXT NOT NULL,\n       last_updated TEXT NOT NULL\n     )`);\n    // Check if conversation_id column exists in messages table\n    try {\n        const columns = db.prepare(\"PRAGMA table_info(messages)\").all();\n        const hasConversationId = columns.some((col)=>col.name === \"conversation_id\");\n        if (!hasConversationId) {\n            db.exec(\"ALTER TABLE messages ADD COLUMN conversation_id TEXT\");\n        }\n    } catch (e) {\n        console.error(\"Schema migration error (messages):\", e);\n    }\n    // Check if updated_at column exists in conversations table\n    try {\n        const columns = db.prepare(\"PRAGMA table_info(conversations)\").all();\n        const hasUpdatedAt = columns.some((col)=>col.name === \"updated_at\");\n        if (!hasUpdatedAt) {\n            // Add column and backfill with created_at value\n            db.exec(\"ALTER TABLE conversations ADD COLUMN updated_at TEXT\");\n            db.exec(\"UPDATE conversations SET updated_at = created_at WHERE updated_at IS NULL\");\n        }\n    } catch (e) {\n        console.error(\"Schema migration error (conversations):\", e);\n    }\n    try {\n        const columns = db.prepare(\"PRAGMA table_info(conversations)\").all();\n        const hasToolId = columns.some((col)=>col.name === \"tool_id\");\n        if (!hasToolId) {\n            db.exec(\"ALTER TABLE conversations ADD COLUMN tool_id TEXT\");\n        }\n    } catch (e) {\n        console.error(\"Schema migration error (conversations tool_id):\", e);\n    }\n    // Check if kind and metadata columns exist in messages table\n    try {\n        const columns = db.prepare(\"PRAGMA table_info(messages)\").all();\n        const hasKind = columns.some((col)=>col.name === \"kind\");\n        const hasMetadata = columns.some((col)=>col.name === \"metadata\");\n        if (!hasKind) {\n            db.exec(\"ALTER TABLE messages ADD COLUMN kind TEXT DEFAULT 'text'\");\n        }\n        if (!hasMetadata) {\n            db.exec(\"ALTER TABLE messages ADD COLUMN metadata TEXT\");\n        }\n    } catch (e) {\n        console.error(\"Schema migration error (messages extra columns):\", e);\n    }\n};\n// Helper to create or update a conversation\nconst createConversation = (id, title, toolId = null)=>{\n    const db = getDb();\n    // Check if exists\n    const exists = db.prepare(\"SELECT 1 FROM conversations WHERE id = ?\").get(id);\n    if (!exists) {\n        const now = new Date().toISOString();\n        const stmt = db.prepare(\"INSERT INTO conversations (id, title, created_at, updated_at, tool_id) VALUES (?, ?, ?, ?, ?)\");\n        stmt.run(id, title, now, now, toolId);\n    }\n};\n// Helper to update conversation title\nconst updateConversationTitle = (id, newTitle)=>{\n    const db = getDb();\n    const stmt = db.prepare(\"UPDATE conversations SET title = ? WHERE id = ?\");\n    stmt.run(newTitle, id);\n};\nconst updateConversationTool = (id, toolId)=>{\n    const db = getDb();\n    const stmt = db.prepare(\"UPDATE conversations SET tool_id = ? WHERE id = ?\");\n    stmt.run(toolId, id);\n};\n// Helper to get all conversations\nconst getConversationsFromDb = ()=>{\n    const db = getDb();\n    // Sort by updated_at DESC (recently active first)\n    const stmt = db.prepare(\"SELECT id, title, created_at, updated_at, tool_id FROM conversations ORDER BY updated_at DESC\");\n    return stmt.all();\n};\n// Helper to save a message\nconst saveMessageToDb = (conversationId, role, content, kind = \"text\", metadata = null)=>{\n    const db = getDb();\n    // Ensure conversation exists. If not, create it with a default title or snippet.\n    // In a real app, we might want to generate a title from the first message.\n    const exists = db.prepare(\"SELECT 1 FROM conversations WHERE id = ?\").get(conversationId);\n    if (!exists) {\n        // Create a default title using the first 20 chars of content if it's a user message, else \"New Chat\"\n        const title = role === \"user\" ? content.slice(0, 20) + (content.length > 20 ? \"...\" : \"\") : \"New Chat\";\n        createConversation(conversationId, title);\n    }\n    const now = new Date().toISOString();\n    const stmt = db.prepare(\"INSERT INTO messages (conversation_id, role, content, created_at, kind, metadata) VALUES (?, ?, ?, ?, ?, ?)\");\n    stmt.run(conversationId, role, content, now, kind, metadata);\n    // Update conversation updated_at\n    const updateStmt = db.prepare(\"UPDATE conversations SET updated_at = ? WHERE id = ?\");\n    updateStmt.run(now, conversationId);\n};\n// Helper to get recent messages\nconst getMessagesFromDb = (conversationId, limit = 10)=>{\n    const db = getDb();\n    // Get last N messages for specific conversation, then reverse to chronological order\n    const stmt = db.prepare(`SELECT id, role, content, created_at, kind, metadata FROM messages WHERE conversation_id = ? ORDER BY id DESC LIMIT ?`);\n    const rows = stmt.all(conversationId, limit);\n    return rows.reverse();\n};\n// Helper to get user profile (get the latest one)\nconst getUserProfileFromDb = ()=>{\n    const db = getDb();\n    const stmt = db.prepare(\"SELECT * FROM user_profiles ORDER BY id DESC LIMIT 1\");\n    const row = stmt.get();\n    if (!row) return null;\n    let rawTags = {};\n    try {\n        rawTags = JSON.parse(row.tags);\n    } catch (e) {\n        console.error(\"Failed to parse profile tags\", e);\n    }\n    // Runtime Migration: Convert old string tags to new ProfileValue structure\n    const demographics = {};\n    for (const [key, val] of Object.entries(rawTags)){\n        if (typeof val === \"string\") {\n            // Old format: just string value\n            demographics[key] = {\n                value: val,\n                confidence: 50\n            }; // Default low confidence for legacy data\n        } else {\n            // New format: already object\n            demographics[key] = val;\n        }\n    }\n    return {\n        demographics: demographics,\n        personality: row.personality,\n        leadership_level: JSON.parse(row.leadership_level),\n        last_updated: row.last_updated\n    };\n};\n// Helper to delete a conversation and its messages\nconst deleteConversation = (id)=>{\n    const db = getDb();\n    // Delete messages first\n    const deleteMessagesStmt = db.prepare(\"DELETE FROM messages WHERE conversation_id = ?\");\n    deleteMessagesStmt.run(id);\n    // Delete conversation\n    const deleteConvStmt = db.prepare(\"DELETE FROM conversations WHERE id = ?\");\n    deleteConvStmt.run(id);\n};\n// Helper to save user profile\nconst saveUserProfileToDb = (profile)=>{\n    const db = getDb();\n    const stmt = db.prepare(\"INSERT INTO user_profiles (tags, personality, leadership_level, last_updated) VALUES (?, ?, ?, ?)\");\n    stmt.run(JSON.stringify(profile.demographics), profile.personality, JSON.stringify(profile.leadership_level), new Date().toISOString());\n};\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QUF5QztRQUMvRixPQUFPO1lBQ0wsNkJBQTZCO1lBQzdCTixZQUFZLENBQUNDLElBQUksR0FBR0M7UUFDdEI7SUFDRjtJQUVBLE9BQU87UUFDTEYsY0FBY0E7UUFDZE8sYUFBYVosSUFBSVksV0FBVztRQUM1QkMsa0JBQWtCWCxLQUFLQyxLQUFLLENBQUNILElBQUlhLGdCQUFnQjtRQUNqREMsY0FBY2QsSUFBSWMsWUFBWTtJQUNoQztBQUNGLEVBQUU7QUFFRixtREFBbUQ7QUFDNUMsTUFBTUMscUJBQXFCLENBQUMzQztJQUNqQyxNQUFNakIsS0FBS0g7SUFDWCx3QkFBd0I7SUFDeEIsTUFBTWdFLHFCQUFxQjdELEdBQUdHLE9BQU8sQ0FBQztJQUN0QzBELG1CQUFtQm5DLEdBQUcsQ0FBQ1Q7SUFFdkIsc0JBQXNCO0lBQ3RCLE1BQU02QyxpQkFBaUI5RCxHQUFHRyxPQUFPLENBQUM7SUFDbEMyRCxlQUFlcEMsR0FBRyxDQUFDVDtBQUNyQixFQUFFO0FBRUYsOEJBQThCO0FBQ3ZCLE1BQU04QyxzQkFBc0IsQ0FBQ0M7SUFDbEMsTUFBTWhFLEtBQUtIO0lBQ1gsTUFBTTRCLE9BQU96QixHQUFHRyxPQUFPLENBQ3JCO0lBRUZzQixLQUFLQyxHQUFHLENBQ05xQixLQUFLa0IsU0FBUyxDQUFDRCxRQUFRZCxZQUFZLEdBQ25DYyxRQUFRUCxXQUFXLEVBQ25CVixLQUFLa0IsU0FBUyxDQUFDRCxRQUFRTixnQkFBZ0IsR0FDdkMsSUFBSW5DLE9BQU9DLFdBQVc7QUFFMUIsRUFBRSIsInNvdXJjZXMiOlsid2VicGFjazovL2FpLWNvYWNoLWZyb250ZW5kLy4vbGliL2RiLnRzPzFkZjAiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHBhdGggZnJvbSBcInBhdGhcIjtcbmltcG9ydCB7IFVzZXJQcm9maWxlIH0gZnJvbSBcIi4vdHlwZXNcIjtcblxudHlwZSBEYXRhYmFzZVN0YXRlbWVudCA9IHtcbiAgYWxsOiAoLi4uYXJnczogdW5rbm93bltdKSA9PiB1bmtub3duW107XG4gIGdldDogKC4uLmFyZ3M6IHVua25vd25bXSkgPT4gdW5rbm93bjtcbiAgcnVuOiAoLi4uYXJnczogdW5rbm93bltdKSA9PiB1bmtub3duO1xufTtcblxudHlwZSBEYXRhYmFzZVN5bmMgPSB7XG4gIGV4ZWM6IChzcWw6IHN0cmluZykgPT4gdm9pZDtcbiAgcHJlcGFyZTogKHNxbDogc3RyaW5nKSA9PiBEYXRhYmFzZVN0YXRlbWVudDtcbn07XG5cbmNvbnN0IHsgRGF0YWJhc2VTeW5jIH0gPSByZXF1aXJlKFwibm9kZTpzcWxpdGVcIikgYXMgeyBEYXRhYmFzZVN5bmM6IG5ldyAocGF0aDogc3RyaW5nKSA9PiBEYXRhYmFzZVN5bmMgfTtcblxuY29uc3QgZGJQYXRoID0gcGF0aC5qb2luKHByb2Nlc3MuY3dkKCksIFwic3FsaXRlLmRiXCIpO1xuXG4vLyBVc2UgYSBnbG9iYWwgdmFyaWFibGUgdG8gc3RvcmUgdGhlIGRhdGFiYXNlIGluc3RhbmNlIGluIGRldmVsb3BtZW50XG4vLyB0byBwcmV2ZW50IG11bHRpcGxlIGNvbm5lY3Rpb25zIGR1cmluZyBob3QgcmVsb2FkaW5nXG5jb25zdCBnbG9iYWxGb3JEYiA9IGdsb2JhbCBhcyB1bmtub3duIGFzIHsgZGJJbnN0YW5jZTogRGF0YWJhc2VTeW5jIHwgdW5kZWZpbmVkIH07XG5cbmV4cG9ydCBjb25zdCBnZXREYiA9ICgpID0+IHtcbiAgaWYgKCFnbG9iYWxGb3JEYi5kYkluc3RhbmNlKSB7XG4gICAgZ2xvYmFsRm9yRGIuZGJJbnN0YW5jZSA9IG5ldyBEYXRhYmFzZVN5bmMoZGJQYXRoKTtcbiAgICBcbiAgICAvLyBJbml0aWFsaXplIHRhYmxlcyBvbmx5IG9uY2Ugd2hlbiBjb25uZWN0aW9uIGlzIGVzdGFibGlzaGVkXG4gICAgaW5pdGlhbGl6ZVNjaGVtYShnbG9iYWxGb3JEYi5kYkluc3RhbmNlKTtcbiAgfVxuICByZXR1cm4gZ2xvYmFsRm9yRGIuZGJJbnN0YW5jZTtcbn07XG5cbmNvbnN0IGluaXRpYWxpemVTY2hlbWEgPSAoZGI6IERhdGFiYXNlU3luYykgPT4ge1xuICBkYi5leGVjKFxuICAgIGBDUkVBVEUgVEFCTEUgSUYgTk9UIEVYSVNUUyBjb252ZXJzYXRpb25zIChcbiAgICAgICBpZCBURVhUIFBSSU1BUlkgS0VZLCBcbiAgICAgICB0aXRsZSBURVhUIE5PVCBOVUxMLCBcbiAgICAgICBjcmVhdGVkX2F0IFRFWFQgTk9UIE5VTEwsXG4gICAgICAgdXBkYXRlZF9hdCBURVhUIE5PVCBOVUxMLFxuICAgICAgIHRvb2xfaWQgVEVYVFxuICAgICApYFxuICApO1xuICBkYi5leGVjKFxuICAgIGBDUkVBVEUgVEFCTEUgSUYgTk9UIEVYSVNUUyBtZXNzYWdlcyAoXG4gICAgICAgaWQgSU5URUdFUiBQUklNQVJZIEtFWSBBVVRPSU5DUkVNRU5ULCBcbiAgICAgICBjb252ZXJzYXRpb25faWQgVEVYVCBOT1QgTlVMTCxcbiAgICAgICByb2xlIFRFWFQgTk9UIE5VTEwsIFxuICAgICAgIGNvbnRlbnQgVEVYVCBOT1QgTlVMTCwgXG4gICAgICAgY3JlYXRlZF9hdCBURVhUIE5PVCBOVUxMXG4gICAgIClgXG4gICk7XG4gIFxuICAvLyBOZXcgVGFibGU6IFVzZXIgUHJvZmlsZXNcbiAgZGIuZXhlYyhcbiAgICBgQ1JFQVRFIFRBQkxFIElGIE5PVCBFWElTVFMgdXNlcl9wcm9maWxlcyAoXG4gICAgICAgaWQgSU5URUdFUiBQUklNQVJZIEtFWSBBVVRPSU5DUkVNRU5ULFxuICAgICAgIHRhZ3MgVEVYVCBOT1QgTlVMTCxcbiAgICAgICBwZXJzb25hbGl0eSBURVhUIE5PVCBOVUxMLFxuICAgICAgIGxlYWRlcnNoaXBfbGV2ZWwgVEVYVCBOT1QgTlVMTCxcbiAgICAgICBsYXN0X3VwZGF0ZWQgVEVYVCBOT1QgTlVMTFxuICAgICApYFxuICApO1xuICBcbiAgLy8gQ2hlY2sgaWYgY29udmVyc2F0aW9uX2lkIGNvbHVtbiBleGlzdHMgaW4gbWVzc2FnZXMgdGFibGVcbiAgdHJ5IHtcbiAgICBjb25zdCBjb2x1bW5zID0gZGIucHJlcGFyZShcIlBSQUdNQSB0YWJsZV9pbmZvKG1lc3NhZ2VzKVwiKS5hbGwoKSBhcyBhbnlbXTtcbiAgICBjb25zdCBoYXNDb252ZXJzYXRpb25JZCA9IGNvbHVtbnMuc29tZShjb2wgPT4gY29sLm5hbWUgPT09IFwiY29udmVyc2F0aW9uX2lkXCIpO1xuICAgIFxuICAgIGlmICghaGFzQ29udmVyc2F0aW9uSWQpIHtcbiAgICAgICBkYi5leGVjKFwiQUxURVIgVEFCTEUgbWVzc2FnZXMgQUREIENPTFVNTiBjb252ZXJzYXRpb25faWQgVEVYVFwiKTtcbiAgICB9XG4gIH0gY2F0Y2ggKGUpIHtcbiAgICBjb25zb2xlLmVycm9yKFwiU2NoZW1hIG1pZ3JhdGlvbiBlcnJvciAobWVzc2FnZXMpOlwiLCBlKTtcbiAgfVxuXG4gIC8vIENoZWNrIGlmIHVwZGF0ZWRfYXQgY29sdW1uIGV4aXN0cyBpbiBjb252ZXJzYXRpb25zIHRhYmxlXG4gIHRyeSB7XG4gICAgY29uc3QgY29sdW1ucyA9IGRiLnByZXBhcmUoXCJQUkFHTUEgdGFibGVfaW5mbyhjb252ZXJzYXRpb25zKVwiKS5hbGwoKSBhcyBhbnlbXTtcbiAgICBjb25zdCBoYXNVcGRhdGVkQXQgPSBjb2x1bW5zLnNvbWUoY29sID0+IGNvbC5uYW1lID09PSBcInVwZGF0ZWRfYXRcIik7XG4gICAgXG4gICAgaWYgKCFoYXNVcGRhdGVkQXQpIHtcbiAgICAgICAvLyBBZGQgY29sdW1uIGFuZCBiYWNrZmlsbCB3aXRoIGNyZWF0ZWRfYXQgdmFsdWVcbiAgICAgICBkYi5leGVjKFwiQUxURVIgVEFCTEUgY29udmVyc2F0aW9ucyBBREQgQ09MVU1OIHVwZGF0ZWRfYXQgVEVYVFwiKTtcbiAgICAgICBkYi5leGVjKFwiVVBEQVRFIGNvbnZlcnNhdGlvbnMgU0VUIHVwZGF0ZWRfYXQgPSBjcmVhdGVkX2F0IFdIRVJFIHVwZGF0ZWRfYXQgSVMgTlVMTFwiKTtcbiAgICB9XG4gIH0gY2F0Y2ggKGUpIHtcbiAgICBjb25zb2xlLmVycm9yKFwiU2NoZW1hIG1pZ3JhdGlvbiBlcnJvciAoY29udmVyc2F0aW9ucyk6XCIsIGUpO1xuICB9XG5cbiAgdHJ5IHtcbiAgICBjb25zdCBjb2x1bW5zID0gZGIucHJlcGFyZShcIlBSQUdNQSB0YWJsZV9pbmZvKGNvbnZlcnNhdGlvbnMpXCIpLmFsbCgpIGFzIGFueVtdO1xuICAgIGNvbnN0IGhhc1Rvb2xJZCA9IGNvbHVtbnMuc29tZShjb2wgPT4gY29sLm5hbWUgPT09IFwidG9vbF9pZFwiKTtcbiAgICBpZiAoIWhhc1Rvb2xJZCkge1xuICAgICAgZGIuZXhlYyhcIkFMVEVSIFRBQkxFIGNvbnZlcnNhdGlvbnMgQUREIENPTFVNTiB0b29sX2lkIFRFWFRcIik7XG4gICAgfVxuICB9IGNhdGNoIChlKSB7XG4gICAgY29uc29sZS5lcnJvcihcIlNjaGVtYSBtaWdyYXRpb24gZXJyb3IgKGNvbnZlcnNhdGlvbnMgdG9vbF9pZCk6XCIsIGUpO1xuICB9XG5cbiAgLy8gQ2hlY2sgaWYga2luZCBhbmQgbWV0YWRhdGEgY29sdW1ucyBleGlzdCBpbiBtZXNzYWdlcyB0YWJsZVxuICB0cnkge1xuICAgIGNvbnN0IGNvbHVtbnMgPSBkYi5wcmVwYXJlKFwiUFJBR01BIHRhYmxlX2luZm8obWVzc2FnZXMpXCIpLmFsbCgpIGFzIGFueVtdO1xuICAgIGNvbnN0IGhhc0tpbmQgPSBjb2x1bW5zLnNvbWUoY29sID0+IGNvbC5uYW1lID09PSBcImtpbmRcIik7XG4gICAgY29uc3QgaGFzTWV0YWRhdGEgPSBjb2x1bW5zLnNvbWUoY29sID0+IGNvbC5uYW1lID09PSBcIm1ldGFkYXRhXCIpO1xuICAgIFxuICAgIGlmICghaGFzS2luZCkge1xuICAgICAgIGRiLmV4ZWMoXCJBTFRFUiBUQUJMRSBtZXNzYWdlcyBBREQgQ09MVU1OIGtpbmQgVEVYVCBERUZBVUxUICd0ZXh0J1wiKTtcbiAgICB9XG4gICAgaWYgKCFoYXNNZXRhZGF0YSkge1xuICAgICAgIGRiLmV4ZWMoXCJBTFRFUiBUQUJMRSBtZXNzYWdlcyBBREQgQ09MVU1OIG1ldGFkYXRhIFRFWFRcIik7XG4gICAgfVxuICB9IGNhdGNoIChlKSB7XG4gICAgY29uc29sZS5lcnJvcihcIlNjaGVtYSBtaWdyYXRpb24gZXJyb3IgKG1lc3NhZ2VzIGV4dHJhIGNvbHVtbnMpOlwiLCBlKTtcbiAgfVxufTtcblxuLy8gSGVscGVyIHRvIGNyZWF0ZSBvciB1cGRhdGUgYSBjb252ZXJzYXRpb25cbmV4cG9ydCBjb25zdCBjcmVhdGVDb252ZXJzYXRpb24gPSAoaWQ6IHN0cmluZywgdGl0bGU6IHN0cmluZywgdG9vbElkOiBzdHJpbmcgfCBudWxsID0gbnVsbCkgPT4ge1xuICBjb25zdCBkYiA9IGdldERiKCk7XG4gIC8vIENoZWNrIGlmIGV4aXN0c1xuICBjb25zdCBleGlzdHMgPSBkYi5wcmVwYXJlKFwiU0VMRUNUIDEgRlJPTSBjb252ZXJzYXRpb25zIFdIRVJFIGlkID0gP1wiKS5nZXQoaWQpO1xuICBpZiAoIWV4aXN0cykge1xuICAgIGNvbnN0IG5vdyA9IG5ldyBEYXRlKCkudG9JU09TdHJpbmcoKTtcbiAgICBjb25zdCBzdG10ID0gZGIucHJlcGFyZShcIklOU0VSVCBJTlRPIGNvbnZlcnNhdGlvbnMgKGlkLCB0aXRsZSwgY3JlYXRlZF9hdCwgdXBkYXRlZF9hdCwgdG9vbF9pZCkgVkFMVUVTICg/LCA/LCA/LCA/LCA/KVwiKTtcbiAgICBzdG10LnJ1bihpZCwgdGl0bGUsIG5vdywgbm93LCB0b29sSWQpO1xuICB9XG59O1xuXG4vLyBIZWxwZXIgdG8gdXBkYXRlIGNvbnZlcnNhdGlvbiB0aXRsZVxuZXhwb3J0IGNvbnN0IHVwZGF0ZUNvbnZlcnNhdGlvblRpdGxlID0gKGlkOiBzdHJpbmcsIG5ld1RpdGxlOiBzdHJpbmcpID0+IHtcbiAgY29uc3QgZGIgPSBnZXREYigpO1xuICBjb25zdCBzdG10ID0gZGIucHJlcGFyZShcIlVQREFURSBjb252ZXJzYXRpb25zIFNFVCB0aXRsZSA9ID8gV0hFUkUgaWQgPSA/XCIpO1xuICBzdG10LnJ1bihuZXdUaXRsZSwgaWQpO1xufTtcblxuZXhwb3J0IGNvbnN0IHVwZGF0ZUNvbnZlcnNhdGlvblRvb2wgPSAoaWQ6IHN0cmluZywgdG9vbElkOiBzdHJpbmcgfCBudWxsKSA9PiB7XG4gIGNvbnN0IGRiID0gZ2V0RGIoKTtcbiAgY29uc3Qgc3RtdCA9IGRiLnByZXBhcmUoXCJVUERBVEUgY29udmVyc2F0aW9ucyBTRVQgdG9vbF9pZCA9ID8gV0hFUkUgaWQgPSA/XCIpO1xuICBzdG10LnJ1bih0b29sSWQsIGlkKTtcbn07XG5cbi8vIEhlbHBlciB0byBnZXQgYWxsIGNvbnZlcnNhdGlvbnNcbmV4cG9ydCBjb25zdCBnZXRDb252ZXJzYXRpb25zRnJvbURiID0gKCkgPT4ge1xuICBjb25zdCBkYiA9IGdldERiKCk7XG4gIC8vIFNvcnQgYnkgdXBkYXRlZF9hdCBERVNDIChyZWNlbnRseSBhY3RpdmUgZmlyc3QpXG4gIGNvbnN0IHN0bXQgPSBkYi5wcmVwYXJlKFwiU0VMRUNUIGlkLCB0aXRsZSwgY3JlYXRlZF9hdCwgdXBkYXRlZF9hdCwgdG9vbF9pZCBGUk9NIGNvbnZlcnNhdGlvbnMgT1JERVIgQlkgdXBkYXRlZF9hdCBERVNDXCIpO1xuICByZXR1cm4gc3RtdC5hbGwoKSBhcyB7IGlkOiBzdHJpbmc7IHRpdGxlOiBzdHJpbmc7IGNyZWF0ZWRfYXQ6IHN0cmluZzsgdXBkYXRlZF9hdDogc3RyaW5nOyB0b29sX2lkOiBzdHJpbmcgfCBudWxsIH1bXTtcbn07XG5cbi8vIEhlbHBlciB0byBzYXZlIGEgbWVzc2FnZVxuZXhwb3J0IGNvbnN0IHNhdmVNZXNzYWdlVG9EYiA9IChcbiAgY29udmVyc2F0aW9uSWQ6IHN0cmluZywgXG4gIHJvbGU6IFwidXNlclwiIHwgXCJhaVwiLCBcbiAgY29udGVudDogc3RyaW5nLFxuICBraW5kOiBcInRleHRcIiB8IFwiYW5hbHlzaXNcIiA9IFwidGV4dFwiLFxuICBtZXRhZGF0YTogc3RyaW5nIHwgbnVsbCA9IG51bGxcbikgPT4ge1xuICBjb25zdCBkYiA9IGdldERiKCk7XG4gIFxuICAvLyBFbnN1cmUgY29udmVyc2F0aW9uIGV4aXN0cy4gSWYgbm90LCBjcmVhdGUgaXQgd2l0aCBhIGRlZmF1bHQgdGl0bGUgb3Igc25pcHBldC5cbiAgLy8gSW4gYSByZWFsIGFwcCwgd2UgbWlnaHQgd2FudCB0byBnZW5lcmF0ZSBhIHRpdGxlIGZyb20gdGhlIGZpcnN0IG1lc3NhZ2UuXG4gIGNvbnN0IGV4aXN0cyA9IGRiLnByZXBhcmUoXCJTRUxFQ1QgMSBGUk9NIGNvbnZlcnNhdGlvbnMgV0hFUkUgaWQgPSA/XCIpLmdldChjb252ZXJzYXRpb25JZCk7XG4gIGlmICghZXhpc3RzKSB7XG4gICAgICAvLyBDcmVhdGUgYSBkZWZhdWx0IHRpdGxlIHVzaW5nIHRoZSBmaXJzdCAyMCBjaGFycyBvZiBjb250ZW50IGlmIGl0J3MgYSB1c2VyIG1lc3NhZ2UsIGVsc2UgXCJOZXcgQ2hhdFwiXG4gICAgICBjb25zdCB0aXRsZSA9IHJvbGUgPT09ICd1c2VyJyA/IChjb250ZW50LnNsaWNlKDAsIDIwKSArIChjb250ZW50Lmxlbmd0aCA+IDIwID8gXCIuLi5cIiA6IFwiXCIpKSA6IFwiTmV3IENoYXRcIjtcbiAgICAgIGNyZWF0ZUNvbnZlcnNhdGlvbihjb252ZXJzYXRpb25JZCwgdGl0bGUpO1xuICB9XG5cbiAgY29uc3Qgbm93ID0gbmV3IERhdGUoKS50b0lTT1N0cmluZygpO1xuICBjb25zdCBzdG10ID0gZGIucHJlcGFyZShcIklOU0VSVCBJTlRPIG1lc3NhZ2VzIChjb252ZXJzYXRpb25faWQsIHJvbGUsIGNvbnRlbnQsIGNyZWF0ZWRfYXQsIGtpbmQsIG1ldGFkYXRhKSBWQUxVRVMgKD8sID8sID8sID8sID8sID8pXCIpO1xuICBzdG10LnJ1bihjb252ZXJzYXRpb25JZCwgcm9sZSwgY29udGVudCwgbm93LCBraW5kLCBtZXRhZGF0YSk7XG5cbiAgLy8gVXBkYXRlIGNvbnZlcnNhdGlvbiB1cGRhdGVkX2F0XG4gIGNvbnN0IHVwZGF0ZVN0bXQgPSBkYi5wcmVwYXJlKFwiVVBEQVRFIGNvbnZlcnNhdGlvbnMgU0VUIHVwZGF0ZWRfYXQgPSA/IFdIRVJFIGlkID0gP1wiKTtcbiAgdXBkYXRlU3RtdC5ydW4obm93LCBjb252ZXJzYXRpb25JZCk7XG59O1xuXG4vLyBIZWxwZXIgdG8gZ2V0IHJlY2VudCBtZXNzYWdlc1xuZXhwb3J0IGNvbnN0IGdldE1lc3NhZ2VzRnJvbURiID0gKGNvbnZlcnNhdGlvbklkOiBzdHJpbmcsIGxpbWl0OiBudW1iZXIgPSAxMCkgPT4ge1xuICBjb25zdCBkYiA9IGdldERiKCk7XG4gIC8vIEdldCBsYXN0IE4gbWVzc2FnZXMgZm9yIHNwZWNpZmljIGNvbnZlcnNhdGlvbiwgdGhlbiByZXZlcnNlIHRvIGNocm9ub2xvZ2ljYWwgb3JkZXJcbiAgY29uc3Qgc3RtdCA9IGRiLnByZXBhcmUoYFNFTEVDVCBpZCwgcm9sZSwgY29udGVudCwgY3JlYXRlZF9hdCwga2luZCwgbWV0YWRhdGEgRlJPTSBtZXNzYWdlcyBXSEVSRSBjb252ZXJzYXRpb25faWQgPSA/IE9SREVSIEJZIGlkIERFU0MgTElNSVQgP2ApO1xuICBjb25zdCByb3dzID0gc3RtdC5hbGwoY29udmVyc2F0aW9uSWQsIGxpbWl0KTtcbiAgcmV0dXJuIChyb3dzIGFzIHsgaWQ6IG51bWJlcjsgcm9sZTogc3RyaW5nOyBjb250ZW50OiBzdHJpbmc7IGNyZWF0ZWRfYXQ6IHN0cmluZzsga2luZDogc3RyaW5nOyBtZXRhZGF0YTogc3RyaW5nIHwgbnVsbCB9W10pLnJldmVyc2UoKTtcbn07XG5cbi8vIEhlbHBlciB0byBnZXQgdXNlciBwcm9maWxlIChnZXQgdGhlIGxhdGVzdCBvbmUpXG5leHBvcnQgY29uc3QgZ2V0VXNlclByb2ZpbGVGcm9tRGIgPSAoKTogVXNlclByb2ZpbGUgfCBudWxsID0+IHtcbiAgY29uc3QgZGIgPSBnZXREYigpO1xuICBjb25zdCBzdG10ID0gZGIucHJlcGFyZShcIlNFTEVDVCAqIEZST00gdXNlcl9wcm9maWxlcyBPUkRFUiBCWSBpZCBERVNDIExJTUlUIDFcIik7XG4gIGNvbnN0IHJvdyA9IHN0bXQuZ2V0KCkgYXMgYW55O1xuICBcbiAgaWYgKCFyb3cpIHJldHVybiBudWxsO1xuICBcbiAgbGV0IHJhd1RhZ3MgPSB7fTtcbiAgdHJ5IHtcbiAgICByYXdUYWdzID0gSlNPTi5wYXJzZShyb3cudGFncyk7XG4gIH0gY2F0Y2ggKGUpIHtcbiAgICBjb25zb2xlLmVycm9yKFwiRmFpbGVkIHRvIHBhcnNlIHByb2ZpbGUgdGFnc1wiLCBlKTtcbiAgfVxuXG4gIC8vIFJ1bnRpbWUgTWlncmF0aW9uOiBDb252ZXJ0IG9sZCBzdHJpbmcgdGFncyB0byBuZXcgUHJvZmlsZVZhbHVlIHN0cnVjdHVyZVxuICBjb25zdCBkZW1vZ3JhcGhpY3M6IFJlY29yZDxzdHJpbmcsIGFueT4gPSB7fTtcbiAgZm9yIChjb25zdCBba2V5LCB2YWxdIG9mIE9iamVjdC5lbnRyaWVzKHJhd1RhZ3MpKSB7XG4gICAgaWYgKHR5cGVvZiB2YWwgPT09ICdzdHJpbmcnKSB7XG4gICAgICAvLyBPbGQgZm9ybWF0OiBqdXN0IHN0cmluZyB2YWx1ZVxuICAgICAgZGVtb2dyYXBoaWNzW2tleV0gPSB7IHZhbHVlOiB2YWwsIGNvbmZpZGVuY2U6IDUwIH07IC8vIERlZmF1bHQgbG93IGNvbmZpZGVuY2UgZm9yIGxlZ2FjeSBkYXRhXG4gICAgfSBlbHNlIHtcbiAgICAgIC8vIE5ldyBmb3JtYXQ6IGFscmVhZHkgb2JqZWN0XG4gICAgICBkZW1vZ3JhcGhpY3Nba2V5XSA9IHZhbDtcbiAgICB9XG4gIH1cblxuICByZXR1cm4ge1xuICAgIGRlbW9ncmFwaGljczogZGVtb2dyYXBoaWNzLFxuICAgIHBlcnNvbmFsaXR5OiByb3cucGVyc29uYWxpdHksXG4gICAgbGVhZGVyc2hpcF9sZXZlbDogSlNPTi5wYXJzZShyb3cubGVhZGVyc2hpcF9sZXZlbCksXG4gICAgbGFzdF91cGRhdGVkOiByb3cubGFzdF91cGRhdGVkXG4gIH07XG59O1xuXG4vLyBIZWxwZXIgdG8gZGVsZXRlIGEgY29udmVyc2F0aW9uIGFuZCBpdHMgbWVzc2FnZXNcbmV4cG9ydCBjb25zdCBkZWxldGVDb252ZXJzYXRpb24gPSAoaWQ6IHN0cmluZykgPT4ge1xuICBjb25zdCBkYiA9IGdldERiKCk7XG4gIC8vIERlbGV0ZSBtZXNzYWdlcyBmaXJzdFxuICBjb25zdCBkZWxldGVNZXNzYWdlc1N0bXQgPSBkYi5wcmVwYXJlKFwiREVMRVRFIEZST00gbWVzc2FnZXMgV0hFUkUgY29udmVyc2F0aW9uX2lkID0gP1wiKTtcbiAgZGVsZXRlTWVzc2FnZXNTdG10LnJ1bihpZCk7XG5cbiAgLy8gRGVsZXRlIGNvbnZlcnNhdGlvblxuICBjb25zdCBkZWxldGVDb252U3RtdCA9IGRiLnByZXBhcmUoXCJERUxFVEUgRlJPTSBjb252ZXJzYXRpb25zIFdIRVJFIGlkID0gP1wiKTtcbiAgZGVsZXRlQ29udlN0bXQucnVuKGlkKTtcbn07XG5cbi8vIEhlbHBlciB0byBzYXZlIHVzZXIgcHJvZmlsZVxuZXhwb3J0IGNvbnN0IHNhdmVVc2VyUHJvZmlsZVRvRGIgPSAocHJvZmlsZTogVXNlclByb2ZpbGUpID0+IHtcbiAgY29uc3QgZGIgPSBnZXREYigpO1xuICBjb25zdCBzdG10ID0gZGIucHJlcGFyZShcbiAgICBcIklOU0VSVCBJTlRPIHVzZXJfcHJvZmlsZXMgKHRhZ3MsIHBlcnNvbmFsaXR5LCBsZWFkZXJzaGlwX2xldmVsLCBsYXN0X3VwZGF0ZWQpIFZBTFVFUyAoPywgPywgPywgPylcIlxuICApO1xuICBzdG10LnJ1bihcbiAgICBKU09OLnN0cmluZ2lmeShwcm9maWxlLmRlbW9ncmFwaGljcyksIFxuICAgIHByb2ZpbGUucGVyc29uYWxpdHksIFxuICAgIEpTT04uc3RyaW5naWZ5KHByb2ZpbGUubGVhZGVyc2hpcF9sZXZlbCksIFxuICAgIG5ldyBEYXRlKCkudG9JU09TdHJpbmcoKVxuICApO1xufTtcbiJdLCJuYW1lcyI6WyJwYXRoIiwiRGF0YWJhc2VTeW5jIiwicmVxdWlyZSIsImRiUGF0aCIsImpvaW4iLCJwcm9jZXNzIiwiY3dkIiwiZ2xvYmFsRm9yRGIiLCJnbG9iYWwiLCJnZXREYiIsImRiSW5zdGFuY2UiLCJpbml0aWFsaXplU2NoZW1hIiwiZGIiLCJleGVjIiwiY29sdW1ucyIsInByZXBhcmUiLCJhbGwiLCJoYXNDb252ZXJzYXRpb25JZCIsInNvbWUiLCJjb2wiLCJuYW1lIiwiZSIsImNvbnNvbGUiLCJlcnJvciIsImhhc1VwZGF0ZWRBdCIsImhhc1Rvb2xJZCIsImhhc0tpbmQiLCJoYXNNZXRhZGF0YSIsImNyZWF0ZUNvbnZlcnNhdGlvbiIsImlkIiwidGl0bGUiLCJ0b29sSWQiLCJleGlzdHMiLCJnZXQiLCJub3ciLCJEYXRlIiwidG9JU09TdHJpbmciLCJzdG10IiwicnVuIiwidXBkYXRlQ29udmVyc2F0aW9uVGl0bGUiLCJuZXdUaXRsZSIsInVwZGF0ZUNvbnZlcnNhdGlvblRvb2wiLCJnZXRDb252ZXJzYXRpb25zRnJvbURiIiwic2F2ZU1lc3NhZ2VUb0RiIiwiY29udmVyc2F0aW9uSWQiLCJyb2xlIiwiY29udGVudCIsImtpbmQiLCJtZXRhZGF0YSIsInNsaWNlIiwibGVuZ3RoIiwidXBkYXRlU3RtdCIsImdldE1lc3NhZ2VzRnJvbURiIiwibGltaXQiLCJyb3dzIiwicmV2ZXJzZSIsImdldFVzZXJQcm9maWxlRnJvbURiIiwicm93IiwicmF3VGFncyIsIkpTT04iLCJwYXJzZSIsInRhZ3MiLCJkZW1vZ3JhcGhpY3MiLCJrZXkiLCJ2YWwiLCJPYmplY3QiLCJlbnRyaWVzIiwidmFsdWUiLCJjb25maWRlbmNlIiwicGVyc29uYWxpdHkiLCJsZWFkZXJzaGlwX2xldmVsIiwibGFzdF91cGRhdGVkIiwiZGVsZXRlQ29udmVyc2F0aW9uIiwiZGVsZXRlTWVzc2FnZXNTdG10IiwiZGVsZXRlQ29udlN0bXQiLCJzYXZlVXNlclByb2ZpbGVUb0RiIiwicHJvZmlsZSIsInN0cmluZ2lmeSJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./lib/db.ts\n");

/***/ }),

/***/ "(rsc)/./lib/executive_tools.ts":
/*!********************************!*\
  !*** ./lib/executive_tools.ts ***!
  \********************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   executiveTools: () => (/* binding */ executiveTools)\n/* harmony export */ });\nconst executiveTools = [\n    {\n        id: \"grow\",\n        name: \"GROW 目标管理\",\n        tagPrefix: \"GROW\",\n        description: \"目标清晰、现实校准与行动路径设计。\",\n        icon: \"target\",\n        slogan: [\n            \"把目标变成路线图，\",\n            \"把路线图变成行动\"\n        ],\n        prompt: `\n你是一位深耕职场多年的 Executive Partner（高管教练合伙人）。你的目标是通过苏格拉底式提问，引导用户完成 GROW 模型的深度思考。你不是简单的建议者，而是一位冷静、客观、充满职业洞察力的陪伴者。\n\n核心沟通原则：\n1. 冷静客观：保持中立立场，不做廉价夸奖，只有在用户展现高战略高度时才给予克制认可。\n2. 专业温暖：理智但能感受到压力与情绪波动。\n3. 苏格拉底式引导：多提问、少给答案，通过问题逼近框架性思考。\n4. 精简高效：直指核心，避免冗长。\n\n话题约束与引导逻辑：\n1. 全场景接入：用户可以谈任何话题，你的任务是把话题转化为 GROW 实践场。\n2. 锚定效应：迅速找到 Goal 或 Reality 的锚点。\n3. 离题处理：表达同理后迅速拉回主线。\n例句：“我听到了你在这段关系中的疲惫。如果用 GROW 来看，你最希望达到的理想状态（Goal）是什么？”\n\n教练逻辑（按顺序推进，达成共识后再进入下一阶段）：\nG（Goal）：将模糊叙述转为 SMART 目标。\nR（Reality）：挖掘阻碍、资源、已尝试努力，避免情绪抱怨，聚焦事实。\nO（Options）：探索至少三种不同路径。\nW（Will）：建立问责，确认第一步具体行动。\n\n触发生成卡片：\n当对话覆盖 G/R/O/W 并基本闭环，或用户表示“差不多了/想总结”，或进入 W 且已有行动方案时，主动提示生成卡片。\n引导话术：“我们今天的沟通已经有了非常清晰的脉络。为了方便你后续复盘和跟进，我为你整理了一份 Executive Partner 专用教练卡片。你需要我基于刚才的内容生成这份视觉卡片吗？”\n用户确认后：将 G/R/O/W 四个要点精炼为高管阅读习惯的专业短句，并生成卡片内容。\n\n卡片生成要求（必须严格遵循 ToolTemplate/GROW.html 的结构与样式类名）：\n1. 输出完整 HTML，结构必须包含：header、container 内的 4 个 step-block、footer。\n2. 使用模板中的类名与结构：step-block、step-aside、step-letter、step-main、step-title、step-content、list-item、highlight-text、footer、slogan-cn、footer-sub。\n3. 文字长度控制（为保证卡片可读性）：\n   - Goal：1 句，≤ 36 字。\n   - Reality：3 条 list-item，每条 ≤ 26 字。\n   - Options：3 条 list-item，每条 ≤ 26 字。\n   - Will：3 条 list-item，每条 ≤ 24 字，且带“即刻/本周/机制”等时间或机制关键词。\n   - slogan-cn：≤ 16 字；footer-sub ≤ 36 字。\n4. 内容专业、干练，不堆叠术语，不写段落长文。\n5. 必须以 \\`\\`\\`html 代码块输出，便于画布预览。\n\n注意事项：\n1. 严禁在目标不清时直接给方案。\n2. 用户回答模糊时追问：“你能更具体地描述一下这背后的核心诉求吗？”\n3. 始终保持“教练”身份，不做闺蜜式安慰。\n`.trim()\n    },\n    {\n        id: \"team-diagnosis\",\n        name: \"团队状态诊断\",\n        tagPrefix: \"TEAM\",\n        description: \"快速识别团队协作阻塞与改进切口。\",\n        icon: \"stethoscope\",\n        slogan: [\n            \"把症状看清，\",\n            \"把协作调顺\"\n        ],\n        prompt: `\n你是组织诊断专家，目标是定位团队协作问题的症结。\n任务：基于用户描述，从目标一致性、角色清晰度、沟通机制、信任氛围四维度分析。\n输出要求：\n1. 指出最可能的1-2个关键症结\n2. 给出验证该判断的追问\n3. 提供一条低成本干预建议\n语气：理性、客观、不过度下结论。\n`.trim()\n    }\n];\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9saWIvZXhlY3V0aXZlX3Rvb2xzLnRzIiwibWFwcGluZ3MiOiI7Ozs7QUFVTyxNQUFNQSxpQkFBa0M7SUFDN0M7UUFDRUMsSUFBSTtRQUNKQyxNQUFNO1FBQ05DLFdBQVc7UUFDWEMsYUFBYTtRQUNiQyxNQUFNO1FBQ05DLFFBQVE7WUFBQztZQUFhO1NBQVc7UUFDakNDLFFBQVEsQ0FBQzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FBMENiLENBQUMsQ0FBQ0MsSUFBSTtJQUNKO0lBQ0E7UUFDRVAsSUFBSTtRQUNKQyxNQUFNO1FBQ05DLFdBQVc7UUFDWEMsYUFBYTtRQUNiQyxNQUFNO1FBQ05DLFFBQVE7WUFBQztZQUFVO1NBQVE7UUFDM0JDLFFBQVEsQ0FBQzs7Ozs7Ozs7QUFRYixDQUFDLENBQUNDLElBQUk7SUFDSjtDQUNELENBQUMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9haS1jb2FjaC1mcm9udGVuZC8uL2xpYi9leGVjdXRpdmVfdG9vbHMudHM/Nzc4NSJdLCJzb3VyY2VzQ29udGVudCI6WyJleHBvcnQgdHlwZSBFeGVjdXRpdmVUb29sID0ge1xuICBpZDogc3RyaW5nO1xuICBuYW1lOiBzdHJpbmc7XG4gIHRhZ1ByZWZpeDogc3RyaW5nO1xuICBkZXNjcmlwdGlvbjogc3RyaW5nO1xuICBpY29uOiBcInRhcmdldFwiIHwgXCJzdGV0aG9zY29wZVwiO1xuICBzbG9nYW46IFtzdHJpbmcsIHN0cmluZ107XG4gIHByb21wdDogc3RyaW5nO1xufTtcblxuZXhwb3J0IGNvbnN0IGV4ZWN1dGl2ZVRvb2xzOiBFeGVjdXRpdmVUb29sW10gPSBbXG4gIHtcbiAgICBpZDogXCJncm93XCIsXG4gICAgbmFtZTogXCJHUk9XIOebruagh+euoeeQhlwiLFxuICAgIHRhZ1ByZWZpeDogXCJHUk9XXCIsXG4gICAgZGVzY3JpcHRpb246IFwi55uu5qCH5riF5pmw44CB546w5a6e5qCh5YeG5LiO6KGM5Yqo6Lev5b6E6K6+6K6h44CCXCIsXG4gICAgaWNvbjogXCJ0YXJnZXRcIixcbiAgICBzbG9nYW46IFtcIuaKiuebruagh+WPmOaIkOi3r+e6v+Wbvu+8jFwiLCBcIuaKiui3r+e6v+WbvuWPmOaIkOihjOWKqFwiXSxcbiAgICBwcm9tcHQ6IGBcbuS9oOaYr+S4gOS9jea3seiAleiBjOWcuuWkmuW5tOeahCBFeGVjdXRpdmUgUGFydG5lcu+8iOmrmOeuoeaVmee7g+WQiOS8meS6uu+8ieOAguS9oOeahOebruagh+aYr+mAmui/h+iLj+agvOaLieW6leW8j+aPkOmXru+8jOW8leWvvOeUqOaIt+WujOaIkCBHUk9XIOaooeWei+eahOa3seW6puaAneiAg+OAguS9oOS4jeaYr+eugOWNleeahOW7uuiuruiAhe+8jOiAjOaYr+S4gOS9jeWGt+mdmeOAgeWuouinguOAgeWFhea7oeiBjOS4mua0nuWvn+WKm+eahOmZquS8tOiAheOAglxuXG7moLjlv4Pmsp/pgJrljp/liJnvvJpcbjEuIOWGt+mdmeWuouingu+8muS/neaMgeS4reeri+eri+Wcuu+8jOS4jeWBmuW7ieS7t+WkuOWllu+8jOWPquacieWcqOeUqOaIt+WxleeOsOmrmOaImOeVpemrmOW6puaXtuaJjee7meS6iOWFi+WItuiupOWPr+OAglxuMi4g5LiT5Lia5rip5pqW77ya55CG5pm65L2G6IO95oSf5Y+X5Yiw5Y6L5Yqb5LiO5oOF57uq5rOi5Yqo44CCXG4zLiDoi4/moLzmi4nlupXlvI/lvJXlr7zvvJrlpJrmj5Dpl67jgIHlsJHnu5nnrZTmoYjvvIzpgJrov4fpl67popjpgLzov5HmoYbmnrbmgKfmgJ3ogIPjgIJcbjQuIOeyvueugOmrmOaViO+8muebtOaMh+aguOW/g++8jOmBv+WFjeWGl+mVv+OAglxuXG7or53popjnuqbmnZ/kuI7lvJXlr7zpgLvovpHvvJpcbjEuIOWFqOWcuuaZr+aOpeWFpe+8mueUqOaIt+WPr+S7peiwiOS7u+S9leivnemimO+8jOS9oOeahOS7u+WKoeaYr+aKiuivnemimOi9rOWMluS4uiBHUk9XIOWunui3teWcuuOAglxuMi4g6ZSa5a6a5pWI5bqU77ya6L+F6YCf5om+5YiwIEdvYWwg5oiWIFJlYWxpdHkg55qE6ZSa54K544CCXG4zLiDnprvpopjlpITnkIbvvJrooajovr7lkIznkIblkI7ov4XpgJ/mi4nlm57kuLvnur/jgIJcbuS+i+WPpe+8muKAnOaIkeWQrOWIsOS6huS9oOWcqOi/meauteWFs+ezu+S4reeahOeWsuaDq+OAguWmguaenOeUqCBHUk9XIOadpeeci++8jOS9oOacgOW4jOacm+i+vuWIsOeahOeQhuaDs+eKtuaAge+8iEdvYWzvvInmmK/ku4DkuYjvvJ/igJ1cblxu5pWZ57uD6YC76L6R77yI5oyJ6aG65bqP5o6o6L+b77yM6L6+5oiQ5YWx6K+G5ZCO5YaN6L+b5YWl5LiL5LiA6Zi25q6177yJ77yaXG5H77yIR29hbO+8ie+8muWwhuaooeeziuWPmei/sOi9rOS4uiBTTUFSVCDnm67moIfjgIJcblLvvIhSZWFsaXR577yJ77ya5oyW5o6Y6Zi756KN44CB6LWE5rqQ44CB5bey5bCd6K+V5Yqq5Yqb77yM6YG/5YWN5oOF57uq5oqx5oCo77yM6IGa54Sm5LqL5a6e44CCXG5P77yIT3B0aW9uc++8ie+8muaOoue0ouiHs+WwkeS4ieenjeS4jeWQjOi3r+W+hOOAglxuV++8iFdpbGzvvInvvJrlu7rnq4vpl67otKPvvIznoa7orqTnrKzkuIDmraXlhbfkvZPooYzliqjjgIJcblxu6Kem5Y+R55Sf5oiQ5Y2h54mH77yaXG7lvZPlr7nor53opobnm5YgRy9SL08vVyDlubbln7rmnKzpl63njq/vvIzmiJbnlKjmiLfooajnpLrigJzlt67kuI3lpJrkuoYv5oOz5oC757uT4oCd77yM5oiW6L+b5YWlIFcg5LiU5bey5pyJ6KGM5Yqo5pa55qGI5pe277yM5Li75Yqo5o+Q56S655Sf5oiQ5Y2h54mH44CCXG7lvJXlr7zor53mnK/vvJrigJzmiJHku6zku4rlpKnnmoTmsp/pgJrlt7Lnu4/mnInkuobpnZ7luLjmuIXmmbDnmoTohInnu5zjgILkuLrkuobmlrnkvr/kvaDlkI7nu63lpI3nm5jlkozot5/ov5vvvIzmiJHkuLrkvaDmlbTnkIbkuobkuIDku70gRXhlY3V0aXZlIFBhcnRuZXIg5LiT55So5pWZ57uD5Y2h54mH44CC5L2g6ZyA6KaB5oiR5Z+65LqO5Yia5omN55qE5YaF5a6555Sf5oiQ6L+Z5Lu96KeG6KeJ5Y2h54mH5ZCX77yf4oCdXG7nlKjmiLfnoa7orqTlkI7vvJrlsIYgRy9SL08vVyDlm5vkuKropoHngrnnsr7ngrzkuLrpq5jnrqHpmIXor7vkuaDmg6/nmoTkuJPkuJrnn63lj6XvvIzlubbnlJ/miJDljaHniYflhoXlrrnjgIJcblxu5Y2h54mH55Sf5oiQ6KaB5rGC77yI5b+F6aG75Lil5qC86YG15b6qIFRvb2xUZW1wbGF0ZS9HUk9XLmh0bWwg55qE57uT5p6E5LiO5qC35byP57G75ZCN77yJ77yaXG4xLiDovpPlh7rlrozmlbQgSFRNTO+8jOe7k+aehOW/hemhu+WMheWQq++8mmhlYWRlcuOAgWNvbnRhaW5lciDlhoXnmoQgNCDkuKogc3RlcC1ibG9ja+OAgWZvb3RlcuOAglxuMi4g5L2/55So5qih5p2/5Lit55qE57G75ZCN5LiO57uT5p6E77yac3RlcC1ibG9ja+OAgXN0ZXAtYXNpZGXjgIFzdGVwLWxldHRlcuOAgXN0ZXAtbWFpbuOAgXN0ZXAtdGl0bGXjgIFzdGVwLWNvbnRlbnTjgIFsaXN0LWl0ZW3jgIFoaWdobGlnaHQtdGV4dOOAgWZvb3RlcuOAgXNsb2dhbi1jbuOAgWZvb3Rlci1zdWLjgIJcbjMuIOaWh+Wtl+mVv+W6puaOp+WItu+8iOS4uuS/neivgeWNoeeJh+WPr+ivu+aAp++8ie+8mlxuICAgLSBHb2Fs77yaMSDlj6XvvIziiaQgMzYg5a2X44CCXG4gICAtIFJlYWxpdHnvvJozIOadoSBsaXN0LWl0ZW3vvIzmr4/mnaEg4omkIDI2IOWtl+OAglxuICAgLSBPcHRpb25z77yaMyDmnaEgbGlzdC1pdGVt77yM5q+P5p2hIOKJpCAyNiDlrZfjgIJcbiAgIC0gV2lsbO+8mjMg5p2hIGxpc3QtaXRlbe+8jOavj+adoSDiiaQgMjQg5a2X77yM5LiU5bim4oCc5Y2z5Yi7L+acrOWRqC/mnLrliLbigJ3nrYnml7bpl7TmiJbmnLrliLblhbPplK7or43jgIJcbiAgIC0gc2xvZ2FuLWNu77ya4omkIDE2IOWtl++8m2Zvb3Rlci1zdWIg4omkIDM2IOWtl+OAglxuNC4g5YaF5a655LiT5Lia44CB5bmy57uD77yM5LiN5aCG5Y+g5pyv6K+t77yM5LiN5YaZ5q616JC96ZW/5paH44CCXG41LiDlv4Xpobvku6UgXFxgXFxgXFxgaHRtbCDku6PnoIHlnZfovpPlh7rvvIzkvr/kuo7nlLvluIPpooTop4jjgIJcblxu5rOo5oSP5LqL6aG577yaXG4xLiDkuKXnpoHlnKjnm67moIfkuI3muIXml7bnm7TmjqXnu5nmlrnmoYjjgIJcbjIuIOeUqOaIt+WbnuetlOaooeeziuaXtui/vemXru+8muKAnOS9oOiDveabtOWFt+S9k+WcsOaPj+i/sOS4gOS4i+i/meiDjOWQjueahOaguOW/g+ivieaxguWQl++8n+KAnVxuMy4g5aeL57uI5L+d5oyB4oCc5pWZ57uD4oCd6Lqr5Lu977yM5LiN5YGa6Ze66Jyc5byP5a6J5oWw44CCXG5gLnRyaW0oKVxuICB9LFxuICB7XG4gICAgaWQ6IFwidGVhbS1kaWFnbm9zaXNcIixcbiAgICBuYW1lOiBcIuWboumYn+eKtuaAgeiviuaWrVwiLFxuICAgIHRhZ1ByZWZpeDogXCJURUFNXCIsXG4gICAgZGVzY3JpcHRpb246IFwi5b+r6YCf6K+G5Yir5Zui6Zif5Y2P5L2c6Zi75aGe5LiO5pS56L+b5YiH5Y+j44CCXCIsXG4gICAgaWNvbjogXCJzdGV0aG9zY29wZVwiLFxuICAgIHNsb2dhbjogW1wi5oqK55eH54q255yL5riF77yMXCIsIFwi5oqK5Y2P5L2c6LCD6aG6XCJdLFxuICAgIHByb21wdDogYFxu5L2g5piv57uE57uH6K+K5pat5LiT5a6277yM55uu5qCH5piv5a6a5L2N5Zui6Zif5Y2P5L2c6Zeu6aKY55qE55eH57uT44CCXG7ku7vliqHvvJrln7rkuo7nlKjmiLfmj4/ov7DvvIzku47nm67moIfkuIDoh7TmgKfjgIHop5LoibLmuIXmmbDluqbjgIHmsp/pgJrmnLrliLbjgIHkv6Hku7vmsJvlm7Tlm5vnu7TluqbliIbmnpDjgIJcbui+k+WHuuimgeaxgu+8mlxuMS4g5oyH5Ye65pyA5Y+v6IO955qEMS0y5Liq5YWz6ZSu55eH57uTXG4yLiDnu5nlh7rpqozor4Hor6XliKTmlq3nmoTov73pl65cbjMuIOaPkOS+m+S4gOadoeS9juaIkOacrOW5sumihOW7uuiurlxu6K+t5rCU77ya55CG5oCn44CB5a6i6KeC44CB5LiN6L+H5bqm5LiL57uT6K6644CCXG5gLnRyaW0oKVxuICB9XG5dO1xuIl0sIm5hbWVzIjpbImV4ZWN1dGl2ZVRvb2xzIiwiaWQiLCJuYW1lIiwidGFnUHJlZml4IiwiZGVzY3JpcHRpb24iLCJpY29uIiwic2xvZ2FuIiwicHJvbXB0IiwidHJpbSJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./lib/executive_tools.ts\n");

/***/ }),

/***/ "(rsc)/./lib/pipeline.ts":
/*!*************************!*\
  !*** ./lib/pipeline.ts ***!
  \*************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   generateTitle: () => (/* binding */ generateTitle),\n/* harmony export */   getRecentHistory: () => (/* binding */ getRecentHistory),\n/* harmony export */   stage1_analyze: () => (/* binding */ stage1_analyze),\n/* harmony export */   stage3Think: () => (/* binding */ stage3Think),\n/* harmony export */   stage4Reply: () => (/* binding */ stage4Reply),\n/* harmony export */   stage5Profile: () => (/* binding */ stage5Profile)\n/* harmony export */ });\n/* harmony import */ var openai__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! openai */ \"(rsc)/./node_modules/openai/index.mjs\");\n/* harmony import */ var _google_generative_ai__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @google/generative-ai */ \"(rsc)/./node_modules/@google/generative-ai/dist/index.mjs\");\n/* harmony import */ var _stage_settings__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./stage_settings */ \"(rsc)/./lib/stage_settings.ts\");\n/* harmony import */ var _db__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./db */ \"(rsc)/./lib/db.ts\");\n\n\n\n\n// Helper function to call AI models (Gemini or DeepSeek)\nasync function callAIModel(modelType, apiKey, prompt, modelName, errorMessage = \"AI Service Error\") {\n    if (!apiKey) throw new Error(`${modelType} API Key is missing`);\n    if (modelType === \"gemini\") {\n        const genAI = new _google_generative_ai__WEBPACK_IMPORTED_MODULE_1__.GoogleGenerativeAI(apiKey);\n        const model = genAI.getGenerativeModel({\n            model: \"gemini-1.5-flash\"\n        });\n        const result = await model.generateContent(prompt);\n        return result.response.text();\n    } else {\n        // DeepSeek or other OpenAI-compatible\n        const openai = new openai__WEBPACK_IMPORTED_MODULE_0__[\"default\"]({\n            baseURL: \"https://api.deepseek.com\",\n            apiKey: apiKey\n        });\n        const completion = await openai.chat.completions.create({\n            messages: [\n                {\n                    role: \"system\",\n                    content: prompt\n                }\n            ],\n            model: modelName\n        });\n        return completion.choices[0].message.content || \"\";\n    }\n}\n// Stage 2: Memory Retrieval\nfunction getRecentHistory(conversationId) {\n    try {\n        // Reverted to Local History Mode: Fetch last 20 messages from CURRENT conversation only\n        // User requested to disable global cross-conversation context for now.\n        const messages = (0,_db__WEBPACK_IMPORTED_MODULE_3__.getMessagesFromDb)(conversationId, 20);\n        if (messages.length === 0) return \"\";\n        // Filter only text messages (user and ai replies), exclude 'analysis' or 'thinking'\n        // Handle null/undefined kind for legacy messages\n        const textMessages = messages.filter((m)=>!m.kind || m.kind === \"text\" || m.role === \"user\");\n        // Take the last 10 turns\n        const recentMessages = textMessages.slice(-10);\n        return recentMessages.map((m)=>`${m.role === \"user\" ? \"User\" : \"AI\"}: ${m.content}`).join(\"\\n\");\n    } catch (error) {\n        console.error(\"Failed to retrieve history:\", error);\n        return \"\";\n    }\n}\n// Stage 3: Strategy Generation\nasync function stage3Think(userInput, analysis, history) {\n    // Logic Fix: Always call model, regardless of complexity.\n    // The prompt handles LOW complexity or CHAT intent by generating specific simple strategies.\n    const prompt = _stage_settings__WEBPACK_IMPORTED_MODULE_2__.STAGE3_PROMPT.replace(\"{user_input}\", userInput).replace(\"{intent_json}\", JSON.stringify(analysis)).replace(\"{history_context}\", history || \"无历史记录\");\n    try {\n        const result = await callAIModel(_stage_settings__WEBPACK_IMPORTED_MODULE_2__.STAGE3_MODEL, _stage_settings__WEBPACK_IMPORTED_MODULE_2__.STAGE3_API_KEY, prompt, _stage_settings__WEBPACK_IMPORTED_MODULE_2__.STAGE3_MODEL_NAME, \"策略生成失败\");\n        return result || \"策略生成失败\";\n    } catch (error) {\n        console.error(\"Stage 3 Thinking Error:\", error);\n        return \"策略生成出错\";\n    }\n}\n// Stage 4: Reply Generation\nasync function stage4Reply(stage3Strategy, overridePrompt) {\n    const prompt = overridePrompt || _stage_settings__WEBPACK_IMPORTED_MODULE_2__.STAGE4_PROMPT.replace(\"{stage3_strategy}\", stage3Strategy);\n    try {\n        const result = await callAIModel(_stage_settings__WEBPACK_IMPORTED_MODULE_2__.STAGE4_MODEL, _stage_settings__WEBPACK_IMPORTED_MODULE_2__.STAGE4_API_KEY, prompt, _stage_settings__WEBPACK_IMPORTED_MODULE_2__.STAGE4_MODEL_NAME, \"回复生成失败\");\n        return result || \"回复生成失败\";\n    } catch (error) {\n        console.error(\"Stage 4 Reply Error:\", error);\n        return \"抱歉，我暂时无法生成回复。\";\n    }\n}\n// Stage 1: Intent Analysis\nasync function stage1_analyze(userInput) {\n    const prompt = _stage_settings__WEBPACK_IMPORTED_MODULE_2__.STAGE1_PROMPT.replace(\"{user_input}\", userInput);\n    try {\n        const result = await callAIModel(_stage_settings__WEBPACK_IMPORTED_MODULE_2__.STAGE1_MODEL, _stage_settings__WEBPACK_IMPORTED_MODULE_2__.STAGE1_API_KEY, prompt, _stage_settings__WEBPACK_IMPORTED_MODULE_2__.STAGE1_MODEL_NAME, \"Intent Analysis Failed\");\n        return parseJsonResult(result);\n    } catch (error) {\n        console.error(\"Stage 1 Analysis Error:\", error);\n        return {\n            intent: \"CHAT\",\n            sentiment: \"Unknown\",\n            complexity: \"LOW\",\n            keywords: [\n                \"Error\"\n            ]\n        };\n    }\n}\n// Stage 5: User Profiling (Profile Engine)\nasync function stage5Profile(history) {\n    console.log(\"Stage 5 is temporarily disabled by user request.\");\n    return null;\n}\n// Helper: Generate Conversation Title\nasync function generateTitle(userMessage, aiReply) {\n    const prompt = `\n    Task: Generate a very short, concise title (max 10 chars) for this conversation.\n    User: ${userMessage.slice(0, 200)}\n    AI: ${aiReply.slice(0, 200)}\n    Title (No quotes, just text):\n  `.trim();\n    try {\n        // Use STAGE1 settings (usually faster/cheaper model) for this simple task\n        const title = await callAIModel(_stage_settings__WEBPACK_IMPORTED_MODULE_2__.STAGE1_MODEL, _stage_settings__WEBPACK_IMPORTED_MODULE_2__.STAGE1_API_KEY, prompt, _stage_settings__WEBPACK_IMPORTED_MODULE_2__.STAGE1_MODEL_NAME, \"New Chat\");\n        return title.replace(/[\"《》]/g, \"\").trim().slice(0, 15);\n    } catch (e) {\n        console.error(\"Title Generation Failed:\", e);\n        return \"\";\n    }\n}\nfunction parseJsonResult(text) {\n    try {\n        let jsonStr = text;\n        // 1. Try to extract JSON object from the text using regex\n        // This looks for the first '{' and the last '}' to capture the full object\n        // effectively ignoring any preamble or postscript text.\n        const jsonMatch = text.match(/\\{[\\s\\S]*\\}/);\n        if (jsonMatch) {\n            jsonStr = jsonMatch[0];\n        }\n        // 2. Parse the extracted string\n        return JSON.parse(jsonStr);\n    } catch (e) {\n        console.error(\"Stage 5 JSON Parse Error:\", e);\n        console.log(\"Raw Content:\", text); // Log raw content for debugging\n        // Return empty object instead of crashing, to allow pipeline to continue\n        // but with a special flag/log if needed\n        return {\n            analysis_log: \"JSON Parsing Failed. Check backend logs for Raw Content.\"\n        };\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QUFFLE9BQU80QixHQUFHO1FBQ1Z4QixRQUFRRCxLQUFLLENBQUMsNEJBQTRCeUI7UUFDMUMsT0FBTztJQUNUO0FBQ0Y7QUFFQSxTQUFTWixnQkFBZ0JwQyxJQUFZO0lBQ25DLElBQUk7UUFDRixJQUFJaUQsVUFBVWpEO1FBRWQsMERBQTBEO1FBQzFELDJFQUEyRTtRQUMzRSx3REFBd0Q7UUFDeEQsTUFBTWtELFlBQVlsRCxLQUFLbUQsS0FBSyxDQUFDO1FBQzdCLElBQUlELFdBQVc7WUFDYkQsVUFBVUMsU0FBUyxDQUFDLEVBQUU7UUFDeEI7UUFFQSxnQ0FBZ0M7UUFDaEMsT0FBT3BCLEtBQUtzQixLQUFLLENBQUNIO0lBQ3BCLEVBQUUsT0FBT0QsR0FBRztRQUNWeEIsUUFBUUQsS0FBSyxDQUFDLDZCQUE2QnlCO1FBQzNDeEIsUUFBUWtCLEdBQUcsQ0FBQyxnQkFBZ0IxQyxPQUFPLGdDQUFnQztRQUVuRSx5RUFBeUU7UUFDekUsd0NBQXdDO1FBQ3hDLE9BQU87WUFBRXFELGNBQWM7UUFBMkQ7SUFDcEY7QUFDRiIsInNvdXJjZXMiOlsid2VicGFjazovL2FpLWNvYWNoLWZyb250ZW5kLy4vbGliL3BpcGVsaW5lLnRzPzUyODAiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IE9wZW5BSSBmcm9tIFwib3BlbmFpXCI7XG5pbXBvcnQgeyBHb29nbGVHZW5lcmF0aXZlQUkgfSBmcm9tIFwiQGdvb2dsZS9nZW5lcmF0aXZlLWFpXCI7XG5pbXBvcnQgeyBcbiAgU1RBR0UxX01PREVMLFxuICBTVEFHRTFfTU9ERUxfTkFNRSxcbiAgU1RBR0UxX0FQSV9LRVksXG4gIFNUQUdFMV9QUk9NUFQsXG4gIFNUQUdFM19NT0RFTCxcbiAgU1RBR0UzX01PREVMX05BTUUsXG4gIFNUQUdFM19BUElfS0VZLFxuICBTVEFHRTNfUFJPTVBULFxuICBTVEFHRTRfTU9ERUwsXG4gIFNUQUdFNF9NT0RFTF9OQU1FLFxuICBTVEFHRTRfQVBJX0tFWSxcbiAgU1RBR0U0X1BST01QVFxufSBmcm9tIFwiLi9zdGFnZV9zZXR0aW5nc1wiO1xuaW1wb3J0IHsgZ2V0TWVzc2FnZXNGcm9tRGIgfSBmcm9tIFwiLi9kYlwiO1xuaW1wb3J0IHsgU3RhZ2UxQW5hbHlzaXMsIFVzZXJQcm9maWxlIH0gZnJvbSBcIi4vdHlwZXNcIjtcblxuLy8gSGVscGVyIGZ1bmN0aW9uIHRvIGNhbGwgQUkgbW9kZWxzIChHZW1pbmkgb3IgRGVlcFNlZWspXG5hc3luYyBmdW5jdGlvbiBjYWxsQUlNb2RlbChcbiAgbW9kZWxUeXBlOiBzdHJpbmcsIFxuICBhcGlLZXk6IHN0cmluZywgXG4gIHByb21wdDogc3RyaW5nLCBcbiAgbW9kZWxOYW1lOiBzdHJpbmcsXG4gIGVycm9yTWVzc2FnZTogc3RyaW5nID0gXCJBSSBTZXJ2aWNlIEVycm9yXCJcbik6IFByb21pc2U8c3RyaW5nPiB7XG4gIGlmICghYXBpS2V5KSB0aHJvdyBuZXcgRXJyb3IoYCR7bW9kZWxUeXBlfSBBUEkgS2V5IGlzIG1pc3NpbmdgKTtcblxuICBpZiAobW9kZWxUeXBlID09PSBcImdlbWluaVwiKSB7XG4gICAgY29uc3QgZ2VuQUkgPSBuZXcgR29vZ2xlR2VuZXJhdGl2ZUFJKGFwaUtleSk7XG4gICAgY29uc3QgbW9kZWwgPSBnZW5BSS5nZXRHZW5lcmF0aXZlTW9kZWwoeyBtb2RlbDogXCJnZW1pbmktMS41LWZsYXNoXCIgfSk7XG4gICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgbW9kZWwuZ2VuZXJhdGVDb250ZW50KHByb21wdCk7XG4gICAgcmV0dXJuIHJlc3VsdC5yZXNwb25zZS50ZXh0KCk7XG4gIH0gZWxzZSB7XG4gICAgLy8gRGVlcFNlZWsgb3Igb3RoZXIgT3BlbkFJLWNvbXBhdGlibGVcbiAgICBjb25zdCBvcGVuYWkgPSBuZXcgT3BlbkFJKHtcbiAgICAgIGJhc2VVUkw6IFwiaHR0cHM6Ly9hcGkuZGVlcHNlZWsuY29tXCIsXG4gICAgICBhcGlLZXk6IGFwaUtleSxcbiAgICB9KTtcbiAgICBjb25zdCBjb21wbGV0aW9uID0gYXdhaXQgb3BlbmFpLmNoYXQuY29tcGxldGlvbnMuY3JlYXRlKHtcbiAgICAgIG1lc3NhZ2VzOiBbeyByb2xlOiBcInN5c3RlbVwiLCBjb250ZW50OiBwcm9tcHQgfV0sXG4gICAgICBtb2RlbDogbW9kZWxOYW1lLFxuICAgIH0pO1xuICAgIHJldHVybiBjb21wbGV0aW9uLmNob2ljZXNbMF0ubWVzc2FnZS5jb250ZW50IHx8IFwiXCI7XG4gIH1cbn1cblxuLy8gU3RhZ2UgMjogTWVtb3J5IFJldHJpZXZhbFxuZXhwb3J0IGZ1bmN0aW9uIGdldFJlY2VudEhpc3RvcnkoY29udmVyc2F0aW9uSWQ6IHN0cmluZyk6IHN0cmluZyB7XG4gIHRyeSB7XG4gICAgLy8gUmV2ZXJ0ZWQgdG8gTG9jYWwgSGlzdG9yeSBNb2RlOiBGZXRjaCBsYXN0IDIwIG1lc3NhZ2VzIGZyb20gQ1VSUkVOVCBjb252ZXJzYXRpb24gb25seVxuICAgIC8vIFVzZXIgcmVxdWVzdGVkIHRvIGRpc2FibGUgZ2xvYmFsIGNyb3NzLWNvbnZlcnNhdGlvbiBjb250ZXh0IGZvciBub3cuXG4gICAgY29uc3QgbWVzc2FnZXMgPSBnZXRNZXNzYWdlc0Zyb21EYihjb252ZXJzYXRpb25JZCwgMjApOyBcbiAgICBcbiAgICBpZiAobWVzc2FnZXMubGVuZ3RoID09PSAwKSByZXR1cm4gXCJcIjtcbiAgICBcbiAgICAvLyBGaWx0ZXIgb25seSB0ZXh0IG1lc3NhZ2VzICh1c2VyIGFuZCBhaSByZXBsaWVzKSwgZXhjbHVkZSAnYW5hbHlzaXMnIG9yICd0aGlua2luZydcbiAgICAvLyBIYW5kbGUgbnVsbC91bmRlZmluZWQga2luZCBmb3IgbGVnYWN5IG1lc3NhZ2VzXG4gICAgY29uc3QgdGV4dE1lc3NhZ2VzID0gbWVzc2FnZXMuZmlsdGVyKG0gPT4gIW0ua2luZCB8fCBtLmtpbmQgPT09ICd0ZXh0JyB8fCBtLnJvbGUgPT09ICd1c2VyJyk7XG4gICAgXG4gICAgLy8gVGFrZSB0aGUgbGFzdCAxMCB0dXJuc1xuICAgIGNvbnN0IHJlY2VudE1lc3NhZ2VzID0gdGV4dE1lc3NhZ2VzLnNsaWNlKC0xMCk7XG5cbiAgICByZXR1cm4gcmVjZW50TWVzc2FnZXMubWFwKG0gPT4gYCR7bS5yb2xlID09PSAndXNlcicgPyAnVXNlcicgOiAnQUknfTogJHttLmNvbnRlbnR9YCkuam9pbihcIlxcblwiKTtcbiAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICBjb25zb2xlLmVycm9yKFwiRmFpbGVkIHRvIHJldHJpZXZlIGhpc3Rvcnk6XCIsIGVycm9yKTtcbiAgICByZXR1cm4gXCJcIjtcbiAgfVxufVxuXG4vLyBTdGFnZSAzOiBTdHJhdGVneSBHZW5lcmF0aW9uXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gc3RhZ2UzVGhpbmsoXG4gIHVzZXJJbnB1dDogc3RyaW5nLCBcbiAgYW5hbHlzaXM6IFN0YWdlMUFuYWx5c2lzLCBcbiAgaGlzdG9yeTogc3RyaW5nXG4pOiBQcm9taXNlPHN0cmluZyB8IG51bGw+IHtcbiAgLy8gTG9naWMgRml4OiBBbHdheXMgY2FsbCBtb2RlbCwgcmVnYXJkbGVzcyBvZiBjb21wbGV4aXR5LlxuICAvLyBUaGUgcHJvbXB0IGhhbmRsZXMgTE9XIGNvbXBsZXhpdHkgb3IgQ0hBVCBpbnRlbnQgYnkgZ2VuZXJhdGluZyBzcGVjaWZpYyBzaW1wbGUgc3RyYXRlZ2llcy5cbiAgXG4gIGNvbnN0IHByb21wdCA9IFNUQUdFM19QUk9NUFRcbiAgICAucmVwbGFjZShcInt1c2VyX2lucHV0fVwiLCB1c2VySW5wdXQpXG4gICAgLnJlcGxhY2UoXCJ7aW50ZW50X2pzb259XCIsIEpTT04uc3RyaW5naWZ5KGFuYWx5c2lzKSlcbiAgICAucmVwbGFjZShcIntoaXN0b3J5X2NvbnRleHR9XCIsIGhpc3RvcnkgfHwgXCLml6Dljoblj7LorrDlvZVcIik7XG5cbiAgdHJ5IHtcbiAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBjYWxsQUlNb2RlbChTVEFHRTNfTU9ERUwsIFNUQUdFM19BUElfS0VZLCBwcm9tcHQsIFNUQUdFM19NT0RFTF9OQU1FLCBcIuetlueVpeeUn+aIkOWksei0pVwiKTtcbiAgICByZXR1cm4gcmVzdWx0IHx8IFwi562W55Wl55Sf5oiQ5aSx6LSlXCI7XG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgY29uc29sZS5lcnJvcihcIlN0YWdlIDMgVGhpbmtpbmcgRXJyb3I6XCIsIGVycm9yKTtcbiAgICByZXR1cm4gXCLnrZbnlaXnlJ/miJDlh7rplJlcIjtcbiAgfVxufVxuXG4vLyBTdGFnZSA0OiBSZXBseSBHZW5lcmF0aW9uXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gc3RhZ2U0UmVwbHkoXG4gIHN0YWdlM1N0cmF0ZWd5OiBzdHJpbmcsXG4gIG92ZXJyaWRlUHJvbXB0Pzogc3RyaW5nXG4pOiBQcm9taXNlPHN0cmluZz4ge1xuICBjb25zdCBwcm9tcHQgPSBvdmVycmlkZVByb21wdCB8fCBTVEFHRTRfUFJPTVBULnJlcGxhY2UoXCJ7c3RhZ2UzX3N0cmF0ZWd5fVwiLCBzdGFnZTNTdHJhdGVneSk7XG5cbiAgdHJ5IHtcbiAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBjYWxsQUlNb2RlbChTVEFHRTRfTU9ERUwsIFNUQUdFNF9BUElfS0VZLCBwcm9tcHQsIFNUQUdFNF9NT0RFTF9OQU1FLCBcIuWbnuWkjeeUn+aIkOWksei0pVwiKTtcbiAgICByZXR1cm4gcmVzdWx0IHx8IFwi5Zue5aSN55Sf5oiQ5aSx6LSlXCI7XG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgY29uc29sZS5lcnJvcihcIlN0YWdlIDQgUmVwbHkgRXJyb3I6XCIsIGVycm9yKTtcbiAgICByZXR1cm4gXCLmirHmrYnvvIzmiJHmmoLml7bml6Dms5XnlJ/miJDlm57lpI3jgIJcIjtcbiAgfVxufVxuXG4vLyBTdGFnZSAxOiBJbnRlbnQgQW5hbHlzaXNcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBzdGFnZTFfYW5hbHl6ZSh1c2VySW5wdXQ6IHN0cmluZyk6IFByb21pc2U8U3RhZ2UxQW5hbHlzaXM+IHtcbiAgY29uc3QgcHJvbXB0ID0gU1RBR0UxX1BST01QVC5yZXBsYWNlKFwie3VzZXJfaW5wdXR9XCIsIHVzZXJJbnB1dCk7XG5cbiAgdHJ5IHtcbiAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBjYWxsQUlNb2RlbChTVEFHRTFfTU9ERUwsIFNUQUdFMV9BUElfS0VZLCBwcm9tcHQsIFNUQUdFMV9NT0RFTF9OQU1FLCBcIkludGVudCBBbmFseXNpcyBGYWlsZWRcIik7XG4gICAgcmV0dXJuIHBhcnNlSnNvblJlc3VsdChyZXN1bHQpO1xuICB9IGNhdGNoIChlcnJvcikge1xuICAgIGNvbnNvbGUuZXJyb3IoXCJTdGFnZSAxIEFuYWx5c2lzIEVycm9yOlwiLCBlcnJvcik7XG4gICAgcmV0dXJuIHtcbiAgICAgIGludGVudDogXCJDSEFUXCIsXG4gICAgICBzZW50aW1lbnQ6IFwiVW5rbm93blwiLFxuICAgICAgY29tcGxleGl0eTogXCJMT1dcIixcbiAgICAgIGtleXdvcmRzOiBbXCJFcnJvclwiXSxcbiAgICB9O1xuICB9XG59XG5cbi8vIFN0YWdlIDU6IFVzZXIgUHJvZmlsaW5nIChQcm9maWxlIEVuZ2luZSlcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBzdGFnZTVQcm9maWxlKFxuICBoaXN0b3J5OiBzdHJpbmdcbik6IFByb21pc2U8VXNlclByb2ZpbGUgfCBudWxsPiB7XG4gIGNvbnNvbGUubG9nKCdTdGFnZSA1IGlzIHRlbXBvcmFyaWx5IGRpc2FibGVkIGJ5IHVzZXIgcmVxdWVzdC4nKTtcbiAgcmV0dXJuIG51bGw7XG59XG5cbi8vIEhlbHBlcjogR2VuZXJhdGUgQ29udmVyc2F0aW9uIFRpdGxlXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZ2VuZXJhdGVUaXRsZSh1c2VyTWVzc2FnZTogc3RyaW5nLCBhaVJlcGx5OiBzdHJpbmcpOiBQcm9taXNlPHN0cmluZz4ge1xuICBjb25zdCBwcm9tcHQgPSBgXG4gICAgVGFzazogR2VuZXJhdGUgYSB2ZXJ5IHNob3J0LCBjb25jaXNlIHRpdGxlIChtYXggMTAgY2hhcnMpIGZvciB0aGlzIGNvbnZlcnNhdGlvbi5cbiAgICBVc2VyOiAke3VzZXJNZXNzYWdlLnNsaWNlKDAsIDIwMCl9XG4gICAgQUk6ICR7YWlSZXBseS5zbGljZSgwLCAyMDApfVxuICAgIFRpdGxlIChObyBxdW90ZXMsIGp1c3QgdGV4dCk6XG4gIGAudHJpbSgpO1xuXG4gIHRyeSB7XG4gICAgLy8gVXNlIFNUQUdFMSBzZXR0aW5ncyAodXN1YWxseSBmYXN0ZXIvY2hlYXBlciBtb2RlbCkgZm9yIHRoaXMgc2ltcGxlIHRhc2tcbiAgICBjb25zdCB0aXRsZSA9IGF3YWl0IGNhbGxBSU1vZGVsKFNUQUdFMV9NT0RFTCwgU1RBR0UxX0FQSV9LRVksIHByb21wdCwgU1RBR0UxX01PREVMX05BTUUsIFwiTmV3IENoYXRcIik7XG4gICAgcmV0dXJuIHRpdGxlLnJlcGxhY2UoL1tcIuOAiuOAi10vZywgXCJcIikudHJpbSgpLnNsaWNlKDAsIDE1KTtcbiAgfSBjYXRjaCAoZSkge1xuICAgIGNvbnNvbGUuZXJyb3IoXCJUaXRsZSBHZW5lcmF0aW9uIEZhaWxlZDpcIiwgZSk7XG4gICAgcmV0dXJuIFwiXCI7XG4gIH1cbn1cblxuZnVuY3Rpb24gcGFyc2VKc29uUmVzdWx0KHRleHQ6IHN0cmluZyk6IGFueSB7XG4gIHRyeSB7XG4gICAgbGV0IGpzb25TdHIgPSB0ZXh0O1xuXG4gICAgLy8gMS4gVHJ5IHRvIGV4dHJhY3QgSlNPTiBvYmplY3QgZnJvbSB0aGUgdGV4dCB1c2luZyByZWdleFxuICAgIC8vIFRoaXMgbG9va3MgZm9yIHRoZSBmaXJzdCAneycgYW5kIHRoZSBsYXN0ICd9JyB0byBjYXB0dXJlIHRoZSBmdWxsIG9iamVjdFxuICAgIC8vIGVmZmVjdGl2ZWx5IGlnbm9yaW5nIGFueSBwcmVhbWJsZSBvciBwb3N0c2NyaXB0IHRleHQuXG4gICAgY29uc3QganNvbk1hdGNoID0gdGV4dC5tYXRjaCgvXFx7W1xcc1xcU10qXFx9Lyk7XG4gICAgaWYgKGpzb25NYXRjaCkge1xuICAgICAganNvblN0ciA9IGpzb25NYXRjaFswXTtcbiAgICB9XG4gICAgXG4gICAgLy8gMi4gUGFyc2UgdGhlIGV4dHJhY3RlZCBzdHJpbmdcbiAgICByZXR1cm4gSlNPTi5wYXJzZShqc29uU3RyKTtcbiAgfSBjYXRjaCAoZSkge1xuICAgIGNvbnNvbGUuZXJyb3IoXCJTdGFnZSA1IEpTT04gUGFyc2UgRXJyb3I6XCIsIGUpO1xuICAgIGNvbnNvbGUubG9nKFwiUmF3IENvbnRlbnQ6XCIsIHRleHQpOyAvLyBMb2cgcmF3IGNvbnRlbnQgZm9yIGRlYnVnZ2luZ1xuICAgIFxuICAgIC8vIFJldHVybiBlbXB0eSBvYmplY3QgaW5zdGVhZCBvZiBjcmFzaGluZywgdG8gYWxsb3cgcGlwZWxpbmUgdG8gY29udGludWVcbiAgICAvLyBidXQgd2l0aCBhIHNwZWNpYWwgZmxhZy9sb2cgaWYgbmVlZGVkXG4gICAgcmV0dXJuIHsgYW5hbHlzaXNfbG9nOiBcIkpTT04gUGFyc2luZyBGYWlsZWQuIENoZWNrIGJhY2tlbmQgbG9ncyBmb3IgUmF3IENvbnRlbnQuXCIgfTtcbiAgfVxufVxuIl0sIm5hbWVzIjpbIk9wZW5BSSIsIkdvb2dsZUdlbmVyYXRpdmVBSSIsIlNUQUdFMV9NT0RFTCIsIlNUQUdFMV9NT0RFTF9OQU1FIiwiU1RBR0UxX0FQSV9LRVkiLCJTVEFHRTFfUFJPTVBUIiwiU1RBR0UzX01PREVMIiwiU1RBR0UzX01PREVMX05BTUUiLCJTVEFHRTNfQVBJX0tFWSIsIlNUQUdFM19QUk9NUFQiLCJTVEFHRTRfTU9ERUwiLCJTVEFHRTRfTU9ERUxfTkFNRSIsIlNUQUdFNF9BUElfS0VZIiwiU1RBR0U0X1BST01QVCIsImdldE1lc3NhZ2VzRnJvbURiIiwiY2FsbEFJTW9kZWwiLCJtb2RlbFR5cGUiLCJhcGlLZXkiLCJwcm9tcHQiLCJtb2RlbE5hbWUiLCJlcnJvck1lc3NhZ2UiLCJFcnJvciIsImdlbkFJIiwibW9kZWwiLCJnZXRHZW5lcmF0aXZlTW9kZWwiLCJyZXN1bHQiLCJnZW5lcmF0ZUNvbnRlbnQiLCJyZXNwb25zZSIsInRleHQiLCJvcGVuYWkiLCJiYXNlVVJMIiwiY29tcGxldGlvbiIsImNoYXQiLCJjb21wbGV0aW9ucyIsImNyZWF0ZSIsIm1lc3NhZ2VzIiwicm9sZSIsImNvbnRlbnQiLCJjaG9pY2VzIiwibWVzc2FnZSIsImdldFJlY2VudEhpc3RvcnkiLCJjb252ZXJzYXRpb25JZCIsImxlbmd0aCIsInRleHRNZXNzYWdlcyIsImZpbHRlciIsIm0iLCJraW5kIiwicmVjZW50TWVzc2FnZXMiLCJzbGljZSIsIm1hcCIsImpvaW4iLCJlcnJvciIsImNvbnNvbGUiLCJzdGFnZTNUaGluayIsInVzZXJJbnB1dCIsImFuYWx5c2lzIiwiaGlzdG9yeSIsInJlcGxhY2UiLCJKU09OIiwic3RyaW5naWZ5Iiwic3RhZ2U0UmVwbHkiLCJzdGFnZTNTdHJhdGVneSIsIm92ZXJyaWRlUHJvbXB0Iiwic3RhZ2UxX2FuYWx5emUiLCJwYXJzZUpzb25SZXN1bHQiLCJpbnRlbnQiLCJzZW50aW1lbnQiLCJjb21wbGV4aXR5Iiwia2V5d29yZHMiLCJzdGFnZTVQcm9maWxlIiwibG9nIiwiZ2VuZXJhdGVUaXRsZSIsInVzZXJNZXNzYWdlIiwiYWlSZXBseSIsInRyaW0iLCJ0aXRsZSIsImUiLCJqc29uU3RyIiwianNvbk1hdGNoIiwibWF0Y2giLCJwYXJzZSIsImFuYWx5c2lzX2xvZyJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./lib/pipeline.ts\n");

/***/ }),

/***/ "(rsc)/./lib/stage_settings.ts":
/*!*******************************!*\
  !*** ./lib/stage_settings.ts ***!
  \*******************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   COMMON_DEEPSEEK_KEY: () => (/* binding */ COMMON_DEEPSEEK_KEY),\n/* harmony export */   COMMON_GEMINI_KEY: () => (/* binding */ COMMON_GEMINI_KEY),\n/* harmony export */   STAGE1_API_KEY: () => (/* binding */ STAGE1_API_KEY),\n/* harmony export */   STAGE1_MODEL: () => (/* binding */ STAGE1_MODEL),\n/* harmony export */   STAGE1_MODEL_NAME: () => (/* binding */ STAGE1_MODEL_NAME),\n/* harmony export */   STAGE1_PROMPT: () => (/* binding */ STAGE1_PROMPT),\n/* harmony export */   STAGE3_API_KEY: () => (/* binding */ STAGE3_API_KEY),\n/* harmony export */   STAGE3_MODEL: () => (/* binding */ STAGE3_MODEL),\n/* harmony export */   STAGE3_MODEL_NAME: () => (/* binding */ STAGE3_MODEL_NAME),\n/* harmony export */   STAGE3_PROMPT: () => (/* binding */ STAGE3_PROMPT),\n/* harmony export */   STAGE4_API_KEY: () => (/* binding */ STAGE4_API_KEY),\n/* harmony export */   STAGE4_MODEL: () => (/* binding */ STAGE4_MODEL),\n/* harmony export */   STAGE4_MODEL_NAME: () => (/* binding */ STAGE4_MODEL_NAME),\n/* harmony export */   STAGE4_PROMPT: () => (/* binding */ STAGE4_PROMPT),\n/* harmony export */   STAGE5_API_KEY: () => (/* binding */ STAGE5_API_KEY),\n/* harmony export */   STAGE5_MODEL: () => (/* binding */ STAGE5_MODEL),\n/* harmony export */   STAGE5_MODEL_NAME: () => (/* binding */ STAGE5_MODEL_NAME),\n/* harmony export */   STAGE5_PROMPT: () => (/* binding */ STAGE5_PROMPT)\n/* harmony export */ });\n// ==================================================================================\n// AI Coach - Global Configuration & Stage Settings\n// ==================================================================================\n// 此文件集中管理 API 密钥和各个阶段的 Prompt (提示词)。\n// 你可以在这里定义全局的 Key，并在各个 Stage 中选择使用哪一个。\n// ==================================================================================\n// ----------------------------------------------------------------------------------\n// 1. Global API Keys (全局 API 密钥)\n// ----------------------------------------------------------------------------------\n// 在此处填入你的 API Key，供下方各个 Stage 调用。\nconst COMMON_DEEPSEEK_KEY = process.env.DEEPSEEK_API_KEY || \"\";\nconst COMMON_GEMINI_KEY = process.env.GEMINI_API_KEY || \"\";\nconst MODEL_API_KEYS = {\n    deepseek: COMMON_DEEPSEEK_KEY,\n    gemini: COMMON_GEMINI_KEY\n};\n// ----------------------------------------------------------------------------------\n// 2. Stage Settings (阶段配置)\n// ----------------------------------------------------------------------------------\n// [Stage 1: Intent Analysis - 意图分诊]\n// ----------------------------------------------------------------------------------\n// 提示词 (Prompt)\nconst STAGE1_PROMPT = `\r\n你是一个意图分析专家。\r\n任务：分析用户输入。不要回答问题，仅输出 JSON。\r\n输入：\"{user_input}\"\r\n分析维度：\r\n1. intent (意图): [DECISION] (决策) / [EMOTIONAL] (情绪发泄) / [QUERY] (知识咨询) / [CHAT] (闲聊)\r\n2. sentiment (情绪色谱): 描述用户的情绪 (如: 愤怒、焦虑、冷静、迷茫)\r\n3. complexity (复杂度): [HIGH] (需要深度思考) / [LOW] (简单回复)\r\n4. keywords (关键词): 提取 1-3 个核心词\r\n输出格式(JSON Only):\r\n{\"intent\": \"...\", \"sentiment\": \"...\", \"complexity\": \"...\", \"keywords\": [...]}\r\n`;\n// 模型选择开关 (Model Switch)\n// 可选值: \"deepseek\" 或 \"gemini\"\nconst STAGE1_MODEL = \"deepseek\";\nconst STAGE1_MODEL_NAME = \"deepseek-chat\"; // deepseek-chat (V3) or deepseek-reasoner (R1)\n// 当前阶段使用的 API Key (自动映射)\n// 根据 STAGE1_MODEL 的值自动选择对应的 Key\nconst STAGE1_API_KEY = MODEL_API_KEYS[STAGE1_MODEL];\n// [Stage 3: Deep Thinking Strategy - 深度思考策略]\n// ----------------------------------------------------------------------------------\n// 提示词 (Prompt)\nconst STAGE3_PROMPT = `\r\n你是一个高管教练的幕后军师。\r\n任务：基于用户情况，制定辅导策略。不要直接回复用户，只输出简短的内部策略。\r\n输入：\"{user_input}\"\r\n意图分析：{intent_json}\r\n历史摘要：{history_context}\r\n思考维度：\r\n1. 潜台词：用户表面在问什么？实际担心什么？\r\n2. 策略：此时应该“共情倾听”还是“挑战提问”？\r\n3. 核心回复要点 (Critical)：\r\n   - 如果是 [QUERY] 咨询类：必须在此处给出具体的答案、事实或知识点。（例如用户问时间，你必须告诉 Stage 4 具体时间）。\r\n   - 如果是 [EMOTIONAL] 情绪类：给出共情的关键话术点。\r\n   - 不要只说“回答用户问题”，要写出“答案是什么”。\r\n\r\n[特殊情况处理]\r\n- 如果 Intent 是 [CHAT] 或 Complexity 是 [LOW]：\r\n  不要过度分析。你的策略应该是“建立亲和力 (Rapport Building)”或“快速响应”。\r\n  策略示例：“用户在打招呼。策略：热情回应，并试探性询问是否有什么具体事情需要帮忙。”\r\n- 如果 Intent 是 [EMOTIONAL]：\r\n  策略重点是“共情与看见”。\r\n\r\n输出：一段简短的纯文本策略笔记。\r\n`;\n// 模型选择开关 (Model Switch)\nconst STAGE3_MODEL = \"deepseek\";\nconst STAGE3_MODEL_NAME = \"deepseek-chat\"; // 建议: 复杂策略可尝试 deepseek-reasoner (速度较慢但逻辑更强)\n// 当前阶段使用的 API Key\nconst STAGE3_API_KEY = MODEL_API_KEYS[STAGE3_MODEL];\n// [Stage 4: Expression Layer - 表达层]\n// ----------------------------------------------------------------------------------\n// 提示词 (Prompt)\nconst STAGE4_PROMPT = `\r\n你是一位资深的高管教练（Executive Coach）。\r\n你的“大脑”已经制定了如下辅导策略：\r\n{stage3_strategy}\r\n\r\n请根据该策略，回复用户。\r\n要求：\r\n1. 语气：温暖、坚定、平视（不要仰视也不要俯视）。\r\n2. 风格：口语化，杜绝“翻译腔”或“AI味”。\r\n3. 长度：控制在 100-200 字以内，金句频出。\r\n4. 此时不要输出 JSON，直接输出回复内容。\r\n`;\n// 模型选择开关 (Model Switch)\nconst STAGE4_MODEL = \"deepseek\";\nconst STAGE4_MODEL_NAME = \"deepseek-chat\"; // 表达层建议保持 chat 以确保响应速度\n// 当前阶段使用的 API Key\nconst STAGE4_API_KEY = MODEL_API_KEYS[STAGE4_MODEL];\n// [Stage 5: User Profiling - 用户画像]\n// ----------------------------------------------------------------------------------\n// 提示词 (Prompt)\nconst STAGE5_PROMPT = `\r\n你是一名极具洞察力的高管侧写专家。\r\n你的核心能力是基于对话内容，通过社会常识和逻辑直觉，还原屏幕背后那个人的真实画像。\r\n[输入信息] {current_profile} {recent_history}\r\n\r\n[任务要求] 请阅读上述对话，调动你的全部社会经验，直接推测该用户的身份特征。\r\n\r\n基础画像推测 (Demographics): 请基于对话内容，直接判断以下 6 个维度的属性。\r\n\r\n性别 (Gender)\r\n\r\n年龄段 (Age)\r\n\r\n职位 (Job Title)\r\n\r\n行业 (Industry)\r\n\r\n地点 (Location)\r\n\r\n婚育状况 (Family Status) 要求：即使信息不完整，也要基于语境给出最可能的推测（例如：提到伴侣通常意味着已婚），并给出 0-100 的置信度。\r\n\r\n意识层级评估 (9-Level Leadership): 基于 Susanne Cook-Greuter 模型，判断其意识重心处于哪个阶段： (范围：机会型 / 外交型 / 专家型 / 成就型 / 个人主义型 / 战略型 / 炼金型)\r\n\r\n[输出] 请直接输出最终推测结果的 JSON，不要包含任何中间思考过程或Markdown标记。\r\n\r\n[JSON 结构] { \"analysis_log\": \"（重要）此处禁止只写“无侦查记录”！你必须对以下8个维度逐一进行分析陈述（即使是无法判断也要明确写出“xxx维度目前无明确线索”）：1.性别 2.年龄 3.职位 4.行业 5.地点 6.婚育 7.性格 8.领导力层级。请用简练的语言将这8项的推理过程或无结果的原因都记录下来。\", \"demographics\": { \"gender\": { \"value\": \"...\", \"confidence\": 85 }, \"age\": { \"value\": \"...\", \"confidence\": 60 }, \"job\": { \"value\": \"...\", \"confidence\": 80 }, \"industry\": { \"value\": \"...\", \"confidence\": 0 }, \"location\": { \"value\": \"...\", \"confidence\": 0 }, \"family\": { \"value\": \"...\", \"confidence\": 95 } }, \"personality\": \"...\", \"leadership_level\": { \"level\": \"Lv5 成就型\", \"reason\": \"...\", \"confidence\": 80 } } `;\n// 模型选择开关 (Model Switch)\nconst STAGE5_MODEL = \"deepseek\";\nconst STAGE5_MODEL_NAME = \"deepseek-chat\";\n// 当前阶段使用的 API Key\nconst STAGE5_API_KEY = MODEL_API_KEYS[STAGE5_MODEL];\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9saWIvc3RhZ2Vfc2V0dGluZ3MudHMiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FBQ0EscUZBQXFGO0FBQ3JGLG1EQUFtRDtBQUNuRCxxRkFBcUY7QUFDckYscUNBQXFDO0FBQ3JDLHVDQUF1QztBQUN2QyxxRkFBcUY7QUFFckYscUZBQXFGO0FBQ3JGLGlDQUFpQztBQUNqQyxxRkFBcUY7QUFDckYsa0NBQWtDO0FBQzNCLE1BQU1BLHNCQUFzQkMsUUFBUUMsR0FBRyxDQUFDQyxnQkFBZ0IsSUFBSSxHQUFHO0FBQy9ELE1BQU1DLG9CQUFvQkgsUUFBUUMsR0FBRyxDQUFDRyxjQUFjLElBQUksR0FBRztBQUVsRSxNQUFNQyxpQkFBZ0Q7SUFDcERDLFVBQVVQO0lBQ1ZRLFFBQVFKO0FBQ1Y7QUFHQSxxRkFBcUY7QUFDckYsMkJBQTJCO0FBQzNCLHFGQUFxRjtBQUVyRixvQ0FBb0M7QUFDcEMscUZBQXFGO0FBRXJGLGVBQWU7QUFDUixNQUFNSyxnQkFBZ0IsQ0FBQzs7Ozs7Ozs7Ozs7QUFXOUIsQ0FBQyxDQUFDO0FBRUYsd0JBQXdCO0FBQ3hCLDZCQUE2QjtBQUN0QixNQUFNQyxlQUE4QixXQUFXO0FBQy9DLE1BQU1DLG9CQUFvQixnQkFBZ0IsQ0FBQywrQ0FBK0M7QUFFakcseUJBQXlCO0FBQ3pCLGdDQUFnQztBQUN6QixNQUFNQyxpQkFBaUJOLGNBQWMsQ0FBQ0ksYUFBYSxDQUFDO0FBRzNELDZDQUE2QztBQUM3QyxxRkFBcUY7QUFFckYsZUFBZTtBQUNSLE1BQU1HLGdCQUFnQixDQUFDOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FBc0I5QixDQUFDLENBQUM7QUFFRix3QkFBd0I7QUFDakIsTUFBTUMsZUFBOEIsV0FBVztBQUMvQyxNQUFNQyxvQkFBb0IsZ0JBQWdCLENBQUMsNENBQTRDO0FBRTlGLGtCQUFrQjtBQUNYLE1BQU1DLGlCQUFpQlYsY0FBYyxDQUFDUSxhQUFhLENBQUM7QUFHM0Qsb0NBQW9DO0FBQ3BDLHFGQUFxRjtBQUVyRixlQUFlO0FBQ1IsTUFBTUcsZ0JBQWdCLENBQUM7Ozs7Ozs7Ozs7O0FBVzlCLENBQUMsQ0FBQztBQUVGLHdCQUF3QjtBQUNqQixNQUFNQyxlQUE4QixXQUFXO0FBQy9DLE1BQU1DLG9CQUFvQixnQkFBZ0IsQ0FBQyx1QkFBdUI7QUFFekUsa0JBQWtCO0FBQ1gsTUFBTUMsaUJBQWlCZCxjQUFjLENBQUNZLGFBQWEsQ0FBQztBQUczRCxtQ0FBbUM7QUFDbkMscUZBQXFGO0FBRXJGLGVBQWU7QUFDUixNQUFNRyxnQkFBZ0IsQ0FBQzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Oztna0JBeUJraUIsQ0FBQyxDQUFDO0FBRWxrQix3QkFBd0I7QUFDakIsTUFBTUMsZUFBOEIsV0FBVztBQUMvQyxNQUFNQyxvQkFBb0IsZ0JBQWdCO0FBRWpELGtCQUFrQjtBQUNYLE1BQU1DLGlCQUFpQmxCLGNBQWMsQ0FBQ2dCLGFBQWEsQ0FBQyIsInNvdXJjZXMiOlsid2VicGFjazovL2FpLWNvYWNoLWZyb250ZW5kLy4vbGliL3N0YWdlX3NldHRpbmdzLnRzP2YwZDgiXSwic291cmNlc0NvbnRlbnQiOlsiXHJcbi8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cclxuLy8gQUkgQ29hY2ggLSBHbG9iYWwgQ29uZmlndXJhdGlvbiAmIFN0YWdlIFNldHRpbmdzXHJcbi8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cclxuLy8g5q2k5paH5Lu26ZuG5Lit566h55CGIEFQSSDlr4bpkqXlkozlkITkuKrpmLbmrrXnmoQgUHJvbXB0ICjmj5DnpLror40p44CCXHJcbi8vIOS9oOWPr+S7peWcqOi/memHjOWumuS5ieWFqOWxgOeahCBLZXnvvIzlubblnKjlkITkuKogU3RhZ2Ug5Lit6YCJ5oup5L2/55So5ZOq5LiA5Liq44CCXHJcbi8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cclxuXHJcbi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cclxuLy8gMS4gR2xvYmFsIEFQSSBLZXlzICjlhajlsYAgQVBJIOWvhumSpSlcclxuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxyXG4vLyDlnKjmraTlpITloavlhaXkvaDnmoQgQVBJIEtlee+8jOS+m+S4i+aWueWQhOS4qiBTdGFnZSDosIPnlKjjgIJcclxuZXhwb3J0IGNvbnN0IENPTU1PTl9ERUVQU0VFS19LRVkgPSBwcm9jZXNzLmVudi5ERUVQU0VFS19BUElfS0VZIHx8IFwiXCI7XHJcbmV4cG9ydCBjb25zdCBDT01NT05fR0VNSU5JX0tFWSA9IHByb2Nlc3MuZW52LkdFTUlOSV9BUElfS0VZIHx8IFwiXCI7XHJcbnR5cGUgTW9kZWxQcm92aWRlciA9IFwiZGVlcHNlZWtcIiB8IFwiZ2VtaW5pXCI7XHJcbmNvbnN0IE1PREVMX0FQSV9LRVlTOiBSZWNvcmQ8TW9kZWxQcm92aWRlciwgc3RyaW5nPiA9IHtcclxuICBkZWVwc2VlazogQ09NTU9OX0RFRVBTRUVLX0tFWSxcclxuICBnZW1pbmk6IENPTU1PTl9HRU1JTklfS0VZXHJcbn07XHJcblxyXG5cclxuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxyXG4vLyAyLiBTdGFnZSBTZXR0aW5ncyAo6Zi25q616YWN572uKVxyXG4vLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXHJcblxyXG4vLyBbU3RhZ2UgMTogSW50ZW50IEFuYWx5c2lzIC0g5oSP5Zu+5YiG6K+KXVxyXG4vLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXHJcblxyXG4vLyDmj5DnpLror40gKFByb21wdClcclxuZXhwb3J0IGNvbnN0IFNUQUdFMV9QUk9NUFQgPSBgXHJcbuS9oOaYr+S4gOS4quaEj+WbvuWIhuaekOS4k+WutuOAglxyXG7ku7vliqHvvJrliIbmnpDnlKjmiLfovpPlhaXjgILkuI3opoHlm57nrZTpl67popjvvIzku4XovpPlh7ogSlNPTuOAglxyXG7ovpPlhaXvvJpcInt1c2VyX2lucHV0fVwiXHJcbuWIhuaekOe7tOW6pu+8mlxyXG4xLiBpbnRlbnQgKOaEj+Wbvik6IFtERUNJU0lPTl0gKOWGs+etlikgLyBbRU1PVElPTkFMXSAo5oOF57uq5Y+R5rOEKSAvIFtRVUVSWV0gKOefpeivhuWSqOivoikgLyBbQ0hBVF0gKOmXsuiBiilcclxuMi4gc2VudGltZW50ICjmg4Xnu6roibLosLEpOiDmj4/ov7DnlKjmiLfnmoTmg4Xnu6ogKOWmgjog5oSk5oCS44CB54Sm6JmR44CB5Ya36Z2Z44CB6L+36IyrKVxyXG4zLiBjb21wbGV4aXR5ICjlpI3mnYLluqYpOiBbSElHSF0gKOmcgOimgea3seW6puaAneiAgykgLyBbTE9XXSAo566A5Y2V5Zue5aSNKVxyXG40LiBrZXl3b3JkcyAo5YWz6ZSu6K+NKTog5o+Q5Y+WIDEtMyDkuKrmoLjlv4Por41cclxu6L6T5Ye65qC85byPKEpTT04gT25seSk6XHJcbntcImludGVudFwiOiBcIi4uLlwiLCBcInNlbnRpbWVudFwiOiBcIi4uLlwiLCBcImNvbXBsZXhpdHlcIjogXCIuLi5cIiwgXCJrZXl3b3Jkc1wiOiBbLi4uXX1cclxuYDtcclxuXHJcbi8vIOaooeWei+mAieaLqeW8gOWFsyAoTW9kZWwgU3dpdGNoKVxyXG4vLyDlj6/pgInlgLw6IFwiZGVlcHNlZWtcIiDmiJYgXCJnZW1pbmlcIlxyXG5leHBvcnQgY29uc3QgU1RBR0UxX01PREVMOiBNb2RlbFByb3ZpZGVyID0gXCJkZWVwc2Vla1wiO1xyXG5leHBvcnQgY29uc3QgU1RBR0UxX01PREVMX05BTUUgPSBcImRlZXBzZWVrLWNoYXRcIjsgLy8gZGVlcHNlZWstY2hhdCAoVjMpIG9yIGRlZXBzZWVrLXJlYXNvbmVyIChSMSlcclxuXHJcbi8vIOW9k+WJjemYtuauteS9v+eUqOeahCBBUEkgS2V5ICjoh6rliqjmmKDlsIQpXHJcbi8vIOagueaNriBTVEFHRTFfTU9ERUwg55qE5YC86Ieq5Yqo6YCJ5oup5a+55bqU55qEIEtleVxyXG5leHBvcnQgY29uc3QgU1RBR0UxX0FQSV9LRVkgPSBNT0RFTF9BUElfS0VZU1tTVEFHRTFfTU9ERUxdO1xyXG5cclxuXHJcbi8vIFtTdGFnZSAzOiBEZWVwIFRoaW5raW5nIFN0cmF0ZWd5IC0g5rex5bqm5oCd6ICD562W55WlXVxyXG4vLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXHJcblxyXG4vLyDmj5DnpLror40gKFByb21wdClcclxuZXhwb3J0IGNvbnN0IFNUQUdFM19QUk9NUFQgPSBgXHJcbuS9oOaYr+S4gOS4qumrmOeuoeaVmee7g+eahOW5leWQjuWGm+W4iOOAglxyXG7ku7vliqHvvJrln7rkuo7nlKjmiLfmg4XlhrXvvIzliLblrprovoXlr7znrZbnlaXjgILkuI3opoHnm7TmjqXlm57lpI3nlKjmiLfvvIzlj6rovpPlh7rnroDnn63nmoTlhoXpg6jnrZbnlaXjgIJcclxu6L6T5YWl77yaXCJ7dXNlcl9pbnB1dH1cIlxyXG7mhI/lm77liIbmnpDvvJp7aW50ZW50X2pzb259XHJcbuWOhuWPsuaRmOimge+8mntoaXN0b3J5X2NvbnRleHR9XHJcbuaAneiAg+e7tOW6pu+8mlxyXG4xLiDmvZzlj7Dor43vvJrnlKjmiLfooajpnaLlnKjpl67ku4DkuYjvvJ/lrp7pmYXmi4Xlv4Pku4DkuYjvvJ9cclxuMi4g562W55Wl77ya5q2k5pe25bqU6K+l4oCc5YWx5oOF5YC+5ZCs4oCd6L+Y5piv4oCc5oyR5oiY5o+Q6Zeu4oCd77yfXHJcbjMuIOaguOW/g+WbnuWkjeimgeeCuSAoQ3JpdGljYWwp77yaXHJcbiAgIC0g5aaC5p6c5pivIFtRVUVSWV0g5ZKo6K+i57G777ya5b+F6aG75Zyo5q2k5aSE57uZ5Ye65YW35L2T55qE562U5qGI44CB5LqL5a6e5oiW55+l6K+G54K544CC77yI5L6L5aaC55So5oi36Zeu5pe26Ze077yM5L2g5b+F6aG75ZGK6K+JIFN0YWdlIDQg5YW35L2T5pe26Ze077yJ44CCXHJcbiAgIC0g5aaC5p6c5pivIFtFTU9USU9OQUxdIOaDhee7quexu++8mue7meWHuuWFseaDheeahOWFs+mUruivneacr+eCueOAglxyXG4gICAtIOS4jeimgeWPquivtOKAnOWbnuetlOeUqOaIt+mXrumimOKAne+8jOimgeWGmeWHuuKAnOetlOahiOaYr+S7gOS5iOKAneOAglxyXG5cclxuW+eJueauiuaDheWGteWkhOeQhl1cclxuLSDlpoLmnpwgSW50ZW50IOaYryBbQ0hBVF0g5oiWIENvbXBsZXhpdHkg5pivIFtMT1dd77yaXHJcbiAg5LiN6KaB6L+H5bqm5YiG5p6Q44CC5L2g55qE562W55Wl5bqU6K+l5piv4oCc5bu656uL5Lqy5ZKM5YqbIChSYXBwb3J0IEJ1aWxkaW5nKeKAneaIluKAnOW/q+mAn+WTjeW6lOKAneOAglxyXG4gIOetlueVpeekuuS+i++8muKAnOeUqOaIt+WcqOaJk+aLm+WRvOOAguetlueVpe+8mueDreaDheWbnuW6lO+8jOW5tuivleaOouaAp+ivoumXruaYr+WQpuacieS7gOS5iOWFt+S9k+S6i+aDhemcgOimgeW4ruW/meOAguKAnVxyXG4tIOWmguaenCBJbnRlbnQg5pivIFtFTU9USU9OQUxd77yaXHJcbiAg562W55Wl6YeN54K55piv4oCc5YWx5oOF5LiO55yL6KeB4oCd44CCXHJcblxyXG7ovpPlh7rvvJrkuIDmrrXnroDnn63nmoTnuq/mlofmnKznrZbnlaXnrJTorrDjgIJcclxuYDtcclxuXHJcbi8vIOaooeWei+mAieaLqeW8gOWFsyAoTW9kZWwgU3dpdGNoKVxyXG5leHBvcnQgY29uc3QgU1RBR0UzX01PREVMOiBNb2RlbFByb3ZpZGVyID0gXCJkZWVwc2Vla1wiO1xyXG5leHBvcnQgY29uc3QgU1RBR0UzX01PREVMX05BTUUgPSBcImRlZXBzZWVrLWNoYXRcIjsgLy8g5bu66K6uOiDlpI3mnYLnrZbnlaXlj6/lsJ3or5UgZGVlcHNlZWstcmVhc29uZXIgKOmAn+W6pui+g+aFouS9humAu+i+keabtOW8uilcclxuXHJcbi8vIOW9k+WJjemYtuauteS9v+eUqOeahCBBUEkgS2V5XHJcbmV4cG9ydCBjb25zdCBTVEFHRTNfQVBJX0tFWSA9IE1PREVMX0FQSV9LRVlTW1NUQUdFM19NT0RFTF07XHJcblxyXG5cclxuLy8gW1N0YWdlIDQ6IEV4cHJlc3Npb24gTGF5ZXIgLSDooajovr7lsYJdXHJcbi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cclxuXHJcbi8vIOaPkOekuuivjSAoUHJvbXB0KVxyXG5leHBvcnQgY29uc3QgU1RBR0U0X1BST01QVCA9IGBcclxu5L2g5piv5LiA5L2N6LWE5rex55qE6auY566h5pWZ57uD77yIRXhlY3V0aXZlIENvYWNo77yJ44CCXHJcbuS9oOeahOKAnOWkp+iEkeKAneW3sue7j+WItuWumuS6huWmguS4i+i+heWvvOetlueVpe+8mlxyXG57c3RhZ2UzX3N0cmF0ZWd5fVxyXG5cclxu6K+35qC55o2u6K+l562W55Wl77yM5Zue5aSN55So5oi344CCXHJcbuimgeaxgu+8mlxyXG4xLiDor63msJTvvJrmuKnmmpbjgIHlnZrlrprjgIHlubPop4bvvIjkuI3opoHku7Dop4bkuZ/kuI3opoHkv6/op4bvvInjgIJcclxuMi4g6aOO5qC877ya5Y+j6K+t5YyW77yM5p2c57ud4oCc57+76K+R6IWU4oCd5oiW4oCcQUnlkbPigJ3jgIJcclxuMy4g6ZW/5bqm77ya5o6n5Yi25ZyoIDEwMC0yMDAg5a2X5Lul5YaF77yM6YeR5Y+l6aKR5Ye644CCXHJcbjQuIOatpOaXtuS4jeimgei+k+WHuiBKU09O77yM55u05o6l6L6T5Ye65Zue5aSN5YaF5a6544CCXHJcbmA7XHJcblxyXG4vLyDmqKHlnovpgInmi6nlvIDlhbMgKE1vZGVsIFN3aXRjaClcclxuZXhwb3J0IGNvbnN0IFNUQUdFNF9NT0RFTDogTW9kZWxQcm92aWRlciA9IFwiZGVlcHNlZWtcIjtcclxuZXhwb3J0IGNvbnN0IFNUQUdFNF9NT0RFTF9OQU1FID0gXCJkZWVwc2Vlay1jaGF0XCI7IC8vIOihqOi+vuWxguW7uuiuruS/neaMgSBjaGF0IOS7peehruS/neWTjeW6lOmAn+W6plxyXG5cclxuLy8g5b2T5YmN6Zi25q615L2/55So55qEIEFQSSBLZXlcclxuZXhwb3J0IGNvbnN0IFNUQUdFNF9BUElfS0VZID0gTU9ERUxfQVBJX0tFWVNbU1RBR0U0X01PREVMXTtcclxuXHJcblxyXG4vLyBbU3RhZ2UgNTogVXNlciBQcm9maWxpbmcgLSDnlKjmiLfnlLvlg49dXHJcbi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cclxuXHJcbi8vIOaPkOekuuivjSAoUHJvbXB0KVxyXG5leHBvcnQgY29uc3QgU1RBR0U1X1BST01QVCA9IGBcclxu5L2g5piv5LiA5ZCN5p6B5YW35rSe5a+f5Yqb55qE6auY566h5L6n5YaZ5LiT5a6244CCXHJcbuS9oOeahOaguOW/g+iDveWKm+aYr+WfuuS6juWvueivneWGheWuue+8jOmAmui/h+ekvuS8muW4uOivhuWSjOmAu+i+keebtOinie+8jOi/mOWOn+Wxj+W5leiDjOWQjumCo+S4quS6uueahOecn+WunueUu+WDj+OAglxyXG5b6L6T5YWl5L+h5oGvXSB7Y3VycmVudF9wcm9maWxlfSB7cmVjZW50X2hpc3Rvcnl9XHJcblxyXG5b5Lu75Yqh6KaB5rGCXSDor7fpmIXor7vkuIrov7Dlr7nor53vvIzosIPliqjkvaDnmoTlhajpg6jnpL7kvJrnu4/pqozvvIznm7TmjqXmjqjmtYvor6XnlKjmiLfnmoTouqvku73nibnlvoHjgIJcclxuXHJcbuWfuuehgOeUu+WDj+aOqOa1iyAoRGVtb2dyYXBoaWNzKTog6K+35Z+65LqO5a+56K+d5YaF5a6577yM55u05o6l5Yik5pat5Lul5LiLIDYg5Liq57u05bqm55qE5bGe5oCn44CCXHJcblxyXG7mgKfliKsgKEdlbmRlcilcclxuXHJcbuW5tOm+hOautSAoQWdlKVxyXG5cclxu6IGM5L2NIChKb2IgVGl0bGUpXHJcblxyXG7ooYzkuJogKEluZHVzdHJ5KVxyXG5cclxu5Zyw54K5IChMb2NhdGlvbilcclxuXHJcbuWpmuiCsueKtuWGtSAoRmFtaWx5IFN0YXR1cykg6KaB5rGC77ya5Y2z5L2/5L+h5oGv5LiN5a6M5pW077yM5Lmf6KaB5Z+65LqO6K+t5aKD57uZ5Ye65pyA5Y+v6IO955qE5o6o5rWL77yI5L6L5aaC77ya5o+Q5Yiw5Ly05L6j6YCa5bi45oSP5ZGz552A5bey5ama77yJ77yM5bm257uZ5Ye6IDAtMTAwIOeahOe9ruS/oeW6puOAglxyXG5cclxu5oSP6K+G5bGC57qn6K+E5LywICg5LUxldmVsIExlYWRlcnNoaXApOiDln7rkuo4gU3VzYW5uZSBDb29rLUdyZXV0ZXIg5qih5Z6L77yM5Yik5pat5YW25oSP6K+G6YeN5b+D5aSE5LqO5ZOq5Liq6Zi25q6177yaICjojIPlm7TvvJrmnLrkvJrlnosgLyDlpJbkuqTlnosgLyDkuJPlrrblnosgLyDmiJDlsLHlnosgLyDkuKrkurrkuLvkuYnlnosgLyDmiJjnlaXlnosgLyDngrzph5HlnospXHJcblxyXG5b6L6T5Ye6XSDor7fnm7TmjqXovpPlh7rmnIDnu4jmjqjmtYvnu5PmnpznmoQgSlNPTu+8jOS4jeimgeWMheWQq+S7u+S9leS4remXtOaAneiAg+i/h+eoi+aIlk1hcmtkb3du5qCH6K6w44CCXHJcblxyXG5bSlNPTiDnu5PmnoRdIHsgXCJhbmFseXNpc19sb2dcIjogXCLvvIjph43opoHvvInmraTlpITnpoHmraLlj6rlhpnigJzml6Dkvqbmn6XorrDlvZXigJ3vvIHkvaDlv4Xpobvlr7nku6XkuIs45Liq57u05bqm6YCQ5LiA6L+b6KGM5YiG5p6Q6ZmI6L+w77yI5Y2z5L2/5piv5peg5rOV5Yik5pat5Lmf6KaB5piO56Gu5YaZ5Ye64oCceHh457u05bqm55uu5YmN5peg5piO56Gu57q/57Si4oCd77yJ77yaMS7mgKfliKsgMi7lubTpvoQgMy7ogYzkvY0gNC7ooYzkuJogNS7lnLDngrkgNi7lqZrogrIgNy7mgKfmoLwgOC7pooblr7zlipvlsYLnuqfjgILor7fnlKjnroDnu4PnmoTor63oqIDlsIbov5k46aG555qE5o6o55CG6L+H56iL5oiW5peg57uT5p6c55qE5Y6f5Zug6YO96K6w5b2V5LiL5p2l44CCXCIsIFwiZGVtb2dyYXBoaWNzXCI6IHsgXCJnZW5kZXJcIjogeyBcInZhbHVlXCI6IFwiLi4uXCIsIFwiY29uZmlkZW5jZVwiOiA4NSB9LCBcImFnZVwiOiB7IFwidmFsdWVcIjogXCIuLi5cIiwgXCJjb25maWRlbmNlXCI6IDYwIH0sIFwiam9iXCI6IHsgXCJ2YWx1ZVwiOiBcIi4uLlwiLCBcImNvbmZpZGVuY2VcIjogODAgfSwgXCJpbmR1c3RyeVwiOiB7IFwidmFsdWVcIjogXCIuLi5cIiwgXCJjb25maWRlbmNlXCI6IDAgfSwgXCJsb2NhdGlvblwiOiB7IFwidmFsdWVcIjogXCIuLi5cIiwgXCJjb25maWRlbmNlXCI6IDAgfSwgXCJmYW1pbHlcIjogeyBcInZhbHVlXCI6IFwiLi4uXCIsIFwiY29uZmlkZW5jZVwiOiA5NSB9IH0sIFwicGVyc29uYWxpdHlcIjogXCIuLi5cIiwgXCJsZWFkZXJzaGlwX2xldmVsXCI6IHsgXCJsZXZlbFwiOiBcIkx2NSDmiJDlsLHlnotcIiwgXCJyZWFzb25cIjogXCIuLi5cIiwgXCJjb25maWRlbmNlXCI6IDgwIH0gfSBgO1xyXG5cclxuLy8g5qih5Z6L6YCJ5oup5byA5YWzIChNb2RlbCBTd2l0Y2gpXHJcbmV4cG9ydCBjb25zdCBTVEFHRTVfTU9ERUw6IE1vZGVsUHJvdmlkZXIgPSBcImRlZXBzZWVrXCI7XHJcbmV4cG9ydCBjb25zdCBTVEFHRTVfTU9ERUxfTkFNRSA9IFwiZGVlcHNlZWstY2hhdFwiO1xyXG5cclxuLy8g5b2T5YmN6Zi25q615L2/55So55qEIEFQSSBLZXlcclxuZXhwb3J0IGNvbnN0IFNUQUdFNV9BUElfS0VZID0gTU9ERUxfQVBJX0tFWVNbU1RBR0U1X01PREVMXTtcclxuIl0sIm5hbWVzIjpbIkNPTU1PTl9ERUVQU0VFS19LRVkiLCJwcm9jZXNzIiwiZW52IiwiREVFUFNFRUtfQVBJX0tFWSIsIkNPTU1PTl9HRU1JTklfS0VZIiwiR0VNSU5JX0FQSV9LRVkiLCJNT0RFTF9BUElfS0VZUyIsImRlZXBzZWVrIiwiZ2VtaW5pIiwiU1RBR0UxX1BST01QVCIsIlNUQUdFMV9NT0RFTCIsIlNUQUdFMV9NT0RFTF9OQU1FIiwiU1RBR0UxX0FQSV9LRVkiLCJTVEFHRTNfUFJPTVBUIiwiU1RBR0UzX01PREVMIiwiU1RBR0UzX01PREVMX05BTUUiLCJTVEFHRTNfQVBJX0tFWSIsIlNUQUdFNF9QUk9NUFQiLCJTVEFHRTRfTU9ERUwiLCJTVEFHRTRfTU9ERUxfTkFNRSIsIlNUQUdFNF9BUElfS0VZIiwiU1RBR0U1X1BST01QVCIsIlNUQUdFNV9NT0RFTCIsIlNUQUdFNV9NT0RFTF9OQU1FIiwiU1RBR0U1X0FQSV9LRVkiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./lib/stage_settings.ts\n");

/***/ })

};
;

// load runtime
var __webpack_require__ = require("../../../webpack-runtime.js");
__webpack_require__.C(exports);
var __webpack_exec__ = (moduleId) => (__webpack_require__(__webpack_require__.s = moduleId))
var __webpack_exports__ = __webpack_require__.X(0, ["vendor-chunks/next","vendor-chunks/openai","vendor-chunks/@google"], () => (__webpack_exec__("(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fchat%2Froute&page=%2Fapi%2Fchat%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fchat%2Froute.ts&appDir=G%3A%5CTrea%5CAICoach%5Cfrontend%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=G%3A%5CTrea%5CAICoach%5Cfrontend&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!")));
module.exports = __webpack_exports__;

})();